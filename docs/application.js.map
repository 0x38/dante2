{"version":3,"sources":["app/components/App.cjsx","app/components/blocks/embed.cjsx","app/components/blocks/image.cjsx","app/components/blocks/placeholder.cjsx","app/components/blocks/video.cjsx","app/components/inlineTooltip.cjsx","app/components/link.cjsx","app/components/popovers/image.cjsx","app/components/popovers/link.cjsx","app/components/toolTip.cjsx","app/data/poc.js","app/initialize.cjsx","app/model/content.js.es6","app/model/index.js.es6","app/utils/constants.js.es6","app/utils/convert_html.js.es6","app/utils/convert_html2.coffee","app/utils/find_entities.coffee","app/utils/save_content.coffee","app/utils/selection.js.es6","app/utils/simple_decorator.js","app/utils/utils.coffee"],"names":["decorator","strategy","component","createEditorState","content","decorators","createEmpty","dec","createWithContent","getDefaultBlockData","blockType","initialData","getCurrentBlock","editorState","selectionState","getSelection","contentState","getCurrentContent","block","getBlockForKey","getStartKey","addNewBlock","newType","isCollapsed","key","blockMap","getBlockMap","currentBlock","getLength","getType","newBlock","merge","type","data","newContentState","set","selectionAfter","push","resetBlockWithType","get","newText","text","getText","substr","anchorOffset","focusOffset","updateDataOfBlock","newData","getKey","addNewBlockAt","pivotBlockKey","newBlockType","blocksBefore","toSeq","takeUntil","v","blocksAfter","skipUntil","rest","newBlockKey","characterList","getCharacterList","slice","depth","newBlockMap","concat","toOrderedMap","selection","newContent","selectionBefore","anchorKey","focusKey","isBackward","Block","UNSTYLED","OL","UL","H1","H2","H3","H4","H5","H6","CODE","BLOCKQUOTE","PULLQUOTE","ATOMIC","BLOCKQUOTE_CAPTION","CAPTION","TODO","IMAGE","BREAK","Inline","BOLD","ITALIC","STRIKETHROUGH","UNDERLINE","HIGHLIGHT","Entity","LINK","toHTML","blockToHTML","entityRanges","length","entityKey","entity","entityType","getData","start","end","entityToHTML","originalText","href","src","module","exports","getSelectionRect","selected","_rect","getRangeAt","getBoundingClientRect","rect","top","getClientRects","anchorNode","isEmptyline","root","t","document","createRange","getSelectedBlockNode","rangeCount","node","startContainer","getAttribute","parentNode"],"mappings":"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,aAAN,CAAoB,GAApB,EAAyB;MAAC,aAAa,4BAAd;MACzB,eAAe,YADU;KAAzB,EAC8B,MAD9B,CAFF;EAFI;;;;GAPqB,KAAK,CAAC;;AAiBrC,MAAM,CAAC,OAAP,GAAiB;;;CClOjB;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxJA;AAAA;;ACAA;;AAAA,WAAW,QAAQ,WAAR;;AACX,QAAQ,QAAQ,OAAR;;AAER,MAAM,CAAC,KAAP,GAAe,QAAQ,uBAAR;;;;;;;;;;ACFf;;AAMA;;;;;;AAPA;AAUA,IAAMA,YAAY,gCAAuB,CACvC;AACEC,kCADF;AAEEC;AAFF,CADuC,CAAvB,CAAlB;;AAQA,IAAMC,oBAAoB,SAApBA,iBAAoB,GAAuC;AAAA,MAAtCC,OAAsC,uEAA5B,IAA4B;AAAA,MAAtBC,UAAsB,uEAAT,IAAS;;AAC/D,MAAID,YAAY,IAAhB,EAAsB;AACpB,WAAO,qBAAYE,WAAZ,CAAwBN,SAAxB,CAAP;AACD;AACD,MAAIO,MAAMP,SAAV;AACA,MAAIK,eAAe,IAAnB,EAAyB;AACvBE,UAAMF,UAAN;AACD;AACD,SAAO,qBAAYG,iBAAZ,CAA8B,6BAAeJ,OAAf,CAA9B,EAAuDG,GAAvD,CAAP;AACD,CATD;;kBAWeJ,iB;;;;;;;;;;;AC7Bf;;AAEA;;AACA;;;AAGA;;;AAGO,IAAMM,oDAAsB,SAAtBA,mBAAsB,CAACC,SAAD,EAAiC;AAAA,MAArBC,WAAqB,uEAAP,EAAO;;AAClE,UAAQD,SAAR;AACE;AACA;AAAS,aAAOC,WAAP;AAFX;AAID,CALM;;AAQP;;;AAGO,IAAMC,4CAAkB,SAAlBA,eAAkB,CAACC,WAAD,EAAiB;AAC9C,MAAMC,iBAAiBD,YAAYE,YAAZ,EAAvB;AACA,MAAMC,eAAeH,YAAYI,iBAAZ,EAArB;AACA,MAAMC,QAAQF,aAAaG,cAAb,CAA4BL,eAAeM,WAAf,EAA5B,CAAd;AACA,SAAOF,KAAP;AACD,CALM;;AAOP;;;;AAIO,IAAMG,oCAAc,SAAdA,WAAc,CAACR,WAAD,EAAyD;AAAA,MAA3CS,OAA2C,uEAAjC,UAAiC;AAAA,MAArBX,WAAqB,uEAAP,EAAO;;AAClF,MAAMG,iBAAiBD,YAAYE,YAAZ,EAAvB;AACA,MAAI,CAACD,eAAeS,WAAf,EAAL,EAAmC;AACjC,WAAOV,WAAP;AACD;AACD,MAAMG,eAAeH,YAAYI,iBAAZ,EAArB;AACA,MAAMO,MAAMV,eAAeM,WAAf,EAAZ;AACA,MAAMK,WAAWT,aAAaU,WAAb,EAAjB;AACA,MAAMC,eAAef,gBAAgBC,WAAhB,CAArB;AACA,MAAI,CAACc,YAAL,EAAmB;AACjB,WAAOd,WAAP;AACD;AACD,MAAIc,aAAaC,SAAb,OAA6B,CAAjC,EAAoC;AAClC,QAAID,aAAaE,OAAb,OAA2BP,OAA/B,EAAwC;AACtC,aAAOT,WAAP;AACD;AACD,QAAMiB,WAAWH,aAAaI,KAAb,CAAmB;AAClCC,YAAMV,OAD4B;AAElCW,YAAMxB,oBAAoBa,OAApB,EAA6BX,WAA7B;AAF4B,KAAnB,CAAjB;AAIA,QAAMuB,kBAAkBlB,aAAae,KAAb,CAAmB;AACzCN,gBAAUA,SAASU,GAAT,CAAaX,GAAb,EAAkBM,QAAlB,CAD+B;AAEzCM,sBAAgBtB;AAFyB,KAAnB,CAAxB;AAIA,WAAO,qBAAYuB,IAAZ,CAAiBxB,WAAjB,EAA8BqB,eAA9B,EAA+C,mBAA/C,CAAP;AACD;AACD,SAAOrB,WAAP;AACD,CA3BM;;AA8BP;;;AAGO,IAAMyB,kDAAqB,SAArBA,kBAAqB,CAACzB,WAAD,EAAuC;AAAA,MAAzBS,OAAyB,uEAAf,UAAe;;AACvE,MAAMN,eAAeH,YAAYI,iBAAZ,EAArB;AACA,MAAMH,iBAAiBD,YAAYE,YAAZ,EAAvB;AACA,MAAMS,MAAMV,eAAeM,WAAf,EAAZ;AACA,MAAMK,WAAWT,aAAaU,WAAb,EAAjB;AACA,MAAMR,QAAQO,SAASc,GAAT,CAAaf,GAAb,CAAd;AACA,MAAIgB,UAAU,EAAd;AACA,MAAMC,OAAOvB,MAAMwB,OAAN,EAAb;AACA,MAAIxB,MAAMU,SAAN,MAAqB,CAAzB,EAA4B;AAC1BY,cAAUC,KAAKE,MAAL,CAAY,CAAZ,CAAV;AACD;AACD,MAAMb,WAAWZ,MAAMa,KAAN,CAAY;AAC3BU,UAAMD,OADqB;AAE3BR,UAAMV,OAFqB;AAG3BW,UAAMxB,oBAAoBa,OAApB;AAHqB,GAAZ,CAAjB;AAKA,MAAMY,kBAAkBlB,aAAae,KAAb,CAAmB;AACzCN,cAAUA,SAASU,GAAT,CAAaX,GAAb,EAAkBM,QAAlB,CAD+B;AAEzCM,oBAAgBtB,eAAeiB,KAAf,CAAqB;AACnCa,oBAAc,CADqB;AAEnCC,mBAAa;AAFsB,KAArB;AAFyB,GAAnB,CAAxB;AAOA,SAAO,qBAAYR,IAAZ,CAAiBxB,WAAjB,EAA8BqB,eAA9B,EAA+C,mBAA/C,CAAP;AACD,CAxBM;;AA2BP;;;AAGO,IAAMY,gDAAoB,SAApBA,iBAAoB,CAACjC,WAAD,EAAcK,KAAd,EAAqB6B,OAArB,EAAiC;AAChE,MAAM/B,eAAeH,YAAYI,iBAAZ,EAArB;AACA,MAAMa,WAAWZ,MAAMa,KAAN,CAAY;AAC3BE,UAAMc;AADqB,GAAZ,CAAjB;AAGA,MAAMb,kBAAkBlB,aAAae,KAAb,CAAmB;AACzCN,cAAUT,aAAaU,WAAb,GAA2BS,GAA3B,CAA+BjB,MAAM8B,MAAN,EAA/B,EAA+ClB,QAA/C;AAD+B,GAAnB,CAAxB;AAGA,SAAO,qBAAYO,IAAZ,CAAiBxB,WAAjB,EAA8BqB,eAA9B,EAA+C,mBAA/C,CAAP;AACA;AACD,CAVM;;AAYP;AACA;;AAEA;;;;AAIO,IAAMe,wCAAgB,SAAhBA,aAAgB,CACzBpC,WADyB,EAEzBqC,aAFyB,EAKtB;AAAA,MAFHC,YAEG,uEAFY,UAEZ;AAAA,MADHxC,WACG,uEADW,EACX;;AACL,MAAMP,UAAUS,YAAYI,iBAAZ,EAAhB;AACA,MAAMQ,WAAWrB,QAAQsB,WAAR,EAAjB;AACA,MAAMR,QAAQO,SAASc,GAAT,CAAaW,aAAb,CAAd;AACA,MAAME,eAAe3B,SAAS4B,KAAT,GAAiBC,SAAjB,CAA2B,UAACC,CAAD;AAAA,WAAQA,MAAMrC,KAAd;AAAA,GAA3B,CAArB;AACA,MAAMsC,cAAc/B,SAAS4B,KAAT,GAAiBI,SAAjB,CAA2B,UAACF,CAAD;AAAA,WAAQA,MAAMrC,KAAd;AAAA,GAA3B,EAAiDwC,IAAjD,EAApB;AACA,MAAMC,cAAc,sBAApB;;AAEA,MAAM7B,WAAW,0BAAiB;AAChCN,SAAKmC,WAD2B;AAEhC3B,UAAMmB,YAF0B;AAGhCV,UAAM,EAH0B;AAIhCmB,mBAAe1C,MAAM2C,gBAAN,GAAyBC,KAAzB,CAA+B,CAA/B,EAAkC,CAAlC,CAJiB;AAKhCC,WAAO,CALyB;AAMhC9B,UAAM,oBAAIxB,oBAAoB0C,YAApB,EAAkCxC,WAAlC,CAAJ;AAN0B,GAAjB,CAAjB;;AASA,MAAMqD,cAAcZ,aAAaa,MAAb,CAClB,CAAC,CAACf,aAAD,EAAgBhC,KAAhB,CAAD,EAAyB,CAACyC,WAAD,EAAc7B,QAAd,CAAzB,CADkB,EAElB0B,WAFkB,EAGlBU,YAHkB,EAApB;;AAKA,MAAMC,YAAYtD,YAAYE,YAAZ,EAAlB;;AAEA,MAAMqD,aAAahE,QAAQ2B,KAAR,CAAc;AAC/BN,cAAUuC,WADqB;AAE/BK,qBAAiBF,SAFc;AAG/B/B,oBAAgB+B,UAAUpC,KAAV,CAAgB;AAC9BuC,iBAAWX,WADmB;AAE9Bf,oBAAc,CAFgB;AAG9B2B,gBAAUZ,WAHoB;AAI9Bd,mBAAa,CAJiB;AAK9B2B,kBAAY;AALkB,KAAhB;AAHe,GAAd,CAAnB;AAWA,SAAO,qBAAYnC,IAAZ,CAAiBxB,WAAjB,EAA8BuD,UAA9B,EAA0C,aAA1C,CAAP;AACD,CAzCM;;;;;;;;;ACjHP;;;;AAIO,IAAMK,wBAAQ;AACnBC,YAAU,UADS;AAEnBC,MAAI,mBAFe;AAGnBC,MAAI,qBAHe;AAInBC,MAAI,YAJe;AAKnBC,MAAI,YALe;AAMnBC,MAAI,cANe;AAOnBC,MAAI,aAPe;AAQnBC,MAAI,aARe;AASnBC,MAAI,YATe;AAUnBC,QAAM,YAVa;AAWnBC,cAAY,YAXO;AAYnBC,aAAW,WAZQ;AAanBC,UAAQ,QAbW;AAcnBC,sBAAoB,qBAdD;AAenBC,WAAS,SAfU;AAgBnBC,QAAM,MAhBa;AAiBnBC,SAAO,cAjBY;AAkBnBC,SAAO;AAlBY,CAAd;;AAqBA,IAAMC,0BAAS;AACpBC,QAAM,MADc;AAEpBV,QAAM,MAFc;AAGpBW,UAAQ,QAHY;AAIpBC,iBAAe,eAJK;AAKpBC,aAAW,WALS;AAMpBC,aAAW;AANS,CAAf;;AASA,IAAMC,0BAAS;AACpBC,QAAM;AADc,CAAf;;kBAIQ;AACb1B,cADa;AAEbmB,gBAFa;AAGbM;AAHa,C;;;;;;ACtCf;;AACA;;AAEA,IAAME,SAAS,iCAAc;AAC3BC,eAAa,qBAACnF,KAAD,EAAW;AACtB,QAAIA,MAAMc,IAAN,KAAe,QAAnB,EAA6B;AAC3B;AACA;AACA;AACA,UAAId,MAAMoF,YAAN,CAAmBC,MAAnB,GAA4B,CAAhC,EAAmC;AACjC,YAAMC,YAAYtF,MAAMoF,YAAN,CAAmB,CAAnB,EAAsB9E,GAAxC;AACA,YAAMiF,SAAS,gBAAOlE,GAAP,CAAWiE,SAAX,CAAf;;AAEA;AACA;AACA;AACA,YAAME,aAAaD,OAAOE,OAAP,GAAiB3E,IAApC;AACA;AACA,YAAI0E,eAAe,cAAnB,EAAmC;AACjC,iBAAO;AACLE,mBAAO,2BADF;AAELC,iBAAK;AAFA,WAAP;AAID,SALD,MAMK,IAAIH,eAAe,cAAnB,EAAmC;AACtC,iBAAO;AACLE,mBAAO,2BADF;AAELC,iBAAK;AAFA,WAAP;AAID;AACF;AACF;AACD,QAAI3F,MAAMc,IAAN,KAAe,OAAnB,EAA2B;AACzB;AACA,aAAO;AACD4E,eAAO,2BADN;AAEDC,aAAK;AAFJ,OAAP;AAID;AACF,GApC0B;AAqC3BC,gBAAc,sBAACL,MAAD,EAASM,YAAT,EAA0B;AACtC,QAAIN,OAAOzE,IAAP,KAAgB,MAApB,EAA4B;AAC1B,UAAMgF,OAAOP,OAAOxE,IAAP,CAAY+E,IAAzB;AACA,0BAAkBA,IAAlB,SAA0BD,YAA1B;AACD;AACD,QAAIN,OAAOzE,IAAP,KAAgB,cAApB,EAAoC;AAClC,UAAMiF,MAAMR,OAAOxE,IAAP,CAAYgF,GAAxB;AACA,4BAAoBA,GAApB;AACD;AACD,QAAIR,OAAOzE,IAAP,KAAgB,cAApB,EAAoC;AAClC,UAAMiF,OAAMR,OAAOxE,IAAP,CAAYgF,GAAxB;AACA,UAAMjF,OAAOyE,OAAOxE,IAAP,CAAYD,IAAzB;AACA,+CAAuCiF,IAAvC,gBAAqDjF,IAArD;AACD;AACD,WAAO+E,YAAP;AACD;AApD0B,CAAd,CAAf;;AAuDA;;AAEA;AACAG,OAAOC,OAAP,GAAiBf,MAAjB;;;;AC7DA;;AAAA,MAOK,QAAQ,UAAR,CAPL,EAAE,+BAAF,EACE,mBADF,EAEE,mBAFF,EAGE,yCAHF,EAIE,+BAJF,EAKE,qCALF,EAME;;AAGF,OAIK,QAAQ,WAAR,CAJL,EAAE,gBAAF,EACE,4BADF,EAEE,oBAFF,EAGE;;AAGA,UACG,QAAQ,YAAR;;;AAKL;;;;AAKA,yBAAyB;SAAA,SAAC,UAAD;WACvB;MAAA,aAAa,OAAb;MACA,QAAQ,UAAU,CAAC,YAAX,CAAwB,KAAxB,CADR;;EADuB;AAAA;;AAKzB,gBAAgB;SAAA,SAAC,SAAD;AACd;IAAA,IAAG,cAAa,IAAhB;AACE,aAAO,KADT;;IAGA,SAAS,QAAQ,CAAC,aAAT,CAAuB,YAAvB;IAGT,MAAM,CAAC,SAAP,GAAmB,IAAI,CAAC,SAAL,CAAe,SAAf;AACnB,WAAO;EARO;AAAA;;AAWhB,iBAAiB;SAAA,SAAC,KAAD,EAAQ,KAAR;AACf;IAAA,IAAG,CAAC,CAAC,iBAAiB,WAAlB,CAAJ;AACE,aADF;;IAGA,aAAa,KAAK,CAAC;AACnB,WAAO,UAAU,CAAC,YAAX,CAAwB,KAAxB,EAA+B,KAA/B;EALQ;AAAA;;AAQjB,4BAA4B,QAAQ,aAAR,EAAuB,sBAAvB;;AAE5B,cAAc;SAAA,SAAC,UAAD;WACZ,eAAe,UAAf,EAA2B,0BAA0B,UAA1B,CAA3B;EADY;AAAA;;;AAGd;;;;AAKA,qBAAqB,SAAC,IAAD,EAAO,OAAP;AACnB;EAAA,UAAc,eAAW,CAAC,eAAZ,CAA4B,IAA5B,EAAkC,WAAlC;EAEd,IAAI,OAAO,CAAC,gBAAR,CAAyB,KAAzB,CAA+B,CAAC,OAAhC,CAAyC,SAAC,IAAD;AAC3C,WAAO,YAAY,IAAZ;EADoC,CAAzC;EAMJ,gBAAgB,gBAAgB,OAAO,CAAC,IAAI,CAAC,SAA7B,EACV,mBADU,EAEV,OAFU;EAMhB,gBAAgB,aAAa,CAAC,GAAd,CAAkB,SAAC,KAAD;AAChC;AAAA;IACA,IAAI,KAAK,CAAC,OAAN,OAAqB,YAAzB;AACE,aAAO,MADT;;AAEA;MACE,OAAO,IAAI,CAAC,KAAL,CAAW,KAAK,CAAC,OAAN,EAAX,EADT;KAAA;AAGE,aAAO,MAHT;;WAKA,WAAW,KAAK,CAAC,KAAN,CAAY;MACrB,MAAM,OADe;MAErB,MAAM,EAFe;MAGrB,MACE;QAAA,KAAK,IAAI,CAAC,MAAV;OAJmB;KAAZ;EATqB,CAAlB;EAiBhB,UAAU;AACV,SAAO,YAAY,CAAC,oBAAb,CAAkC,aAAlC;AAjCY;;AAoCrB,MAAM,CAAC,OAAP,GAAiB;;;;AChGjB;;AAAE,SAAW,QAAQ,UAAR;;AAEb,eAAe,SAAC,UAAD,EAAa,YAAb,EAA2B,QAA3B;SACb,YAAY,CAAC,gBAAb,CAA8B;WAAA,SAAC,SAAD;AAC5B;MAAA,YAAY,SAAS,CAAC,SAAV;AACZ,aACE,cAAe,IAAf,IACA,MAAM,CAAC,GAAP,CAAW,SAAX,CAAqB,CAAC,OAAtB,OAAmC;IAJT;EAAA,QAA9B,EAOA,QAPA;AADa;;AAUf,MAAM,CAAC,OAAP,GAAiB;;;;ACZjB;;AAAA,QAAQ,QAAQ,OAAR;;AACR,YAAY,QAAQ,WAAR;;AAGN;EACS,sBAAC,OAAD;IACX,IAAC,OAAD,GAAU,OAAO,CAAC;IAClB,IAAC,cAAD,GAAiB,OAAO,CAAC;EAFd;;yBAIb,cAAa,SAAC,EAAD;WACX,IAAC,MAAD;EADW;;yBAGb,QAAO,SAAC,OAAD;IACL,KAAc,IAAC,OAAM,CAAC,SAAtB;AAAA;;IAEA,aAAa,IAAC,QAAd;WAEA,IAAC,QAAD,GAAW,WAAW;aAAA;eACpB,KAAC,cAAD,CAAe,OAAf;MADoB;IAAA,QAAX,EAET,IAAC,OAAM,CAAC,cAFC;EALN;;yBASP,gBAAe,SAAC,OAAD;AACb;IAAA,OAAO,CAAC,GAAR,CAAY,kBAAZ;IAMA,YAAY,CAAC,SAAS,CAAC,EAAV,CAAa,SAAS,CAAC,MAAV,CAAiB,IAAC,CAAC,aAAnB,CAAb,EAAgD,SAAS,CAAC,MAAV,CAAiB,OAAjB,CAAhD;IACb,OAAO,CAAC,GAAR,CAAY,kBAAZ,EAAgC,SAAhC;IAEA,KAAc,SAAd;AAAA;;IAEA,IAAgC,IAAC,OAAM,CAAC,kBAAxC;MAAA,IAAC,OAAM,CAAC,kBAAR;;WAEA,MACE;MAAA,QAAQ,IAAC,OAAM,CAAC,YAAhB;MACA,KAAK,IAAC,OAAM,CAAC,SADb;MAEA,MACE;QAAA,MAAM,IAAI,CAAC,SAAL,CAAe,OAAf,CAAN;OAHF;KADF,CAKA,CAAC,IALD,CAKM;aAAA,SAAC,MAAD;QACJ,OAAO,CAAC,GAAR,CAAY,iBAAZ,EAA+B,MAA/B;QACA,IAAyC,KAAC,OAAM,CAAC,qBAAjD;UAAA,KAAC,OAAM,CAAC,qBAAR,CAA8B,MAA9B;;QACA,IAAuC,KAAC,OAAM,CAAC,mBAA/C;iBAAA,KAAC,OAAM,CAAC,mBAAR,CAA4B,MAA5B;;MAHI;IAAA,QALN,CASA,EAAC,KAAD,EATA,CASO;aAAA,SAAC,KAAD;QACL,OAAO,CAAC,GAAR,CAAY,qCAAmC,KAA/C;QACA,IAAsC,KAAC,OAAM,CAAC,mBAA9C;iBAAA,KAAC,OAAM,CAAC,mBAAR,CAA4B,KAA5B;;MAFK;IAAA,QATP;EAda;;;;;;AA4BjB,MAAM,CAAC,OAAP,GAAiB;;;;;;;;;ACjDjB;;;AAGO,IAAMgB,8CAAmB,SAAnBA,gBAAmB,CAACC,QAAD,EAAc;AAC5C,MAAMC,QAAQD,SAASE,UAAT,CAAoB,CAApB,EAAuBC,qBAAvB,EAAd;AACA;AACA,MAAIC,OAAOH,SAASA,MAAMI,GAAf,GAAqBJ,KAArB,GAA6BD,SAASE,UAAT,CAAoB,CAApB,EAAuBI,cAAvB,GAAwC,CAAxC,CAAxC;AACA,MAAI,CAACF,IAAL,EAAW;AACT,QAAIJ,SAASO,UAAT,IAAuBP,SAASO,UAAT,CAAoBJ,qBAA/C,EAAsE;AACpEC,aAAOJ,SAASO,UAAT,CAAoBJ,qBAApB,EAAP;AACAC,WAAKI,WAAL,GAAmB,IAAnB;AACD,KAHD,MAGO;AACL,aAAO,IAAP;AACD;AACF;AACD,SAAOJ,IAAP;AACD,CAbM;;AAeP;;;AAGO,IAAM1G,sCAAe,SAAfA,YAAe,CAAC+G,IAAD,EAAU;AACpC,MAAIC,IAAI,IAAR;AACA,MAAID,KAAK/G,YAAT,EAAuB;AACrBgH,QAAID,KAAK/G,YAAL,EAAJ;AACD,GAFD,MAEO,IAAI+G,KAAKE,QAAL,CAAcjH,YAAlB,EAAgC;AACrCgH,QAAID,KAAKE,QAAL,CAAcjH,YAAd,EAAJ;AACD,GAFM,MAEA,IAAI+G,KAAKE,QAAL,CAAc7D,SAAlB,EAA6B;AAClC4D,QAAID,KAAKE,QAAL,CAAc7D,SAAd,CAAwB8D,WAAxB,GAAsCxF,IAA1C;AACD;AACD,SAAOsF,CAAP;AACD,CAVM;;AAYP;;;;AAIO,IAAMG,sDAAuB,SAAvBA,oBAAuB,CAACJ,IAAD,EAAU;AAC5C,MAAM3D,YAAY2D,KAAK/G,YAAL,EAAlB;AACA,MAAIoD,UAAUgE,UAAV,KAAyB,CAA7B,EAAgC;AAC9B,WAAO,IAAP;AACD;AACD,MAAIC,OAAOjE,UAAUoD,UAAV,CAAqB,CAArB,EAAwBc,cAAnC;AACA;AACA,KAAG;AACD,QAAID,KAAKE,YAAL,IAAqBF,KAAKE,YAAL,CAAkB,YAAlB,MAAoC,MAA7D,EAAqE;AACnE,aAAOF,IAAP;AACD;AACDA,WAAOA,KAAKG,UAAZ;AACA;AACD,GAND,QAMSH,SAAS,IANlB;AAOA,SAAO,IAAP;AACD,CAfM;;;ACrCP;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvEA;AAAA;;ACAA;;AAAA,MAAM,CAAC,SAAS,CAAC,cAAjB,GAAkC;SAChC,IAAI,CAAC,OAAL,CAAa,KAAb,EAAoB,EAApB;AADgC;;AAGlC,MAAM,CAAC,SAAS,CAAC,gBAAjB,GAAoC;SAClC,IAAI,CAAC,OAAL,CAAa,MAAb,EAAqB,GAArB;AADkC;;AAGpC,QAAQ;;AAMR,KAAK,CAAC,IAAN,GAAa;SAAA,SAAC,OAAD,EAAU,EAAV;AACX;IAAA,MAAU;IACV,GAAG,CAAC,IAAJ,CAAS,KAAT,EAAgB,OAAO,CAAC,GAAxB;IACA,GAAG,CAAC,MAAJ,GAAa;MACX,IAAG,GAAG,CAAC,MAAJ,KAAc,GAAjB;eACE,GAAG,GAAH,EADF;OAAA;eAIE,GAAG,GAAH,EAJF;;IADW;WAQb,GAAG,CAAC,IAAJ;EAXW;AAAA;;AAab,KAAK,CAAC,iBAAN,GAA0B;SAAA;AACxB;IAAA,YAAY,MAAM,CAAC,YAAP;IACZ,IAAgB,SAAS,CAAC,UAAV,KAAwB,CAAxC;AAAA,aAAO,KAAP;;AACA,WAAO,SAAS,CAAC,UAAV,CAAqB,CAArB;EAHiB;AAAA;;AAK1B,KAAK,CAAC,uBAAN,GAAgC;SAAA,SAAC,KAAD;AAC9B;IAAA,OAAO,KAAK,CAAC;AACb,WAAO,SAAU,IAAjB;MACE,kBAAqB,IAAI,CAAC,YAAR,GAA0B,IAAI,CAAC,YAAL,CAAkB,YAAlB,CAA1B,GAA+D;MAEjF,OAAO,IAAI,CAAC;IAHd;AAKA,WAAO;EAPuB;AAAA;;AAShC,KAAK,CAAC,eAAN,GAAwB;SAAA,SAAC,KAAD;AAEtB;IAAA,OAAO,KAAK,CAAC;AACb,WAAO,SAAU,IAAjB;MAGE,OAAO,IAAI,CAAC;AACZ,aAAO;IAJT;AAMA,WAAO;EATe;AAAA;;AAWxB,KAAK,CAAC,kBAAN,GAA2B;SAAA,SAAC,cAAD;AACzB;IAAA,eAAe,QAAQ,CAAC,cAAT,CAAwB,YAAxB,CAAqC,CAAC,qBAAtC;IACf,cAAc,cAAc,CAAC,qBAAf;IACd,aAAa,WAAW,CAAC,KAAZ,GAAoB,WAAW,CAAC;IAC7C,cAAc,WAAW,CAAC,MAAZ,GAAqB,WAAW,CAAC;IAC/C,aAAa,CAAC,WAAW,CAAC,IAAZ,GAAmB,YAAY,CAAC,IAAjC,IAAyC,CAAC,aAAa,CAAd,CAAzC,GAA4D,CAAC,KAAK,CAAN;IAEzE,YAAY,WAAW,CAAC,GAAZ,GAAkB,YAAY,CAAC,GAA/B,GAAqC;AACjD,WAAO;MAAE,sBAAF;MAAc,oBAAd;;EARkB;AAAA;;AAW3B,KAAK,CAAC,GAAN,GAAY,SAAC,OAAD,EAAU,KAAV;EACV,IAAI,MAAM,CAAC,SAAP,IAAoB,KAAxB;WAGE,OAAO,CAAC,GAAR,CAAa,OAAb,EAHF;;AADU;;AAMZ,KAAK,CAAC,cAAN,GAAuB,SAAC,GAAD;AACrB;EAAA,SAAS,QAAQ,CAAC,aAAT,CAAuB,QAAvB;EACT,MAAM,CAAC,KAAP,GAAe,GAAG,CAAC;EACnB,MAAM,CAAC,MAAP,GAAgB,GAAG,CAAC;EACpB,MAAM,MAAM,CAAC,UAAP,CAAkB,IAAlB;EACN,GAAG,CAAC,SAAJ,CAAc,GAAd,EAAmB,CAAnB,EAAsB,CAAtB;EACA,UAAU,MAAM,CAAC,SAAP,CAAiB,WAAjB;AAMV,SAAO;AAZc;;AAcvB,KAAK,CAAC,kBAAN,GAA2B;SACzB,IAAI,CAAC,MAAL,EAAa,CAAC,QAAd,CAAuB,EAAvB,CAA0B,CAAC,KAA3B,CAAiC,CAAjC;AADyB;;AAI3B,KAAK,CAAC,aAAN,GAAsB;AACpB;EAAA,IAAG,MAAM,CAAC,YAAV;IACE,MAAM,MAAM,CAAC,YAAP;IACN,IAAG,GAAG,CAAC,UAAJ,IAAmB,GAAG,CAAC,UAA1B;MACE,SAAS;MACT,IAAI;MACJ,MAAM,GAAG,CAAC;AAEV,aAAM,IAAI,GAAV;QACE,MAAM,CAAC,IAAP,CAAY,GAAG,CAAC,UAAJ,CAAe,CAAf,CAAZ;QACA,EAAE;MAFJ;AAGA,aAAO,OART;KAFF;GAAA;IAWK,IAA4C,QAAQ,CAAC,SAAT,IAAuB,QAAQ,CAAC,SAAS,CAAC,WAAtF;AAAA,aAAO,QAAQ,CAAC,SAAS,CAAC,WAAnB,GAAP;KAXL;;SAYA;AAboB;;AAetB,KAAK,CAAC,gBAAN,GAAyB,SAAC,QAAD;AACvB;EAAA,IAAG,QAAH;IACE,IAAG,MAAM,CAAC,YAAV;MACE,MAAM,MAAM,CAAC,YAAP;MACN,GAAG,CAAC,eAAJ;MACA,IAAI;MACJ,MAAM,QAAQ,CAAC;AAEf,aAAM,IAAI,GAAV;QACE,GAAG,CAAC,QAAJ,CAAa,QAAS,GAAtB;QACA,EAAE;MAFJ,CANF;KAAA;MASK,IAAsB,QAAQ,CAAC,SAAT,IAAuB,QAAQ,CAAC,MAAtD;QAAA,QAAQ,CAAC,MAAT;OATL;KADF;;AADuB;;AAczB,KAAK,CAAC,UAAN,GAAmB;AACjB;EAAA,QAAQ;EACR,MAAM;EACN,YAAY;EACZ,IAAG,QAAQ,CAAC,SAAT,IAAuB,QAAQ,CAAC,SAAS,CAAC,WAA7C;IAGE,QAAQ,QAAQ,CAAC,SAAS,CAAC,WAAnB;WACR,KAAK,CAAC,aAAN,GAJF;GAAA,MAKK,IAAG,MAAM,CAAC,YAAV;IACH,MAAM,MAAM,CAAC,YAAP;IACN,IAAG,GAAG,CAAC,UAAP;MACE,IAA8B,GAAG,CAAC,UAAJ,GAAiB,CAA/C;QAAA,QAAQ,GAAG,CAAC,UAAJ,CAAe,CAAf,EAAR;OADF;KAAA;MAME,QAAQ,QAAQ,CAAC,WAAT;MACR,KAAK,CAAC,QAAN,CAAe,GAAG,CAAC,UAAnB,EAA+B,GAAG,CAAC,YAAnC;MACA,KAAK,CAAC,MAAN,CAAa,GAAG,CAAC,SAAjB,EAA4B,GAAG,CAAC,WAAhC;MAGA,IAAG,KAAK,CAAC,SAAN,KAAqB,GAAG,CAAC,WAA5B;QACE,KAAK,CAAC,QAAN,CAAe,GAAG,CAAC,SAAnB,EAA8B,GAAG,CAAC,WAAlC;QACA,KAAK,CAAC,MAAN,CAAa,GAAG,CAAC,UAAjB,EAA6B,GAAG,CAAC,YAAjC,EAFF;OAXF;;IAcA,IAAG,KAAH;MACE,YAAY,KAAK,CAAC;MAGjB,IAAG,SAAS,CAAC,QAAV,KAAsB,CAAzB;eAAgC,SAAS,CAAC,WAA1C;OAAA;eAA0D,UAA1D;OAJH;KAhBG;;AATY;;AAgCnB,KAAK,CAAC,yBAAN,GAAkC;AAChC;EAAA,MAAM,QAAQ,CAAC;EACf,QAAQ;EACR,QAAQ;EACR,SAAS;EACT,OAAO;EACP,MAAM;EACN,IAAG,GAAH;IACE,IAAO,GAAG,CAAC,IAAJ,KAAY,SAAnB;MACE,QAAQ,GAAG,CAAC,WAAJ;MACR,QAAQ,KAAK,CAAC;aACd,SAAS,KAAK,CAAC,eAHjB;KADF;GAAA,MAKK,IAAG,MAAM,CAAC,YAAV;IACH,MAAM,MAAM,CAAC,YAAP;IACN,IAAG,GAAG,CAAC,UAAP;MACE,QAAQ,GAAG,CAAC,UAAJ,CAAe,CAAf,CAAiB,CAAC,UAAlB;MACR,IAAG,KAAK,CAAC,qBAAT;QACE,OAAO,KAAK,CAAC,qBAAN;QACP,QAAQ,IAAI,CAAC,KAAL,GAAa,IAAI,CAAC;QAC1B,SAAS,IAAI,CAAC,MAAL,GAAc,IAAI,CAAC,IAH9B;OAFF;;AAOA,WAAO,KATJ;;AAZ2B;;AAuBlC,KAAK,CAAC,sBAAN,GAA+B;SAAA,SAAC,QAAD;AAC7B;IAAA,QAAQ,QAAQ,CAAC,UAAT,CAAoB,CAApB,CAAsB,CAAC,qBAAvB;IAER,kDAA4B;MAAA,OAAQ,QAAQ,CAAC,UAAT,CAAoB,CAApB,CAAsB,CAAC,cAAvB,EAAwC,GAAhD;;IAC5B,IAAI,CAAC,IAAL;MACE,IAAI,QAAQ,CAAC,UAAT,IAAuB,QAAQ,CAAC,UAAU,CAAC,qBAA/C;QACE,OAAO,QAAQ,CAAC,UAAU,CAAC,qBAApB;QACP,IAAI,CAAC,WAAL,GAAmB,KAFrB;OAAA;AAIE,eAAO,KAJT;OADF;;AAMA,WAAO;EAVsB;AAAA;;AAY/B,KAAK,CAAC,OAAN,GAAgB;SAAA,SAAC,IAAD;AACd;;MADe,OAAM;;IACrB,IAAI;IACJ,IAAI,IAAI,CAAC,YAAT;MACE,IAAI,IAAI,CAAC,YAAL,GADN;KAAA,MAEK,IAAI,IAAI,CAAC,QAAQ,CAAC,YAAlB;MACH,IAAI,IAAI,CAAC,QAAQ,CAAC,YAAd,GADD;KAAA,MAEA,IAAI,IAAI,CAAC,QAAQ,CAAC,SAAlB;MACH,IAAI,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,WAAxB,EAAqC,CAAC,KADvC;;AAEL,WAAO;EARO;AAAA;;AAWhB,KAAK,CAAC,gBAAN,GAAyB,SAAC,WAAD;AACvB;EAAA,WAAW;EACX,cAAc;EACd,MAAM;EACN,QAAQ;EACR,IAAG,MAAM,CAAC,YAAV;IACE,MAAM,MAAM,CAAC,YAAP;IACN,IAAG,GAAG,CAAC,UAAP;MACE,QAAQ,GAAG,CAAC,UAAJ,CAAe,CAAf;MACR,IAA+B,KAAK,CAAC,uBAAuB,CAAC,UAA9B,KAA4C,WAA3E;QAAA,WAAW,KAAK,CAAC,UAAjB;OAFF;KAFF;GAAA,MAKK,IAAG,QAAQ,CAAC,SAAT,IAAuB,QAAQ,CAAC,SAAS,CAAC,WAA7C;IACH,QAAQ,QAAQ,CAAC,SAAS,CAAC,WAAnB;IACR,IAAG,KAAK,CAAC,aAAN,OAAyB,WAA5B;MACE,SAAS,QAAQ,CAAC,aAAT,CAAuB,MAAvB;MACT,WAAW,CAAC,YAAZ,CAAyB,MAAzB,EAAiC,WAAW,CAAC,UAA7C;MACA,YAAY,KAAK,CAAC,SAAN;MACZ,SAAS,CAAC,iBAAV,CAA4B,MAA5B;MACA,SAAS,CAAC,WAAV,CAAsB,UAAtB,EAAkC,KAAlC;MACA,WAAW,SAAS,CAAC,IAAI,CAAC,OAN5B;KAFG;;SASL;AAnBuB;;AAsBzB,KAAK,CAAC,mBAAN,GAA4B,SAAC,EAAD;AAE1B;EAAA,IAAe,OAAO,MAAP,KAAiB,UAAjB,IAAgC,cAAc,MAA7D;IAAA,KAAK,EAAG,IAAR;;EACA,OAAO,EAAE,CAAC,qBAAH;SAEP,IAAI,CAAC,GAAL,IAAY,CAAZ,IAAkB,IAAI,CAAC,IAAL,IAAa,CAA/B,IAAqC,IAAI,CAAC,MAAL,IAAe,CAAC,MAAM,CAAC,WAAP,IAAsB,QAAQ,CAAC,eAAe,CAAC,YAAhD,CAApD,IAAsH,IAAI,CAAC,KAAL,IAAc,CAAC,MAAM,CAAC,UAAP,IAAqB,QAAQ,CAAC,eAAe,CAAC,WAA/C;AAL1G;;AAS5B,KAAK,CAAC,eAAN,GAAwB;AACtB;EAAA,OAAO;EACP,IAAG,OAAO,MAAM,CAAC,YAAd,KAA8B,WAAjC;IACE,OAAO,MAAM,CAAC,YAAP,EAAqB,CAAC,QAAtB,GADT;GAAA,MAEK,IAAG,OAAO,QAAQ,CAAC,SAAhB,KAA6B,WAA7B,IAA4C,QAAQ,CAAC,SAAS,CAAC,IAAnB,KAA2B,MAA1E;IACH,OAAO,QAAQ,CAAC,SAAS,CAAC,WAAnB,EAAgC,CAAC,KADrC;;SAEL;AANsB;;AAQxB,KAAK,CAAC,SAAN,GAAkB;SAAA;IAChB;AAAA;IACA,IAAI,MAAM,CAAC,YAAX;aACE,YAAY,MAAM,CAAC,YAAP,GADd;KAAA,MAEK,IAAI,QAAQ,CAAC,SAAT,IAAsB,QAAQ,CAAC,SAAS,CAAC,IAAnB,KAA2B,SAArD;aACH,YAAY,QAAQ,CAAC,UADlB;;EAJW;AAAA;;AAOlB,KAAK,CAAC,iBAAN,GAA0B;AACxB;EAAA,OAAO,QAAQ,CAAC,YAAT,EAAuB,CAAC;EAC/B,IAAU,SAAQ,IAAlB;AAAA;;EACA,IAAG,IAAI,CAAC,QAAL,KAAiB,CAApB;WAA2B,IAAI,CAAC,WAAhC;GAAA;WAAgD,KAAhD;;AAHwB;;AAK1B,KAAK,CAAC,QAAN,GAAiB;AACf;EAAA,SAAS,EAAE,IAAC,GAAH,CAAO;EAChB,QAAQ,aAAa,SAAS,CAAC,UAAvB,IAAqC,SAAS,CAAC,UAAV,CAAqB,CAArB;EAC7C,IAAmC,CAAC,KAApC;IAAA,QAAQ,QAAQ,CAAC,WAAT,GAAR;;EACA,IAAG,CAAC,MAAM,CAAC,QAAP,CAAgB,KAAK,CAAC,uBAAtB,CAAJ;IACE,KAAK,CAAC,kBAAN,CAAyB,MAAzB;IACA,KAAK,CAAC,QAAN,CAAe,KAAf,EAFF;;SAGA;AAPe;;AASjB,KAAK,CAAC,QAAN,GAAiB,SAAC,KAAD;EACf,QAAQ,SAAS,IAAI,CAAC;EACtB,IAAG,CAAC,KAAJ;IACE,QAAQ,IAAI,CAAC,QAAL;IACR,KAAK,CAAC,QAAN,CAAe,KAAf,EAFF;;EAIA,IAAC,UAAD,EAAY,CAAC,eAAb;EACA,IAAC,UAAD,EAAY,CAAC,QAAb,CAAsB,KAAtB;SACA;AARe;;AAUjB,KAAK,CAAC,0BAAN,GAAmC;AACjC;EAAA,gBAAgB;EAChB,MAAM;EACN,QAAQ;EACR,iBAAiB;EACjB,IAAG,MAAM,CAAC,YAAV;IACE,MAAM,MAAM,CAAC,YAAP;IACN,IAAG,GAAG,CAAC,UAAJ,GAAiB,CAApB;MACE,QAAQ,GAAG,CAAC,UAAJ,CAAe,CAAf,CAAiB,CAAC,UAAlB;MACR,KAAK,CAAC,QAAN,CAAe,IAAf;MACA,KAAK,CAAC,QAAN,CAAe,IAAC,QAAD,EAAf,EAA2B,CAA3B;MACA,gBAAgB,KAAK,CAAC,QAAN,EAAgB,CAAC,KAAjB,CAAuB,CAAvB,EAJlB;KAFF;GAAA,MAOK,IAAG,CAAC,MAAM,QAAQ,CAAC,SAAhB,KAA+B,GAAG,CAAC,IAAJ,KAAc,SAAhD;IACH,QAAQ,GAAG,CAAC,WAAJ;IACR,iBAAiB,KAAK,CAAC,SAAN;IACjB,cAAc,CAAC,iBAAf,CAAiC,WAAjC;IACA,cAAc,CAAC,WAAf,CAA2B,YAA3B,EAAyC,KAAzC;IACA,gBAAgB,cAAc,CAAC,IAAI,CAAC,KAApB,CAA0B,CAA1B,EALb;;SAML;AAlBiC;;AAoBnC,KAAK,CAAC,UAAN,GAAmB;SACjB,EAAE,IAAC,QAAD,EAAF,CAAa,CAAC,IAAd,EAAoB,CAAC,IAArB,EAA2B,CAAC,MAA5B,KAAsC,IAAC,2BAAD,EAA6B,CAAC,IAA9B,EAAoC,CAAC;AAD1D;;AAGnB,KAAK,CAAC,WAAN,GAAoB;SAClB,IAAC,2BAAD,EAA6B,CAAC,IAA9B,EAAoC,CAAC,MAArC,KAA+C;AAD7B;;AAGpB,KAAK,CAAC,cAAN,GAAuB,SAAC,OAAD;AACrB;EAAA,IAAI,IAAC,gBAAD,EAAkB,CAAC,cAAnB,EAAmC,CAAC;EACxC,IAAI,EAAE,OAAF,CAAU,CAAC,IAAX,EAAiB,CAAC,cAAlB,EAAkC,CAAC;SACvC,MAAK;AAHgB;;AAMvB,KAAK,CAAC,UAAN,GAAmB,SAAC,OAAD,EAAU,GAAV;AACjB;;IAD2B,MAAI;;EAC/B,QAAQ,QAAQ,CAAC,WAAT;EACR,MAAM,MAAM,CAAC,YAAP;EAEN,KAAK,CAAC,QAAN,CAAe,OAAf,EAAwB,GAAxB;EAGA,KAAK,CAAC,QAAN,CAAe,IAAf;EACA,GAAG,CAAC,eAAJ;EACA,GAAG,CAAC,QAAJ,CAAa,KAAb;SACA,OAAO,CAAC,KAAR;AAViB;;AAanB,KAAK,CAAC,cAAN,GAAuB,SAAC,OAAD,EAAU,GAAV;AACrB;;IAD+B,MAAI;;EACnC,QAAQ,QAAQ,CAAC,WAAT;EACR,MAAM,MAAM,CAAC,YAAP;EACN,OAAO,OAAO,CAAC;EACf,KAAK,CAAC,QAAN,CAAe,IAAf,EAAqB,CAArB;EACA,KAAK,CAAC,MAAN,CAAa,IAAb,EAAmB,CAAnB;EACA,KAAK,CAAC,QAAN,CAAe,IAAf;EACA,GAAG,CAAC,eAAJ;EACA,GAAG,CAAC,QAAJ,CAAa,KAAb;SACA,OAAO,CAAC,KAAR;AATqB;;AAYvB,cAAc;;AAEd,4BAA4B,SAAC,IAAD,EAAO,KAAP;AAE1B;EAAA,YAAY,QAAQ,CAAC,WAAT;EACZ,SAAS,CAAC,kBAAV,CAA6B,IAA7B;EACA,SAAS,CAAC,MAAV,CAAiB,KAAK,CAAC,cAAvB,EAAuC,KAAK,CAAC,WAA7C;AACA,SAAO,SAAS,CAAC,QAAV,EAAoB,CAAC,IAArB,EAA2B,CAAC,MAA5B,KAAsC;AALnB;;AAO5B,0BAA0B,SAAC,IAAD,EAAO,KAAP;AACxB;EAAA,aAAa,QAAQ,CAAC,WAAT;EACb,UAAU,CAAC,kBAAX,CAA8B,IAA9B;EACA,UAAU,CAAC,QAAX,CAAoB,KAAK,CAAC,YAA1B,EAAwC,KAAK,CAAC,SAA9C;AACA,SAAO,UAAU,CAAC,QAAX,EAAqB,CAAC,IAAtB,EAA4B,CAAC,MAA7B,KAAuC;AAJtB;;;AAO1B;;AAGA,KAAK,CAAC,SAAN,GAAkB,SAAC,OAAD,EAAU,EAAV,EAAc,QAAd;AAChB;EAAA,IAAW,YAAY,CAAvB;AAAA;;EAEA,aAAa,KAAK,OAAO,CAAC;EAC1B,UAAU,aAAa,QAAb,GAAwB;SAElC,WAAY;IACR,OAAO,CAAC,SAAR,GAAoB,OAAO,CAAC,SAAR,GAAoB;IACxC,IAAW,OAAO,CAAC,SAAR,KAAqB,EAAhC;AAAA;;WACA,SAAS,OAAT,EAAkB,EAAlB,EAAsB,WAAW,EAAjC;EAHQ,CAAZ,EAIE,EAJF;AANgB;;AAYlB,KAAK,CAAC,WAAN,GAAoB,SAAC,EAAD;AAClB;EAAA,SAAS,EAAE,CAAC;EACZ,QAAQ,iBAAiB,EAAjB;EAER,UAAU,SAAS,KAAK,CAAC,SAAf,IAA4B,SAAS,KAAK,CAAC,YAAf;AACtC,SAAO;AALW;;;AAOpB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA,MAAM,CAAC,OAAP,GAAiB","file":"docs/application.js","sourcesContent":["\nReact = require('react')\nReactDOM = require('react-dom')\nImmutable = require('immutable')\n{ Map } = require('immutable')\n{\n  convertToRaw\n  convertFromRaw\n  CompositeDecorator\n  getVisibleSelectionRect\n  getDefaultKeyBinding\n  getSelectionOffsetKeyForNode\n  KeyBindingUtil\n  ContentState\n  Editor\n  EditorState\n  Entity\n  RichUtils\n  DefaultDraftBlockRenderMap\n  SelectionState\n  Modifier\n  BlockMapBuilder\n  getSafeBodyFromHTML\n} = require('draft-js')\n\nDraftPasteProcessor = require('draft-js/lib/DraftPasteProcessor')\n\n{stateToHTML} = require('draft-js-export-html')\n{\n  convertToHTML\n  convertFromHTML\n} = require('draft-convert')\n\ntoHTML = require(\"../utils/convert_html.js.es6\")\n\nisSoftNewlineEvent = require('draft-js/lib/isSoftNewlineEvent')\n\n{ \n  addNewBlock\n  resetBlockWithType\n  updateDataOfBlock\n  getCurrentBlock\n  addNewBlockAt\n} = require('../model/index.js.es6')\n\ncreateEditorState = require('../model/content.js.es6')\n{ updateDataOfBlock } = require('../model/index.js.es6')\n\nDanteImagePopover = require('./popovers/image')\nDanteAnchorPopover = require('./popovers/link')\n\nKeyCodes = \n  BACKSPACE: 8\n  TAB: 9\n  ENTER: 13\n  SPACEBAR: 32\n  LEFTARROW: 37\n  UPARROW: 38\n  RIGHTARROW: 39\n  DOWNARROW: 40\n\nwindow.utils = require('../utils/utils.coffee')\n{ \n  getSelectionRect\n  getSelection\n} = require(\"../utils/selection.js.es6\")\nDanteInlineTooltip = require('./inlineTooltip.cjsx')\nDanteTooltip = require('./toolTip.cjsx')\nLink = require('./link.cjsx')\nfindEntities = require('../utils/find_entities.coffee')\nImageBlock = require('./blocks/image.cjsx')\nEmbedBlock = require('./blocks/embed.cjsx')\nVideoBlock = require('./blocks/video.cjsx')\nPlaceholderBlock = require('./blocks/placeholder.cjsx')\n\nSaveBehavior = require('../utils/save_content.coffee')\ncustomHTML2Content = require('../utils/convert_html2.coffee')\n\nPocData = require('../data/poc.js')\n\nclass Dante \n  constructor: (options={})->\n    console.log \"init editor!\"\n    @options = options\n    @options.el = options.el || 'app'\n\n    @options.read_only = options.read_only || false\n    @options.spellcheck = options.spellcheck || false\n    @options.title_placeholder = options.title_placeholder || \"Title\"\n    @options.body_placeholder = options.body_placeholder || \"Write your story\"\n\n    @options.widgets = [\"uploader\", \"embed\", \"embed-extract\"]\n    \n    @options.store_url = options.store_url || null\n    @options.store_method = options.store_method || \"POST\"\n    @options.store_success_handler = options.store_success_handler || null\n    @options.store_failure_handler = options.store_failure_handler || null\n    @options.store_interval = options.store_interval || 1500\n    @options.before_xhr_handler = options.before_xhr_handler\n    @options.success_xhr_handler = options.success_xhr_handler\n    \n\n    @options.upload_url = options.upload_url || 'uploads.json'\n    @options.upload_callback = @options.image_upload_callabck\n    @options.image_delete_callback =  @options.image_delete_callback\n    @options.image_caption_placeholder = options.image_caption_placeholder\n\n    @options.oembed_url = \"http://api.embed.ly/1/oembed?url=\"\n    @options.extract_url = \"http://api.embed.ly/1/extract?url=\"\n    @options.embed_placeholder = 'Paste a YouTube, Vine, Vimeo, or other video link, and press Enter'\n    @options.embed_caption_placeholder = \"Type caption for embed (optional)\"\n    @options.extract_placeholder = 'Paste a link to embed content from another site (e.g. Twitter) and press Enter'\n\n  getContent: ->\n    PocData\n    \"\"\n\n  render: ->\n    ReactDOM.render(<DanteEditor content={@getContent()} \n      config={@options}/>, document.getElementById(@options.el))\n\nclass DanteEditor extends React.Component\n  constructor: (props) ->\n    super props\n    window.main_editor = @\n\n    @decorator = new CompositeDecorator([\n      {\n        strategy: findEntities.bind(null, 'link'),\n        component: Link\n      }\n    ])\n\n    @.blockRenderMap = Map({\n        \"image\":\n          element: 'figure'\n        \"avv\":\n          element: 'figure'\n        \"video\":\n          element: 'figure'\n        \"embed\":\n          element: 'div'\n        'unstyled':\n          wrapper: null\n          element: 'div'\n        'paragraph': \n          wrapper: null\n          element: 'div'\n        'placeholder':\n          wrapper: null\n          element: 'div'\n    }) \n    #.merge(DefaultDraftBlockRenderMap);\n\n    @extendedBlockRenderMap = DefaultDraftBlockRenderMap.merge(@blockRenderMap);\n\n    @state = \n      editorState: @initializeState() #EditorState.createEmpty(@decorator)\n      display_toolbar: false\n      showURLInput: false\n      blockRenderMap: @extendedBlockRenderMap #@blockRenderMap\n      current_input: \"\"\n      inlineTooltip:\n        show: true\n        position: {}\n\n      current_component: \"\"\n\n      display_tooltip: false      \n      position:  \n        top: 0\n        left: 0\n\n      display_image_popover: false\n      image_popover_position:\n        top: 0\n        left: 0 \n\n      anchor_popover_url: \"\"\n      display_anchor_popover: false \n      anchor_popover_position: \n        left: 0\n        top: 0\n\n      menu:\n        show: false\n        position: {}\n\n      embed_url: \"\"\n\n      continuousBlocks: [\n        \"unstyled\"\n        \"blockquote\"\n        \"ordered-list\"\n        \"unordered-list\"\n        \"unordered-list-item\"\n        \"ordered-list-item\"\n        \"code-block\"\n      ]\n\n      tooltipables: [\n        \"unstyled\"\n        \"blockquote\"\n        \"ordered-list\"\n        \"unordered-list\"\n        \"unordered-list-item\"\n        \"ordered-list-item\"\n        \"code-block\"\n        'header-one'\n        'header-two'\n        'header-three'        \n      ]\n\n    @.BLOCK_TYPES = [\n      # {label: 'p', style: 'unstyled'},\n      {label: 'h3', style: 'header-one'},\n      {label: 'h4', style: 'header-two'},\n      {label: 'blockquote', style: 'blockquote'},\n      {label: 'insertunorderedlist', style: 'unordered-list-item'},\n      {label: 'insertorderedlist', style: 'ordered-list-item'},\n      {label: 'code', style: 'code-block'}\n    ];\n\n    @.INLINE_STYLES = [\n      {label: 'bold', style: 'BOLD'},\n      {label: 'italic', style: 'ITALIC'},\n      # {label: 'underline', style: 'UNDERLINE'},\n      # {label: 'monospace', style: 'CODE'},\n      # {label: 'strikethrough', style: 'STRIKETHROUGH'}\n    ];\n\n    @save = new SaveBehavior\n      config: @props.config\n      editorState: @state.editorState\n      editorContent: @emitSerializedOutput()\n\n    optionsForDecorator: ()->\n      @state\n\n  initializeState: ()=>\n    if @.props.content #and @.props.content.trim() isnt \"\"\n      #processedHTML = DraftPasteProcessor.processHTML(@.props.content)\n      #contentState = ContentState.createFromBlockArray(processedHTML)\n      # move focus to the end. \n      #editorState = EditorState.createWithContent(contentState)\n      #editorState = EditorState.moveFocusToEnd(editorState)\n      \n      ###\n      #TODO: support entities\n      html = convertFromHTML(\n        htmlToEntity: (nodeName, node) =>\n          if nodeName is 'avv'\n            return Entity.create(\n              'LINK',\n              'MUTABLE',\n              {url: node.href}\n            )\n      )(@.props.content)\n      ###\n\n\n      #editorState = EditorState.createWithContent(html, @decorator)\n\n      @decodeEditorContent(@props.content)\n            \n      #debugger\n      #createEditorState.default(@props.content, @decorator)\n    else \n      EditorState.createEmpty(@decorator)\n\n  refreshSelection: (newEditorState)=>\n    editorState     = @.state.editorState\n    # Setting cursor position after inserting to content\n    s = @.state.editorState.getSelection()\n    c = editorState.getCurrentContent()\n\n    selectionState = SelectionState.createEmpty(s.getAnchorKey())\n    focusOffset = s.getFocusOffset()\n    anchorKey = s.getAnchorKey()\n    console.log anchorKey, focusOffset\n    selectionState = selectionState.merge({\n      anchorOffset: focusOffset,\n      focusKey: anchorKey,\n      focusOffset: focusOffset,\n    })\n\n    newState = EditorState.forceSelection(newEditorState, selectionState)\n    \n    @onChange(newState)\n  \n  forceRender: (editorState)=>\n    #editorState     = @.state.editorState\n    selection       = @.state.editorState.getSelection()\n    content         = editorState.getCurrentContent()\n    newEditorState  = EditorState.createWithContent(content, @decorator)\n\n    # @onChange(newEditorState)\n\n    @refreshSelection(newEditorState)\n    \n    #setTimeout =>\n    #  @getPositionForCurrent()\n    #, 0\n\n  parseDirection: (direction)=>\n    #console.log(direction)\n    switch direction\n      when \"left\" then \"graf--layoutOutsetLeft\"\n      when \"center\" then \"\"\n      when \"wide\" then \"sectionLayout--fullWidth\"\n      when \"fill\" then \"graf--layoutFillWidth\"\n      else\n        \"\"\n  \n  onChange: (editorState) =>\n    @setPreContent()\n    \n    # console.log \"BB\", editorState.toJS()\n    @.setState({editorState})\n    #console.log \"changed at\", editorState.getSelection().getAnchorKey()\n    #console.log \"collapsed?\", editorState.getSelection().isCollapsed()\n\n    currentBlock = getCurrentBlock(@state.editorState);\n    blockType = currentBlock.getType()\n\n    if (!editorState.getSelection().isCollapsed())\n\n      return if @.state.tooltipables.indexOf(blockType) < 0\n\n      @.setState\n        menu:\n          show: true\n          position: @state.menu.position\n        display_tooltip: false\n      , @handleOnChange\n    else\n      @.setState\n        menu:\n          show: false\n          position: @state.menu.position\n\n    setTimeout ()=>\n      @getPositionForCurrent()\n    , 0\n    \n    # @setState({ editorState });\n    @dispatchChangesToSave()    \n  \n    console.log \"CHANGES!\"\n\n  dispatchChangesToSave: =>\n    clearTimeout @saveTimeout\n    @saveTimeout = setTimeout =>\n      @save.store(@emitSerializedOutput())\n    , 100\n\n  setPreContent: =>\n    content = @emitSerializedOutput()\n    # console.log \"SET PRE CONTENT\", content\n    @save.editorContent = content\n\n  emitHTML: (editorState)=>\n\n    options =\n      blockRenderers:\n        #TODO: ver como funciona con los blocks\n        ATOMIC: (block) =>\n          data = block.getData();\n          if data.foo is 'bar'\n            return '<div>' + escape(block.getText()) + '</div>'\n        image: (block) =>\n          debugger\n          return \"<div>aca va tu foto oe</div>\"\n\n    #.state.editorState.getCurrentContent()\n    #raw = convertToRaw( @state.editorState.getCurrentContent() )\n    #html = stateToHTML(this.state.editorState.getCurrentContent(), options)\n    #html = stateToHTML(@state.editorState);\n    #html = draftRawToHtml(raw);\n    #this.props.onChange(html);\n\n    html = toHTML(@state.editorState.getCurrentContent())\n\n    console.log html\n    return false\n\n  emitSerializedOutput: =>\n    #s = @state.editorState.getCurrentContent()\n    \n    raw = convertToRaw( @state.editorState.getCurrentContent() )\n    # console.log raw\n\n    #raw_as_json = JSON.stringify(raw)\n    #console.log raw_as_json\n    #raw_as_json\n    raw\n\n  decodeEditorContent: (raw_as_json)=>\n    #new_content = convertFromRaw(JSON.parse(raw_as_json))\n    new_content = convertFromRaw(raw_as_json)\n    editorState = EditorState.createWithContent(new_content, @decorator)\n\n  testEmitAndDecode: =>\n    raw_as_json = @emitSerializedOutput()\n\n    @setState\n      editorState: @decodeEditorContent(raw_as_json)\n\n    false\n\n  emitHTML2: ()->\n\n    html = convertToHTML(\n      entityToHTML: (entity, originalText) => \n        if entity.type is 'LINK'\n          return \"<a href=\\\"#{entity.data.url}\\\">#{originalText}</a>\"\n        else\n          return originalText\n \n    )(@.state.editorState.getCurrentContent())\n    #html = convertToHTML(@.state.editorState.getCurrentContent())\n\n  setCurrentComponent: (component)=>\n    @setState\n      current_component: component\n\n  blockRenderer: (block)=>\n    switch block.getType()\n\n      when \"atomic\"\n\n        entity = block.getEntityAt(0)\n\n        #return null unless entity\n        entity_type = Entity.get(entity).getType()\n\n      when 'image'\n        return (\n            component: ImageBlock\n            editable: true\n            props:\n              data:\n                src: if @state.current_input isnt \"\" then URL.createObjectURL(@state.current_input) else \"\"\n                file: @state.current_input\n              getEditorState: @getEditorState\n              setEditorState: @onChange\n              config: @props.config\n          )\n\n      when 'embed'\n        return (\n            component: EmbedBlock\n            editable: true\n            props:\n              data: @state.current_input\n              getEditorState: @getEditorState\n              setEditorState: @onChange\n          )\n\n      when 'video'\n        return (\n            component: VideoBlock\n            editable: true\n            props:\n              data: @state.current_input\n              getEditorState: @getEditorState\n              setEditorState: @onChange\n          )\n\n      when 'placeholder'\n        return (\n            component: PlaceholderBlock\n            #editable: true\n            props:\n              data: @state.current_input\n          )\n\n    return null;\n\n  blockStyleFn: (block)=>\n    currentBlock = getCurrentBlock(@.state.editorState)\n    is_selected = if currentBlock.getKey() is block.getKey() then \"is-selected\" else \"\"\n    \n    console.log \"BLOCK STYLE:\", block.getType()\n\n    switch block.getType()\n      when \"image\"\n        direction_class = @parseDirection(block.getData().toJS().direction)\n        console.log \"direction_class: \", direction_class \n        is_selected = if currentBlock.getKey() is block.getKey() then \"is-selected is-mediaFocused\" else \"\"\n        return \"graf graf--figure #{is_selected} #{direction_class}\"\n      when \"video\"\n        is_selected = if currentBlock.getKey() is block.getKey() then \"is-selected is-mediaFocused\" else \"\"\n        return \"graf--figure graf--iframe #{is_selected}\"\n      when \"embed\"\n        is_selected = if currentBlock.getKey() is block.getKey() then \"is-selected is-mediaFocused\" else \"\"\n        return \"graf graf--mixtapeEmbed #{is_selected}\"\n      when \"placeholder\"\n        return \"is-embedable #{is_selected}\"\n      else\n        return \"graf graf--p #{is_selected}\"\n\n  ### from medium-draft\n  By default, it handles return key for inserting soft breaks (BRs in HTML) and\n  also instead of inserting a new empty block after current empty block, it first check\n  whether the current block is of a type other than `unstyled`. If yes, current block is\n  simply converted to an unstyled empty block. If RETURN is pressed on an unstyled block\n  default behavior is executed.\n  ###\n\n  handleReturn: (e) =>\n    if this.props.handleReturn\n      if this.props.handleReturn()\n        return true;\n\n    editorState = @state.editorState\n    #if (isSoftNewlineEvent(e)) {\n    #  this.onChange(RichUtils.insertSoftNewline(editorState));\n    #  return true;\n    #}\n    if !e.altKey && !e.metaKey && !e.ctrlKey\n      currentBlock = getCurrentBlock(editorState);\n      blockType = currentBlock.getType();\n\n      #console.log \"Handle return #{blockType} length #{currentBlock.getLength()}\"\n\n      if blockType.indexOf('atomic') is 0\n        @.onChange(addNewBlockAt(editorState, currentBlock.getKey()));\n        return true;\n      \n      if currentBlock.getText().length is 0\n        #console.log \"Handle return #{blockType} 2\"\n        switch (blockType)\n          when \"image\", \"embed\", \"video\"\n            @setState\n              display_tooltip: false\n            @.onChange(addNewBlockAt(editorState, currentBlock.getKey()))\n            return true\n          #when \"placeholder\"\n          #  @.onChange(resetBlockWithType(editorState, \"embed\"));\n          #  return true\n          when \"header-one\"\n            @.onChange(resetBlockWithType(editorState, \"unstyled\"));\n            return true;\n          else\n            return false;\n      \n      if currentBlock.getText().length > 0\n        #console.log \"Handle return #{blockType} with text\"\n        switch (blockType)\n          when \"video\", \"image\"\n            @setState\n              display_tooltip: false\n            @.onChange(addNewBlockAt(editorState, currentBlock.getKey()))\n            return true       \n          when \"placeholder\"\n            @setState\n              display_tooltip: false\n              current_input:\n                provisory_text: currentBlock.getText()\n                embed_url: @state.current_input.embed_url\n\n            @.onChange(resetBlockWithType(editorState, @state.current_input.type));\n            return true    \n\n      selection = editorState.getSelection();\n      \n      if selection.isCollapsed() and currentBlock.getLength() is selection.getStartOffset()\n        if @.state.continuousBlocks.indexOf(blockType) < 0\n          @.onChange(addNewBlockAt(editorState, currentBlock.getKey()))\n          return true;\n        \n        return false;\n      \n      if selection.isCollapsed() and currentBlock.getType() is \"embed\" and currentBlock.getLength() > 0\n        \n        if @.state.continuousBlocks.indexOf(blockType) < 0\n          #console.log \"adding block on embed inner text enter \"\n          @.onChange(addNewBlockAt(editorState, currentBlock.getKey()))\n          return true;\n        \n        return false;\n      return false;\n    \n    return false;\n\n  handleBeforeInput: (chars)=>\n    currentBlock = getCurrentBlock(@state.editorState);\n\n    if currentBlock.getText().length isnt 0\n      @closeInlineButton()\n\n    ###\n    switch currentBlock.getType()\n      when \"placeholder\"\n        @setState\n          current_input: \n            placeholder: \"aa\"\n            embed_url:\"http://api.embed.ly/1/oembed?key=86c28a410a104c8bb58848733c82f840&url=\"\n            provisory_text:\"http://twitter.com/michelson\"\n        \n        @.onChange(resetBlockWithType(@state.editorState, \"placeholder\"));\n        return false\n    ###\n    return false\n\n  handleClick: =>\n    console.log \"oli!!!!\"\n\n  focus: () => \n    #@.refs.editor.focus()\n    document.getElementById('richEditor').focus()\n\n  getEditorState: =>\n    @state.editorState\n\n  handleOnChange: ->\n    @relocateMenu()\n\n  # send new blocks to changes\n  dispatchChanges: (body)=>\n    @onChange(body)\n\n  stateHandler: (option)=>\n    @.setState\n      editorState: option\n\n  _toggleBlockType: (blockType)=>\n    \n    @onChange(\n      RichUtils.toggleInlineStyle(\n        @state.editorState,\n        blockType\n      )\n    )\n\n  disableMenu: =>\n    @setState\n      display_toolbar: false\n\n  handleKeyCommand: (command)=>\n    #console.log \"command:\",  command\n    if command is 'dante-save'\n      # Perform a request to save your contents, set\n      # a new `editorState`, etc.\n      console.log \"SAVING!!\"\n      return 'not-handled'\n    if command is 'dante-keyup'\n      return 'not-handled'\n    if command is 'dante-uparrow'\n      debugger\n      return 'not-handled'\n      #return 'not-handled'\n    #if command is 'dante-enter'\n    #  #@relocateTooltipPosition()\n    #  return 'handled'\n    #return 'not-handled'\n    newState = RichUtils.handleKeyCommand(@state.editorState, command);\n    if newState\n      @.onChange(newState);\n      return true;\n    \n    return false;\n\n  closeInlineButton: =>\n    @setState\n      display_tooltip: false\n\n  KeyBindingFn: (e)=>\n    #console.log \"KEY CODE: #{e.keyCode}\"\n    if e.keyCode is 83 # `S` key */ && hasCommandModifier(e)) {\n      #return 'dante-save'\n      console.log \"TODO: save in this point\"\n\n    if e.keyCode is KeyCodes.UPARROW\n      console.log \"UPARROW\"\n      return 'dante-uparrow'\n    #if e.keyCode is KeyCodes.ENTER\n    #  @closeInlineButton()\n    #  #return 'dante-enteriji' \n\n    return getDefaultKeyBinding(e)\n   \n  relocateMenu: =>\n\n    currentBlock = getCurrentBlock(@state.editorState);\n    blockType    = currentBlock.getType()\n    # display tooltip only for unstyled\n    if @.state.tooltipables.indexOf(blockType) < 0\n      @disableMenu()\n      return\n\n    return if !@state.menu.show\n    el = document.querySelector(\"#dante-menu\")\n    padd   = el.offsetWidth / 2\n\n    # eslint-disable-next-line no-undef\n    nativeSelection = getSelection(window);\n    if !nativeSelection.rangeCount\n      return;\n    \n    selectionBoundary = getSelectionRect(nativeSelection);\n\n    # eslint-disable-next-line react/no-find-dom-node\n    toolbarNode = ReactDOM.findDOMNode(@);\n    toolbarBoundary = toolbarNode.getBoundingClientRect();\n\n    # eslint-disable-next-line react/no-find-dom-node\n    parent = ReactDOM.findDOMNode(@);\n    parentBoundary = parent.getBoundingClientRect();\n\n    top    = selectionBoundary.top - parentBoundary.top - -90 - 5\n    left   = selectionBoundary.left + (selectionBoundary.width / 2) - padd\n\n    if !top or !left\n      return\n\n    @setState\n      menu:\n        show: true\n        position: { left: left , top: top }\n\n  getPositionForCurrent: ->\n    \n    if @state.editorState.getSelection().isCollapsed()\n\n      currentBlock = getCurrentBlock(@state.editorState)\n      blockType = currentBlock.getType()\n      \n      # console.log  \"POSITION CURRENT BLOCK\", currentBlock.getType(), currentBlock.getKey()\n\n      contentState = @state.editorState.getCurrentContent()\n      selectionState = @state.editorState.getSelection()\n      # console.log contentState\n      # console.log selectionState\n      block = contentState.getBlockForKey(selectionState.anchorKey);\n      # console.log block.getText().length, block.getText()\n\n      # eslint-disable-next-line no-undef\n      nativeSelection = getSelection(window);\n      if !nativeSelection.rangeCount\n        return;\n      #selectionBoundary = getSelectionRect(nativeSelection);\n      #debugger\n      \n      node = utils.getNode()\n      #console.log \"ANCHOR NODE\", node.anchorNode\n      #console.log \"PARENT ANCHOR\", node.anchorNode.parentNode.parentNode.parentNode\n\n      selectionBoundary = getSelectionRect(nativeSelection);\n      coords = selectionBoundary #utils.getSelectionDimensions(node)\n      if blockType is \"image\"\n        selectionBoundary = node.anchorNode.parentNode.parentNode.parentNode.getBoundingClientRect()\n        el = document.querySelector(\"#dante_image_popover\")\n        padd   = el.offsetWidth / 2\n      # eslint-disable-next-line react/no-find-dom-node\n      toolbarNode = ReactDOM.findDOMNode(@);\n      toolbarBoundary = toolbarNode.getBoundingClientRect();\n\n      # eslint-disable-next-line react/no-find-dom-node\n      parent = ReactDOM.findDOMNode(@);\n      parentBoundary = parent.getBoundingClientRect();\n\n      #console.log \"SB\", selectionBoundary\n      #console.log \"PB\", parentBoundary\n      # checkeamos si esta vacio\n      @setState\n        display_tooltip: block.getText().length is 0 and blockType is \"unstyled\"\n        position:  \n          top: coords.top + window.scrollY\n          left: coords.left + window.scrollX - 60\n        display_image_popover: blockType is \"image\"\n\n      if blockType is \"image\"\n        @setState\n          image_popover_position: \n            top: selectionBoundary.top - parentBoundary.top + 60\n            left: selectionBoundary.left + (selectionBoundary.width / 2) - padd\n\n    else\n      @closeInlineButton()\n\n  setCurrentInput: (data, cb)=>\n    #debugger\n    @setState\n      current_input: data\n    , cb\n    #console.log \"current in put\" , data\n\n  relocateImageTooltipPosition: (coords)=>\n    @setState\n      display_image_popover: true\n\n  # will update block state\n  updateBlockData: (block, options)=>\n    data = block.getData()\n    newData = data.merge(options)\n    newState = updateDataOfBlock(@state.editorState, block, newData)\n    # @onChange(newState)\n    # this fixes enter from image caption\n    @forceRender(newState)\n\n  setDirection: (direction_type)=>\n    \n    contentState = @state.editorState.getCurrentContent()\n    selectionState = @state.editorState.getSelection()\n    block = contentState.getBlockForKey(selectionState.anchorKey);\n\n    @updateBlockData(block, {direction: direction_type})\n\n  handleShowPopLinkOver: (e)=>\n    @showPopLinkOver()\n\n  handleHidePopLinkOver: (e)=>\n    @hidePopLinkOver()\n\n  showPopLinkOver: (el)=>\n    # handles popover display \n    # using anchor or from popover\n    coords = @positionForTooltip(el) if el\n    @isHover = true\n    @cancelHide()\n    @setState\n      anchor_popover_url: if el then el.href else @state.anchor_popover_url\n      display_anchor_popover: true\n      anchor_popover_position: if el then coords else @state.anchor_popover_position\n\n  hidePopLinkOver: ()=>\n    @hideTimeout = setTimeout ()=>\n      @setState\n        display_anchor_popover: false\n    , 300\n\n  cancelHide: ()->\n    console.log \"Cancel Hide\"\n    clearTimeout @hideTimeout\n\n  positionForTooltip: (node)=>\n    #debugger\n    #if !@state.editorState.getSelection().isCollapsed()\n\n    currentBlock = getCurrentBlock(@state.editorState)\n    blockType = currentBlock.getType()\n    \n    # console.log  \"ANCHOR POSITION CURRENT BLOCK\", currentBlock.getType(), currentBlock.getKey()\n\n    contentState = @state.editorState.getCurrentContent()\n    selectionState = @state.editorState.getSelection()\n\n    selectionBoundary = node.getBoundingClientRect() #getSelectionRect(nativeSelection);\n    coords = selectionBoundary #utils.getSelectionDimensions(node)\n    #if blockType is \"image\"\n    #selectionBoundary = node.anchorNode.parentNode.parentNode.parentNode.getBoundingClientRect()\n    el = document.querySelector(\"#dante-popover\")\n    padd   = el.offsetWidth / 2\n    # eslint-disable-next-line react/no-find-dom-node\n    toolbarNode = ReactDOM.findDOMNode(@)\n    toolbarBoundary = toolbarNode.getBoundingClientRect()\n\n    # eslint-disable-next-line react/no-find-dom-node\n    parent = ReactDOM.findDOMNode(@);\n    parentBoundary = parent.getBoundingClientRect()\n\n\n    # selectionBoundary.left + (selectionBoundary.width / 2) - padd\n    {\n      top: selectionBoundary.top - parentBoundary.top + 160\n      left: selectionBoundary.left - (selectionBoundary.width) #- padd\n    }\n\n  handlePasteText: (text, html)=>\n\n    # https://github.com/facebook/draft-js/issues/685\n    ###\n    html = \"<p>chao</p>\n    <avv>aaa</avv>\n    <p>oli</p>\n    <img src='x'/>\"\n    ###\n\n    # if not html then fallback to default handler\n    return false unless html\n\n    newContentState = customHTML2Content(html, @extendedBlockRenderMap)\n\n    currentBlock = getCurrentBlock(@state.editorState)\n    selection = @state.editorState.getSelection();\n    endKey = selection.getEndKey()\n    \n    content = @state.editorState.getCurrentContent();\n    blocksBefore = content.blockMap.toSeq().takeUntil((v) => (v.key is endKey))\n    blocksAfter = content.blockMap.toSeq().skipUntil((v) => (v.key is endKey)).rest()\n\n    newBlockKey = newContentState.blockMap.first().getKey()\n\n    newBlockMap = blocksBefore.concat(\n        newContentState.blockMap,\n        blocksAfter\n      ).toOrderedMap();\n\n    newContent = content.merge({\n      blockMap: newBlockMap,\n      selectionBefore: selection,\n      selectionAfter: selection.merge({\n      anchorKey: newBlockKey,\n      anchorOffset: 0,\n      focusKey: newBlockKey,\n      focusOffset: 0,\n      isBackward: false,\n      })\n    });\n\n    pushedContentState = EditorState.push(\n      @state.editorState, \n      newContent, \n      'insert-fragment'\n    )\n   \n    @onChange(pushedContentState)\n\n    true\n\n    \n\n  handlePasteImage: (files)=>\n    #TODO: check file types\n    files.map (file)=>\n      @setCurrentInput file, ()=>\n        @onChange(addNewBlock(@state.editorState, 'image'))\n\n  handleDroppedFiles: (state, files)=>\n    files.map (file)=>\n      @setCurrentInput file, ()=>\n        @onChange(addNewBlock(@state.editorState, 'image'))\n\n  handleUpArrow: (e)=>\n    setTimeout =>\n      @forceRender(@state.editorState)\n    , 10\n\n  handleDownArrow: (e)=>\n    setTimeout =>\n      @forceRender(@state.editorState)\n    , 10\n\n  render: =>\n\n    return (\n      <div id=\"content\" suppressContentEditableWarning={true}>\n\n        <article className=\"postArticle\">\n          <div className=\"postContent\">\n            <div className=\"notesSource\">\n              <div id=\"editor\" \n                className=\"postField postField--body\">\n\n                <section className=\"section--first section--last\"> \n                  <div className=\"section-divider layoutSingleColumn\"> \n                    <hr className=\"section-divider\"/> \n                  </div> \n\n                  <div className=\"section-content\"> \n                    <div id=\"richEditor\" className=\"section-inner layoutSingleColumn\" onClick={@.focus}>\n                      <Editor \n                        blockRendererFn={@.blockRenderer}\n                        editorState={@state.editorState} \n                        onChange={@onChange}\n                        onUpArrow={@handleUpArrow}\n                        onDownArrow={@handleDownArrow}\n                        handleReturn={@handleReturn}\n                        blockRenderMap={@state.blockRenderMap}\n                        blockStyleFn={@.blockStyleFn}\n                        handlePastedText={@handlePasteText}\n                        handlePastedFiles={@handlePasteImage}\n                        handleDroppedFiles={@handleDroppedFiles}\n                        handleKeyCommand={@.handleKeyCommand}\n                        keyBindingFn={@KeyBindingFn}\n                        handleBeforeInput={@.handleBeforeInput}\n                        readOnly={@props.config.read_only}\n                        onClick={@handleClick}\n                        suppressContentEditableWarning={true}\n                        placeholder={@props.config.body_placeholder}\n\n                        ref=\"editor\"\n                      />\n                    </div> \n                  </div>\n                </section>\n\n              </div>\n            </div>\n          </div>\n        </article>\n\n        <DanteTooltip\n          editorState={@state.editorState} \n          setStateHandler={@stateHandler}\n          toggleBlockType={@_toggleBlockType}\n          block_types={@BLOCK_TYPES}\n          inline_styles={@INLINE_STYLES}\n          confirmLink={@_confirmLink}\n          options={@state.menu}\n          disableMenu={@disableMenu}\n          dispatchChanges={@dispatchChanges}\n          handleKeyCommand={@.handleKeyCommand}\n          keyBindingFn={@KeyBindingFn}\n          relocateMenu={@relocateMenu}\n          showPopLinkOver={@showPopLinkOver} \n          hidePopLinkOver={@hidePopLinkOver}\n        />\n\n        <DanteInlineTooltip\n          options={@state.inlineTooltip}\n          editorState={@state.editorState}\n          style={@state.position}\n          onChange={@onChange}\n          dispatchChanges={@dispatchChanges}\n          setCurrentInput={@setCurrentInput}\n          display_tooltip={@state.display_tooltip}\n          closeInlineButton={@closeInlineButton}\n        />\n      \n        <DanteImagePopover\n          display_image_popover={@state.display_image_popover}\n          relocateImageTooltipPosition={@relocateImageTooltipPosition}\n          position={@state.image_popover_position}\n          setDirection={@setDirection}\n          setCurrentComponent={@setCurrentComponent}\n        />\n      \n        <DanteAnchorPopover\n          display_anchor_popover={@state.display_anchor_popover}\n          url={@state.anchor_popover_url}\n          position={@state.anchor_popover_position}\n          handleOnMouseOver={@handleShowPopLinkOver}\n          handleOnMouseOut={@handleHidePopLinkOver}\n        />   \n\n        <ul>\n          <li>\n            <a href=\"#\" onClick={@emitHTML}>\n              get content\n            </a>\n          </li>\n          <li>\n            <a href=\"#\" onClick={@testEmitAndDecode}>\n              serialize and set content\n            </a>\n          </li>\n        </ul>\n      </div>\n    ) \n\nmodule.exports = Dante\n","\nReact = require('react')\nReactDOM = require('react-dom')\n\n{\n  Entity,\n  RichUtils\n  AtomicBlockUtils\n  EditorBlock\n} = require('draft-js')\n\nutils = require(\"../../utils/utils\")\n\n{ updateDataOfBlock } = require('../../model/index.js.es6')\n\nclass EmbedBlock extends React.Component\n  constructor: (props) ->\n    super props\n    api_key = \"86c28a410a104c8bb58848733c82f840\"\n\n    @state = \n      embed_data: @defaultData()\n\n  defaultData: ->\n    existing_data = @.props.block.getData().toJS()\n    existing_data.embed_data || {}\n\n    # will update block state\n  updateData: =>\n    blockProps = @.props.blockProps\n    block = @.props.block\n    getEditorState = @props.blockProps.getEditorState\n    setEditorState = @props.blockProps.setEditorState\n    data = block.getData();\n    newData = data.merge(@state)\n    setEditorState(updateDataOfBlock(getEditorState(), block, newData))\n\n  componentDidMount: =>\n    return unless @.props.blockProps.data\n    utils.ajax\n      url: \"#{@.props.blockProps.data.embed_url}#{@.props.blockProps.data.provisory_text}&scheme=https\"\n      (data)=>\n        if data.status is 200\n          @setState\n            embed_data: JSON.parse(data.responseText)\n          , @updateData  \n\n  classForImage: ->\n    if @state.embed_data.thumbnail_url then \"\" else \"mixtapeImage--empty u-ignoreBlock\"\n\n  render: ->\n    #block = @.props;\n    #foo = @.props.blockProps;\n    #data = Entity.get(block.block.getEntityAt(0)).getData();\n    return(\n      <span>\n        <a target='_blank'\n          className=\"js-mixtapeImage mixtapeImage #{@classForImage()}\"\n          href={@state.embed_data.url} \n          style={{backgroundImage: \"url('#{@state.embed_data.thumbnail_url}')\"}}>\n        </a>\n        <a className='markup--anchor markup--mixtapeEmbed-anchor' \n          target='_blank' href={@state.embed_data.url}>\n          <strong className='markup--strong markup--mixtapeEmbed-strong'>\n            {@state.embed_data.title}\n          </strong>\n          <em className='markup--em markup--mixtapeEmbed-em'>\n            {@state.embed_data.description}\n          </em>\n        </a>\n        {@state.embed_data.provider_url}\n      </span>\n    )\n\nmodule.exports = EmbedBlock","React = require('react')\nReactDOM = require('react-dom')\n\n{\n  Entity,\n  RichUtils\n  AtomicBlockUtils\n  EditorBlock\n  EditorState\n} = require('draft-js')\n\naxios = require(\"axios\")\n\n{ updateDataOfBlock } = require('../../model/index.js.es6')\n\n\nclass ImageBlock extends React.Component\n\n  constructor: (props) ->\n    super props\n\n    existing_data = @.props.block.getData().toJS()\n\n    @config = @props.blockProps.config\n\n    @state = \n      selected: false\n      caption: @defaultPlaceholder()\n      direction: existing_data.direction || \"center\"\n      width: 0\n      height: 0\n      file: null\n      url: @blockPropsSrc() || @defaultUrl(existing_data)\n      aspect_ratio: @defaultAspectRatio(existing_data)\n\n  blockPropsSrc: ()=>\n    # console.log @.props.blockProps.data.src\n    @.props.blockProps.data.src\n    ###\n    debugger\n    block = @.props;\n    entity = block.block.getEntityAt(0)\n    if entity\n      data = Entity.get(entity).getData().src\n    else\n      null\n    ###\n\n  defaultUrl: (data)=>\n    if data.url\n      if data.file then URL.createObjectURL(data.file) else data.url\n    else\n      @props.blockProps.data.src\n\n  defaultPlaceholder: ->\n    @props.blockProps.config.image_caption_placeholder\n\n  defaultAspectRatio: (data)=>\n    if data.aspect_ratio\n      width: data.aspect_ratio['width']\n      height: data.aspect_ratio['height']\n      ratio: data.aspect_ratio['ratio'] \n    else\n      width:  0\n      height: 0\n      ratio: 100\n\n  getAspectRatio: (w, h)->\n    maxWidth = 1000\n    maxHeight = 1000\n    ratio = 0\n    width = w # Current image width\n    height = h # Current image height\n\n    # Check if the current width is larger than the max\n    if width > maxWidth\n      ratio = maxWidth / width # get ratio for scaling image\n      height = height * ratio # Reset height to match scaled image\n      width = width * ratio # Reset width to match scaled image\n\n    # Check if current height is larger than max\n    else if height > maxHeight\n      ratio = maxHeight / height # get ratio for scaling image\n      width = width * ratio # Reset width to match scaled image\n      height = height * ratio # Reset height to match scaled image\n\n    fill_ratio = height / width * 100\n    result = { width: width, height: height, ratio: fill_ratio }\n    utils.log result\n    result\n\n  # will update block state\n  updateData: =>\n    blockProps = @.props.blockProps\n    block = @.props.block\n    getEditorState = @props.blockProps.getEditorState\n    setEditorState = @props.blockProps.setEditorState\n    data = block.getData()\n    newData = data.merge(@state)\n    setEditorState(updateDataOfBlock(getEditorState(), block, newData))\n\n  replaceImg: =>\n    @img = new Image();\n    @img.src = this.refs.image_tag.src\n    @setState \n      url: @img.src\n    self = @\n    @img.onload = ()=>\n      console.log @img\n      console.log this\n      console.log self\n      console.log @\n      @setState\n        width: @img.width\n        height: @img.height\n        aspect_ratio: self.getAspectRatio(@img.width, @img.height)\n      , @handleUpload\n\n  handleUpload: =>\n    @updateData()\n    @uploadFile()\n\n  componentDidMount: ->\n    @replaceImg()\n\n  aspectRatio: =>\n    maxWidth: \"#{@state.aspect_ratio.width}\"\n    maxHeight: \"#{@state.aspect_ratio.height}\"\n    ratio: \"#{@state.aspect_ratio.height}\"\n\n  updateDataSelection: =>\n    getEditorState = @props.blockProps.getEditorState\n    setEditorState = @props.blockProps.setEditorState\n    newselection = getEditorState().getSelection().merge(\n      anchorKey: @.props.block.getKey()\n      focusKey: @.props.block.getKey()\n    )\n\n    setEditorState(\n      EditorState.forceSelection(getEditorState(), newselection)\n    )\n  \n  handleGrafFigureSelectImg: (e)=>\n    e.preventDefault()\n    #@props.blockProps.setCurrentComponent(@)\n    @setState\n      selected: true\n    , @updateDataSelection\n\n    #main_editor.onChange(main_editor.state.editorState)\n\n  coords: ->\n    maxWidth: \"#{@state.aspect_ratio.width}px\"\n    maxHeight: \"#{@state.aspect_ratio.height}px\"\n\n  formatData: ->\n    formData = new FormData()\n    formData.append('file', @props.blockProps.data.file)\n    return formData\n\n  uploadFile: =>\n    axios\n      method: 'post'\n      url: @config.upload_url\n      data: @formatData()\n      onUploadProgress: (e)=>\n        @updateProgressBar(e)\n    .then (result)=> \n      @uploadCompleted(result.data)\n      if @config.upload_callback\n        @config.upload_callback(response, @)\n    .catch (error)=>\n      console.log(\"ERROR: got error uploading file #{error}\")\n      if @config.upload_error_callback\n        @config.upload_error_callback(error, @)\n\n    handleUp = (json_response)=>\n      @uploadCompleted json_response, n\n\n  uploadCompleted: (json)=>\n    @setState\n      url: json.url\n    , @updateData\n\n  updateProgressBar: (e)=>\n    complete = \"\"\n    if (e.lengthComputable)\n      complete = e.loaded / e.total * 100\n      complete = complete ? complete : 0\n      console.log \"complete\"\n      console.log complete\n\n  render: =>\n    return (\n      <div ref=\"image_tag2\" \n          suppressContentEditableWarning={true}>\n        <div contentEditable=\"false\"\n          className=\"aspectRatioPlaceholder is-locked\" \n          style={@coords()} \n          onClick={@handleGrafFigureSelectImg}>\n          <div style={{paddingBottom: \"#{@state.aspect_ratio.ratio}%\" }}} className='aspect-ratio-fill'>\n          </div>\n          <img src={@state.url}\n            ref=\"image_tag\"\n            height={@state.aspect_ratio.height}\n            width={@state.aspect_ratio.width}\n            className='graf-image'\n          />\n        </div>\n        <figcaption className='imageCaption'>\n          <EditorBlock {...@props} \n            editable=true\n            className=\"imageCaption\"\n            placeholder=\"escrive alalal\"\n          />\n        </figcaption>\n      </div>\n    )\n    \nmodule.exports = ImageBlock\n","\nReact = require('react')\nReactDOM = require('react-dom')\n\n{\n  Entity,\n  RichUtils\n  AtomicBlockUtils\n  EditorBlock\n} = require('draft-js')\n\nutils = require(\"../../utils/utils\")\n\n\nclass PlaceholderBlock extends React.Component\n  constructor: (props) ->\n    super props\n    @state =\n      enabled: false\n\n  placeholderText: =>\n    return \"\" if @state.enabled\n    if @.props.blockProps.data then @.props.blockProps.data.placeholder else @defaultText()\n\n  defaultText: =>\n    \"write something \"\n\n  componentDidMount: ->\n\n  handleFocus: (e)=>\n    console.log \"focus on placeholder\"\n    setTimeout =>\n      @setState\n        enabled: true\n    , 0\n\n  classForDefault: =>\n    if !@state.enabled then \"defaultValue defaultValue--root\" else \"\"\n  render: ->\n    return(\n      <span className={@classForDefault()}\n        onMouseDown={@handleFocus}>\n        \n        {@placeholderText()}\n\n        <EditorBlock {...@props} \n          className=\"imageCaption\"\n          placeholder=\"escrive alalal\"\n        />\n      </span>\n    )\n\nmodule.exports = PlaceholderBlock","\nReact = require('react')\nReactDOM = require('react-dom')\n\n{\n  Entity,\n  RichUtils\n  AtomicBlockUtils\n  EditorBlock\n} = require('draft-js')\n\nutils = require(\"../../utils/utils\")\n\n{ updateDataOfBlock } = require('../../model/index.js.es6')\n\nclass VideoBlock extends React.Component\n  constructor: (props) ->\n    super props\n    api_key = \"86c28a410a104c8bb58848733c82f840\"\n    \n    @state = \n      embed_data: @defaultData()\n\n  defaultData: ->\n    existing_data = @.props.block.getData().toJS()\n    existing_data.embed_data || {}\n\n  # will update block state\n  updateData: =>\n    blockProps = @.props.blockProps\n    block = @.props.block\n    getEditorState = @props.blockProps.getEditorState\n    setEditorState = @props.blockProps.setEditorState\n    data = block.getData();\n    newData = data.merge(@state)\n    setEditorState(updateDataOfBlock(getEditorState(), block, newData))\n\n  componentDidMount: ->\n    return unless @.props.blockProps.data\n    utils.ajax\n      url: \"#{@.props.blockProps.data.embed_url}#{@.props.blockProps.data.provisory_text}&scheme=https\"\n      (data)=>\n        if data.status is 200\n          @setState\n            embed_data: JSON.parse(data.responseText)   \n          , @updateData \n\n  classForImage: ->\n    if @state.embed_data.thumbnail_url then \"\" else \"mixtapeImage--empty u-ignoreBlock\"\n\n  render: ->\n    return(\n      <figure\n        className='graf--figure graf--iframe graf--first' tabIndex='0'>\n        <div className='iframeContainer' dangerouslySetInnerHTML={__html: @state.embed_data.html}>\n        </div>\n        <figcaption\n          className='imageCaption'>\n            <EditorBlock {...@props} \n              className=\"imageCaption\"\n              placeholder=\"escrive alalal\"\n            />\n        </figcaption>\n      </figure>\n    )\n\nmodule.exports = VideoBlock","React = require('react')\nReactDOM = require('react-dom')\n\n{\n  Entity\n  RichUtils\n  AtomicBlockUtils\n  EditorState\n} = require('draft-js')\n\n{ \n  addNewBlock\n  resetBlockWithType\n  updateDataOfBlock\n} = require('../model/index.js.es6')\n\nclass DanteInlineTooltip extends React.Component\n\n  constructor: (props) ->\n    super props\n\n    @state = \n      #position: {top: 0, left:0}\n      show: true\n      scaled: false\n      buttons: [\n        {title: \"Add an image\", icon: \"image\" }\n        {title: \"Add an video\", icon: \"video\" }\n        {title: \"Add an embed\", icon: \"embed\" }\n      ]\n\n  _toggleScaled: (ev)=>\n    if @state.scaled then @collapse() else @scale()\n\n  scale: =>\n    @setState\n      scaled: true\n\n  collapse: =>\n    @setState\n      scaled: false\n\n  componentWillReceiveProps: (newProps)=>\n    @collapse()\n\n  ###\n  componentWillReceiveProps: (newProps)=>\n    console.log \"RECEIVED PROPS\"\n\n    contentState = newProps.editorState.getCurrentContent()\n    selectionState = newProps.editorState.getSelection()\n    console.log contentState\n    console.log selectionState\n    if newProps.editorState.getSelection().isCollapsed()\n      block = contentState.getBlockForKey(selectionState.anchorKey);\n      console.log block.getText().length, block.getText()\n\n      #debugger\n      if block.getText().length > 0\n        @setState\n          show: false    \n        return\n\n      #debugger\n      node = utils.getNode()\n      #console.log node.AnchorNode\n\n      # clearTimeout(@timeout)\n      # @timeout = setTimeout =>\n\n      if node.anchorNode\n        #debugger\n        #debugger\n        console.log \"ANCHOR NODE\", node.anchorNode\n        coords = utils.getSelectionDimensions(node)\n        console.log coords\n        @setState\n          position:\n            top: coords.top + window.scrollY\n            left: coords.left + window.scrollX - 40\n          show: true\n      #, 0\n    else\n      #if (!selectionState.isCollapsed() || selectionState.anchorKey !== selectionState.focusKey) {\n      console.log('no sel');\n      #this.hideBlock();\n      @setState\n        show: false\n      return;\n  ###\n\n  activeClass: ->\n    #if @props.show then \"is-active\" else \"\"\n    if @props.display_tooltip then \"is-active\" else \"\"\n\n  #getPosition: ->\n  #  @state.position\n\n  isActive: ->\n    @props.display_tooltip \n\n  scaledClass: ->\n    if @state.scaled then \"is-scaled\" else \"\"\n\n  scaledWidth: ->\n    if @state.scaled then \"124\" else \"0\"   \n\n  clickOnFileUpload: => \n    #ReactDOM.findDOMNode(@)\n    @.refs.fileInput.click()\n    @collapse()\n    @props.closeInlineButton()\n\n  insertImage: (file) =>\n    @props.setCurrentInput file, ()=>\n      @props.onChange(addNewBlock(@props.editorState, 'image'));\n\n    #entityKey = Entity.create('atomic:image', 'IMMUTABLE', {src: URL.createObjectURL(file)})\n    #@.props.dispatchChanges(AtomicBlockUtils.insertAtomicBlock(\n    #    @.props.editorState,\n    #    entityKey,\n    #    ' '\n    #  ));\n\n  insertVideo: () =>\n    #entityKey = Entity.create('atomic:video', 'IMMUTABLE', {src: \"oli\"})\n    #@.props.dispatchChanges(AtomicBlockUtils.insertAtomicBlock(\n    #    @.props.editorState,\n    #    entityKey,\n    #    ' '\n    #  ));  \n\n    api_key = \"86c28a410a104c8bb58848733c82f840\"\n\n    opts = \n      type: \"video\"\n      placeholder: \"Paste a link to embed content from another site (e.g. Twitter) and press Enter\" \n\n      provisory_text: \"http://twitter.com\"\n      embed_url: \"http://api.embed.ly/1/oembed?key=#{api_key}&url=\"\n\n    @props.setCurrentInput opts, ()=>\n      @props.onChange(resetBlockWithType(@props.editorState, 'placeholder'));\n\n    #@props.setCurrentInput opts, ()=>\n    #  @props.onChange(resetBlockWithType(@props.editorState, 'video'));\n\n  insertEmbed: () =>\n    api_key = \"86c28a410a104c8bb58848733c82f840\"\n\n    opts =\n      type: \"embed\"\n      placeholder: \"Paste a link to embed content from another site (e.g. Twitter) and press Enter\" \n      provisory_text: \"http://twitter.com/michelson\"\n      embed_url: \"http://api.embed.ly/1/oembed?key=#{api_key}&url=\"\n\n    @props.setCurrentInput opts, ()=>\n      @props.onChange(resetBlockWithType(@props.editorState, 'placeholder'));\n\n  insertEmbedDIS: () =>\n    api_key = \"86c28a410a104c8bb58848733c82f840\"\n\n    opts = \n      provisory_text: \"http://twitter.com\"\n      embed_url: \"http://api.embed.ly/1/oembed?key=#{api_key}&url=\"\n\n    @props.setCurrentInput opts, ()=>\n      @props.onChange(resetBlockWithType(@props.editorState, 'embed'));\n\n    #entityKey = Entity.create('atomic:embed', 'IMMUTABLE', {src: \"oli\"})\n    #@.props.dispatchChanges(AtomicBlockUtils.insertAtomicBlock(\n    #    @.props.editorState,\n    #    entityKey,\n    #    ' '\n    #  )); \n\n  handleFileInput: (e)=>\n    #debugger\n    fileList = e.target.files\n    file = fileList[0]\n    @.insertImage(file)\n\n  clickHandler: (e, type)=>\n    switch type\n      when \"image\"\n        @clickOnFileUpload(e)\n      when \"video\"\n        @insertVideo()\n      when \"embed\"\n        @insertEmbed()\n      else\n        null\n\n  render: ->\n    return (\n\n      <div className=\"inlineTooltip #{@activeClass()} #{@scaledClass()}\" \n        style={@props.style}>\n        \n        <button className=\"inlineTooltip-button control\" \n          title=\"Close Menu\" \n          data-action=\"inline-menu\"\n          onClick={@_toggleScaled}\n        > \n          <span className=\"tooltip-icon dante-icon-plus\"></span> \n        </button> \n        \n        <div className=\"inlineTooltip-menu\" style={{width: \"#{@scaledWidth()}px\"}}> \n          \n          {\n            @state.buttons.map (item, i)=>\n              <InlineTooltipItem\n                item={item}\n                key={i}\n                clickHandler={@clickHandler}\n              />\n          }\n\n          <input type=\"file\" \n            style={{display: 'none'}}\n            ref=\"fileInput\" \n            multiple=\"multiple\"\n            onChange={@.handleFileInput}\n          />\n\n        </div>\n\n      </div>\n\n    )\n\nclass InlineTooltipItem extends React.Component\n\n  clickHandler: (e)=>\n    e.preventDefault()\n    #console.log \"UPLOAD IMAGE\"\n    @props.clickHandler(e, @props.item.icon)\n\n  render: ->\n    return (\n      <button className=\"inlineTooltip-button scale\" \n        title={@props.title} onMouseDown={@clickHandler}> \n        <span className=\"tooltip-icon dante-icon-#{@props.item.icon}\">\n        </span> \n      </button>\n    )\n\nmodule.exports = DanteInlineTooltip","React = require('react')\n{Entity} = require('draft-js')\n\n###\nLink = (props) ->\n  data = Entity.get(props.entityKey).getData();\n  console.log props\n  #onMouseOver={@props.showPopLinkOver}>\n  #onMouseOut={@props.hidePopLinkOver}>\n  return (\n    <a href={data.url} className=\"markup--anchor\">\n      {props.children}\n    </a>\n  );\n###\n\nclass Link extends React.Component\n\n  constructor: (props) ->\n    super props\n    @isHover = false\n\n  _showPopLinkOver: (e)=>\n    @data.showPopLinkOver(@refs.link)\n\n  _hidePopLinkOver: (e)=>\n    @data.hidePopLinkOver()\n\n  render: ->\n    @data = Entity.get(@props.entityKey).getData();\n    console.log @props\n    console.log \"ENTITY\", @data\n\n    return (\n      <a ref=\"link\" \n        href={@data.url} \n        className=\"markup--anchor\"\n        onMouseOver={@_showPopLinkOver}\n        onMouseOut={@_hidePopLinkOver}>\n        {@props.children}\n      </a>\n    );  \n\nmodule.exports = Link","\nReact = require('react')\nReactDOM = require('react-dom')\n\n{\n  Entity\n  RichUtils\n  AtomicBlockUtils\n  EditorState\n} = require('draft-js')\n\nclass DanteImagePopover extends React.Component\n\n  constructor: (props) ->\n    super props\n\n    @state = \n      #position: {top: 0, left:0}\n      show: true\n      scaled: false\n      buttons: [\n        {type: \"left\" }\n        {type: \"center\" }\n        {type: \"fill\" }\n        {type: \"wide\" }\n      ]\n\n  _toggleScaled: (ev)=>\n    if @state.scaled then @collapse() else @scale()\n\n  scale: =>\n    @setState\n      scaled: true\n\n  collapse: =>\n    @setState\n      scaled: false\n\n  componentWillReceiveProps: (newProps)=>\n    @collapse()\n\n  getStyle: ->\n    return {} if !@state.position\n    \n  handleClick: (item)=>\n    @props.setDirection(item.type)\n\n  render: ->\n    return (\n\n      <div id=\"dante_image_popover\" \n          className=\"dante-popover popover--Aligntooltip popover--top popover--animated #{'is-active' if @props.display_image_popover}\" \n          style={{top: @props.position.top, left: @props.position.left}}>\n\n        <div className='popover-inner'>\n\n          <ul className='dante-menu-buttons'>\n\n            {\n              @state.buttons.map (item, i)=>\n                <DanteImagePopoverItem\n                  item={item}\n                  handleClick={@handleClick}\n                />\n            }\n\n          </ul>\n\n        </div>\n\n        <div className='popover-arrow'>\n        </div>\n      </div>\n\n    )\n\nclass DanteImagePopoverItem extends React.Component\n\n  handleClick: (e)=>\n    e.preventDefault()\n    @props.handleClick(@props.item)\n\n  render: =>\n    return (\n      <li\n        className=\"dante-menu-button align-#{@props.item.type}\"\n        onMouseDown={@handleClick}>\n        <span className=\"tooltip-icon dante-icon-image-#{@props.item.type}\"></span>\n      </li>\n    )\n\nmodule.exports = DanteImagePopover\n\n","\nReact = require('react')\nReactDOM = require('react-dom')\n\nclass DanteAnchorPopover extends React.Component\n\n  constructor: (props) ->\n\n    super props\n\n  render: =>\n    position = @props.position #@props.getPosition() || \n    # console.log \"POSITIOM\", position\n    style = {\n              left: position.left, \n              top: position.top, \n              display: \"#{if @props.display_anchor_popover then 'block' else 'none'}\"\n            }\n    return (\n      <div id=\"dante-popover\" \n        className='dante-popover popover--tooltip popover--Linktooltip popover--bottom is-active'\n        style={style}\n        onMouseOver={@props.handleOnMouseOver}\n        onMouseOut={@props.handleOnMouseOut}\n        >\n        <div className='popover-inner'>\n          <a href={@props.url} target='_blank'>\n            {@props.url}\n          </a>\n        </div>\n        <div className='popover-arrow'>\n        </div>\n      </div>\n    )\n\nmodule.exports = DanteAnchorPopover","React = require('react')\nReactDOM = require('react-dom')\nutils = require('../utils/utils.coffee')\n\n{\n  convertToRaw,\n  CompositeDecorator,\n  getVisibleSelectionRect,\n  getDefaultKeyBinding, \n  getSelectionOffsetKeyForNode,\n  KeyBindingUtil,\n  ContentState,\n  Editor,\n  EditorState,\n  Entity,\n  RichUtils\n} = require('draft-js')\n\nclass DanteTooltip extends React.Component\n\n  constructor: (props) ->\n    super props\n    @getVisibleSelectionRect = getVisibleSelectionRect\n    @state = \n      link_mode: false\n\n  _clickInlineHandler: (ev, style)=>\n    ev.preventDefault()\n    #@props.setStateHandler(\n    #  RichUtils.toggleInlineStyle(@props.editorState, style)\n    #)\n    @props.dispatchChanges(\n      RichUtils.toggleInlineStyle(@props.editorState, style)\n    )\n\n    setTimeout ()=>\n      @props.relocateMenu()\n    , 0\n    #@props.relocateMenu()\n\n  _clickBlockHandler: (ev, style)=>\n    ev.preventDefault()\n    # console.log \"hoi\", style\n    #@props.toggleBlockType(style)\n    #ev.preventDefault()\n    @props.dispatchChanges(\n      RichUtils.toggleBlockType(@props.editorState, style)\n    )\n    #debugger\n    #@props.dispatchChanges(\n    #  RichUtils.toggleInlineStyle(@props.editorState, style)\n    #)\n    #@props.relocateMenu()\n    setTimeout ()=>\n      @props.relocateMenu()\n    , 0\n\n  displayLinkMode: =>\n    if @state.link_mode then \"dante-menu--linkmode\" else \"\"\n\n  displayActiveMenu: =>\n    if @props.options.show then \"dante-menu--active\" else \"\"\n\n  _enableLinkMode: (ev)=>\n    ev.preventDefault()\n    @setState\n      link_mode: true\n\n  _disableLinkMode: (ev)=>\n    ev.preventDefault()\n    @setState\n      link_mode: false\n\n  hideMenu: ->\n    @props.disableMenu()\n\n  handleInputEnter: (e)=>    \n    if (e.which is 13)\n      #utils.restoreSelection(@savedSel)\n      return @confirmLink(e)\n\n  confirmLink: (e)=>\n    e.preventDefault()\n    editorState = @.props.editorState\n    urlValue = e.currentTarget.value\n    contentState = editorState.getCurrentContent()\n    selection = editorState.getSelection()\n\n    opts = {\n      url: urlValue\n      showPopLinkOver: @props.showPopLinkOver \n      hidePopLinkOver: @props.hidePopLinkOver\n    }\n\n    console.log \"MAMAMA\", opts\n\n    entityKey = Entity.create('link', 'MUTABLE', opts);\n\n    if selection.isCollapsed()\n      console.log \"COLLAPSED SKIPPN LINK\"\n      return\n\n    @props.dispatchChanges(\n      RichUtils.toggleLink(\n        editorState,\n        selection,\n        entityKey\n      )\n    )\n  \n    @_disableLinkMode(e)\n\n  getPosition: ->\n    pos = @props.options.position\n    #console.log pos\n    pos\n    \n  componentWillReceiveProps: (newProps)=>\n    # console.log \"isjsj\"\n    #setTimeout ()=>\n    #  @props.relocateMenu()\n    #, 0\n\n  render: ->\n    return (\n      <div id=\"dante-menu\" className=\"dante-menu #{@displayActiveMenu()} #{@displayLinkMode()}\" \n        style={@getPosition()}>\n        \n        <div className=\"dante-menu-linkinput\">\n          <input className=\"dante-menu-input\" \n            placeholder=\"Paste or type a link\" \n            onKeyPress={@handleInputEnter}/>\n\n          <div className=\"dante-menu-button\" \n            onMouseDown={@_disableLinkMode}>\n            x\n          </div>\n        </div>\n\n        <ul className=\"dante-menu-buttons\">\n          {\n            @props.block_types.map (item, i)=>\n              <DanteTooltipItem \n                key={i}\n                item={item}\n                handleClick={@_clickBlockHandler}\n                editorState={@props.editorState}\n                type={\"block\"}\n                currentStyle={@props.editorState.getCurrentInlineStyle}\n              />\n          }\n          {\n            <DanteTooltipLink \n              editorState={@props.editorState}\n              enableLinkMode={@_enableLinkMode}\n            />\n          }\n          {\n            @props.inline_styles.map (item, i)=>\n              <DanteTooltipItem \n                key={i}\n                item={item}\n                type={\"inline\"}\n                editorState={@props.editorState}\n                handleClick={@_clickInlineHandler}\n              />\n          }\n        </ul>\n      </div>\n    )\n\nclass DanteTooltipItem extends React.Component\n\n  handleClick: (ev)=>\n    @props.handleClick(ev, @props.item.style)\n\n  activeClass: =>\n    if @isActive() then \"active\" else \"\"\n\n  isActive: =>\n    if @props.type is \"block\"\n      @activeClassBlock()\n    else\n      @activeClassInline()\n\n  activeClassInline: =>\n    return unless @props.editorState\n    #console.log @props.item\n    @props.editorState.getCurrentInlineStyle().has(@props.item.style)\n\n  activeClassBlock: =>\n    #console.log \"EDITOR STATE\", @props.editorState\n    return unless @props.editorState\n    selection = @props.editorState.getSelection()\n    blockType = @props.editorState\n                .getCurrentContent()\n                .getBlockForKey(selection.getStartKey())\n                .getType()\n    @props.item.style is blockType\n\n  render: =>\n    return (\n      <li className=\"dante-menu-button #{@activeClass()}\" \n        onMouseDown={@handleClick}>\n        <i className=\"dante-icon dante-icon-#{@props.item.label}\" \n          data-action=\"bold\"></i>\n      </li>\n    )\n\nclass DanteTooltipLink extends React.Component\n\n  promptForLink: (ev)=>\n    selection = @props.editorState.getSelection()\n    if (!selection.isCollapsed())\n      @props.enableLinkMode(ev)\n\n  render: ->\n    return (\n      <li className=\"dante-menu-button\" \n        onMouseDown={@.promptForLink}>\n        <i className=\"dante-icon icon-createlink\" \n        data-action=\"createlink\">link</i>\n      </li>\n    )\n\n\nmodule.exports = DanteTooltip","\ndata = {\n  \"entityMap\": {},\n  \"blocks\": [\n    {\n      \"key\": \"5i64m\",\n      \"text\": \"ttps://www.youtube.com/watch?v=KPJgtQwtVVA&feature=youtu.be\",\n      \"type\": \"video\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {\n        \"embed_data\": {\n          \"provider_url\": \"https://www.youtube.com/\",\n          \"width\": 854,\n          \"height\": 480,\n          \"html\": \"<iframe class=\\\"embedly-embed\\\" src=\\\"https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FKPJgtQwtVVA%3Ffeature%3Doembed&url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DKPJgtQwtVVA&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FKPJgtQwtVVA%2Fhqdefault.jpg&key=d42b91026ea041c0875fd61ff736cb79&type=text%2Fhtml&schema=youtube\\\" width=\\\"854\\\" height=\\\"480\\\" scrolling=\\\"no\\\" frameborder=\\\"0\\\" allowfullscreen></iframe>\",\n          \"url\": \"http://www.youtube.com/watch?v=KPJgtQwtVVA\",\n          \"thumbnail_width\": 480,\n          \"version\": \"1.0\",\n          \"title\": \"When Eric Clapton met Jimi Hendrix\",\n          \"provider_name\": \"YouTube\",\n          \"type\": \"video\",\n          \"thumbnail_height\": 360,\n          \"author_url\": \"https://www.youtube.com/user/Mrjamesanonymous\",\n          \"thumbnail_url\": \"https://i.ytimg.com/vi/KPJgtQwtVVA/hqdefault.jpg\",\n          \"description\": \"An excerpt from the bbc documentary 'the seven ages of rock - Episode 1 the birth of rock'.\",\n          \"author_name\": \"Mrjamesanonymous\"\n        }\n      }\n    },\n    {\n      \"key\": \"347m6\",\n      \"text\": \"ttp://news.ycombinator.com\",\n      \"type\": \"embed\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {\n        \"embed_data\": {\n          \"provider_url\": \"https://news.ycombinator.com\",\n          \"description\": \"Air India Taking Advantage of Tailwinds\",\n          \"title\": \"Hacker News\",\n          \"url\": \"https://news.ycombinator.com/\",\n          \"version\": \"1.0\",\n          \"provider_name\": \"Ycombinator\",\n          \"type\": \"link\"\n        }\n      }\n    },\n    {\n      \"key\": \"t0sk\",\n      \"text\": \"sdcoidjco sidjcioj\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"3o1e9\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"gomb\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"3gb8l\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"5al5t\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"9n7jn\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"688cu\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"edbt8\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"6gcd3\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"2kv9k\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"fkp0i\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    }\n  ]\n}\n\nmodule.exports = data","ReactDOM = require('react-dom');\nReact = require('react');\n\nwindow.Dante = require('./components/App.cjsx')","//https://gist.github.com/benbriggs/d946a7cf4f7d90545779aeb79ccbd292\nimport {\n  EditorState,\n  convertFromRaw,\n  CompositeDecorator,\n} from 'draft-js';\n\nimport Link, { findLinkEntities } from '../components/link';\n\n\nconst decorator = new CompositeDecorator([\n  {\n    strategy: findLinkEntities,\n    component: Link,\n  },\n]);\n\n\nconst createEditorState = (content = null, decorators = null) => {\n  if (content === null) {\n    return EditorState.createEmpty(decorator);\n  }\n  let dec = decorator;\n  if (decorators !== null) {\n    dec = decorators;\n  }\n  return EditorState.createWithContent(convertFromRaw(content), dec);\n};\n\nexport default createEditorState;\n","import { Map } from 'immutable';\n\nimport { EditorState, ContentBlock, genKey } from 'draft-js';\n//import { Block } from '../util/constants';\n\n\n/*\nReturns default block-level metadata for various block type. Empty object otherwise.\n*/\nexport const getDefaultBlockData = (blockType, initialData = {}) => {\n  switch (blockType) {\n    //case Block.TODO: return { checked: false };\n    default: return initialData;\n  }\n};\n\n\n/*\nGet currentBlock in the editorState.\n*/\nexport const getCurrentBlock = (editorState) => {\n  const selectionState = editorState.getSelection();\n  const contentState = editorState.getCurrentContent();\n  const block = contentState.getBlockForKey(selectionState.getStartKey());\n  return block;\n};\n\n/*\nAdds a new block (currently replaces an empty block) at the current cursor position\nof the given `newType`.\n*/\nexport const addNewBlock = (editorState, newType = \"unstyled\", initialData = {}) => {\n  const selectionState = editorState.getSelection();\n  if (!selectionState.isCollapsed()) {\n    return editorState;\n  }\n  const contentState = editorState.getCurrentContent();\n  const key = selectionState.getStartKey();\n  const blockMap = contentState.getBlockMap();\n  const currentBlock = getCurrentBlock(editorState);\n  if (!currentBlock) {\n    return editorState;\n  }\n  if (currentBlock.getLength() === 0) {\n    if (currentBlock.getType() === newType) {\n      return editorState;\n    }\n    const newBlock = currentBlock.merge({\n      type: newType,\n      data: getDefaultBlockData(newType, initialData),\n    });\n    const newContentState = contentState.merge({\n      blockMap: blockMap.set(key, newBlock),\n      selectionAfter: selectionState,\n    });\n    return EditorState.push(editorState, newContentState, 'change-block-type');\n  }\n  return editorState;\n};\n\n\n/*\nChanges the block type of the current block.\n*/\nexport const resetBlockWithType = (editorState, newType = \"unstyled\") => {\n  const contentState = editorState.getCurrentContent();\n  const selectionState = editorState.getSelection();\n  const key = selectionState.getStartKey();\n  const blockMap = contentState.getBlockMap();\n  const block = blockMap.get(key);\n  let newText = '';\n  const text = block.getText();\n  if (block.getLength() >= 2) {\n    newText = text.substr(1);\n  }\n  const newBlock = block.merge({\n    text: newText,\n    type: newType,\n    data: getDefaultBlockData(newType),\n  });\n  const newContentState = contentState.merge({\n    blockMap: blockMap.set(key, newBlock),\n    selectionAfter: selectionState.merge({\n      anchorOffset: 0,\n      focusOffset: 0,\n    }),\n  });\n  return EditorState.push(editorState, newContentState, 'change-block-type');\n};\n\n\n/*\nUpdate block-level metadata of the given `block` to the `newData`/\n*/\nexport const updateDataOfBlock = (editorState, block, newData) => {\n  const contentState = editorState.getCurrentContent();\n  const newBlock = block.merge({\n    data: newData,\n  });\n  const newContentState = contentState.merge({\n    blockMap: contentState.getBlockMap().set(block.getKey(), newBlock),\n  });\n  return EditorState.push(editorState, newContentState, 'change-block-type');\n  // return editorState;\n};\n\n// const BEFORE = -1;\n// const AFTER = 1;\n\n/*\nUsed from [react-rte](https://github.com/sstur/react-rte/blob/master/src/lib/insertBlockAfter.js)\nby [sstur](https://github.com/sstur)\n*/\nexport const addNewBlockAt = (\n    editorState,\n    pivotBlockKey,\n    newBlockType = \"unstyled\",\n    initialData = {}\n  ) => {\n  const content = editorState.getCurrentContent();\n  const blockMap = content.getBlockMap();\n  const block = blockMap.get(pivotBlockKey);\n  const blocksBefore = blockMap.toSeq().takeUntil((v) => (v === block));\n  const blocksAfter = blockMap.toSeq().skipUntil((v) => (v === block)).rest();\n  const newBlockKey = genKey();\n\n  const newBlock = new ContentBlock({\n    key: newBlockKey,\n    type: newBlockType,\n    text: '',\n    characterList: block.getCharacterList().slice(0, 0),\n    depth: 0,\n    data: Map(getDefaultBlockData(newBlockType, initialData)),\n  });\n\n  const newBlockMap = blocksBefore.concat(\n    [[pivotBlockKey, block], [newBlockKey, newBlock]],\n    blocksAfter\n  ).toOrderedMap();\n\n  const selection = editorState.getSelection();\n\n  const newContent = content.merge({\n    blockMap: newBlockMap,\n    selectionBefore: selection,\n    selectionAfter: selection.merge({\n      anchorKey: newBlockKey,\n      anchorOffset: 0,\n      focusKey: newBlockKey,\n      focusOffset: 0,\n      isBackward: false,\n    }),\n  });\n  return EditorState.push(editorState, newContent, 'split-block');\n};\n","/*\nSome of the constants which are used throughout this project instead of directly using the string.\n*/\n\nexport const Block = {\n  UNSTYLED: 'unstyled',\n  OL: 'ordered-list-item',\n  UL: 'unordered-list-item',\n  H1: 'header-one',\n  H2: 'header-two',\n  H3: 'header-three',\n  H4: 'header-four',\n  H5: 'header-five',\n  H6: 'header-six',\n  CODE: 'code-block',\n  BLOCKQUOTE: 'blockquote',\n  PULLQUOTE: 'pullquote',\n  ATOMIC: 'atomic',\n  BLOCKQUOTE_CAPTION: 'block-quote-caption',\n  CAPTION: 'caption',\n  TODO: 'todo',\n  IMAGE: 'atomic:image',\n  BREAK: 'atomic:break',\n};\n\nexport const Inline = {\n  BOLD: 'BOLD',\n  CODE: 'CODE',\n  ITALIC: 'ITALIC',\n  STRIKETHROUGH: 'STRIKETHROUGH',\n  UNDERLINE: 'UNDERLINE',\n  HIGHLIGHT: 'HIGHLIGHT',\n};\n\nexport const Entity = {\n  LINK: 'LINK',\n};\n\nexport default {\n  Block,\n  Inline,\n  Entity,\n};\n","import {Entity} from 'draft-js';\nimport {convertToHTML} from 'draft-convert';\n\nconst toHTML = convertToHTML({\n  blockToHTML: (block) => {\n    if (block.type === 'atomic') {\n      // inspect metadata inside atomic block. if you're using block metadata,\n      // you can just inspect `block.data`, if not though we must inspect the\n      // entity range inside of the block.\n      if (block.entityRanges.length > 0) {\n        const entityKey = block.entityRanges[0].key;\n        const entity = Entity.get(entityKey);\n\n        // once you get here it depends on your app and what your entity data\n        // look like - in this example i'll pretend it uses the type to define\n        // if it's an image, a video, etc\n        const entityType = entity.getData().type;\n        // return unique wrapping block elements for each type of atomic block\n        if (entityType === 'ATOMIC-IMAGE') {\n          return {\n            start: '<div class=\"image-block\">',\n            end: '</div>'\n          };\n        }\n        else if (entityType === 'ATOMIC-VIDEO') {\n          return {\n            start: '<div class=\"video-block\">',\n            end: '</div>'\n          };\n        }\n      }\n    }\n    if (block.type === 'image'){\n      debugger\n      return {\n            start: '<div class=\"image-block\">',\n            end: '</div>'\n          };\n    }\n  },\n  entityToHTML: (entity, originalText) => {\n    if (entity.type === 'LINK') {\n      const href = entity.data.href;\n      return `<a href=${href}>${originalText}</a>`;\n    }\n    if (entity.type === 'ATOMIC-IMAGE') {\n      const src = entity.data.src;\n      return `<img src=\"${src}\" />`;\n    }\n    if (entity.type === 'ATOMIC-VIDEO') {\n      const src = entity.data.src;\n      const type = entity.data.type;\n      return `<video controls><source src=\"${src}\" type=\"${type}\"></video>`;\n    }\n    return originalText;\n  }\n});\n\n//const html = toHTML(contentState);\n\n//export default toHTML;\nmodule.exports = toHTML","{ ContentState\n  genKey \n  Entity \n  CharacterMetadata\n  ContentBlock\n  convertFromHTML\n  getSafeBodyFromHTML\n}  = require('draft-js')\n\n{ List\n  OrderedSet\n  Repeat\n  fromJS \n}  = require('immutable')\n\n{ compose \n}  = require('underscore')\n\n\n# from https://gist.github.com/N1kto/6702e1c2d89a33a15a032c234fc4c34e\n\n###\n# Helpers\n###\n\n# Prepares img meta data object based on img attributes\ngetBlockSpecForElement = (imgElement)=>\n  contentType: 'image',\n  imgSrc: imgElement.getAttribute('src')\n\n# Wraps meta data in HTML element which is 'understandable' by Draft, I used <blockquote />.\nwrapBlockSpec = (blockSpec)=>\n  if blockSpec == null\n    return null\n  \n  tempEl = document.createElement('blockquote')\n  # stringify meta data and insert it as text content of temp HTML element. We will later extract\n  # and parse it.\n  tempEl.innerText = JSON.stringify(blockSpec)\n  return tempEl\n\n# Replaces <img> element with our temp element\nreplaceElement = (oldEl, newEl)=>\n  if !(newEl instanceof HTMLElement)\n    return\n  \n  parentNode = oldEl.parentNode\n  return parentNode.replaceChild(newEl, oldEl)\n\n\nelementToBlockSpecElement = compose(wrapBlockSpec, getBlockSpecForElement)\n\nimgReplacer = (imgElement)=>\n  replaceElement(imgElement, elementToBlockSpecElement(imgElement))\n\n###\n# Main function\n###\n\n# takes HTML string and returns DraftJS ContentState\ncustomHTML2Content = (HTML, blockRn)->\n  tempDoc = new DOMParser().parseFromString(HTML, 'text/html')\n  # replace all <img /> with <blockquote /> elements\n  a = tempDoc.querySelectorAll('img').forEach( (item)->\n    return imgReplacer(item)\n  )\n\n  # use DraftJS converter to do initial conversion. I don't provide DOMBuilder and\n  # blockRenderMap arguments here since it should fall back to its default ones, which are fine\n  contentBlocks = convertFromHTML(tempDoc.body.innerHTML, \n        getSafeBodyFromHTML, \n        blockRn\n  )\n\n  # now replace <blockquote /> ContentBlocks with 'atomic' ones\n  contentBlocks = contentBlocks.map (block)->\n    debugger\n    if (block.getType() isnt 'blockquote')\n      return block\n    try\n      json = JSON.parse(block.getText())\n    catch\n      return block\n    \n    newBlock = block.merge({\n      type: \"image\",\n      text: \"\"\n      data: \n        url: json.imgSrc\n\n    });\n\n  tempDoc = null\n  return ContentState.createFromBlockArray(contentBlocks)\n\n\nmodule.exports = customHTML2Content","{ Entity } = require('draft-js')\n\nfindEntities = (entityType, contentBlock, callback)->\n  contentBlock.findEntityRanges (character) =>\n    entityKey = character.getEntity()\n    return (\n      entityKey isnt null &&\n      Entity.get(entityKey).getType() is entityType\n    );\n  ,\n  callback\n\nmodule.exports = findEntities","axios = require(\"axios\")\nImmutable = require('immutable')\n# ReactDOM = require('react-dom')\n\nclass SaveBehavior \n  constructor: (options)->\n    @config = options.config\n    @editorContent = options.editorContent\n\n  handleStore: (ev)->\n    @store()\n\n  store: (content)->\n    return unless @config.store_url\n    \n    clearTimeout(@timeout)\n    \n    @timeout = setTimeout =>\n      @checkforStore(content)\n    , @config.store_interval\n\n  checkforStore: (content)->\n    console.log \"ENTER DATA STORE\"\n  \n    # TODO check of content was changed!!\n    # console.log 'editor:', @.editorContent\n    # console.log 'content', content\n\n    isChanged = !Immutable.is(Immutable.fromJS(@.editorContent), Immutable.fromJS(content))\n    console.log(\"CONTENT CHANGED:\", isChanged)\n    \n    return unless isChanged\n\n    @config.before_xhr_handler() if @config.before_xhr_handler\n\n    axios\n      method: @config.store_method\n      url: @config.store_url\n      data: \n        data: JSON.stringify(content)\n    .then (result)=> \n      console.log \"STORING CONTENT\", result\n      @config.store_success_handler(result) if @config.store_success_handler\n      @config.success_xhr_handler(result) if @config.success_xhr_handler\n    .catch (error)=>\n      console.log(\"ERROR: got error uploading file #{error}\")\n      @config.failure_xhr_handler(error) if @config.failure_xhr_handler\n\n\nmodule.exports = SaveBehavior\n","/*\nReturns the `boundingClientRect` of the passed selection.\n*/\nexport const getSelectionRect = (selected) => {\n  const _rect = selected.getRangeAt(0).getBoundingClientRect();\n  // selected.getRangeAt(0).getBoundingClientRect()\n  let rect = _rect && _rect.top ? _rect : selected.getRangeAt(0).getClientRects()[0];\n  if (!rect) {\n    if (selected.anchorNode && selected.anchorNode.getBoundingClientRect) {\n      rect = selected.anchorNode.getBoundingClientRect();\n      rect.isEmptyline = true;\n    } else {\n      return null;\n    }\n  }\n  return rect;\n};\n\n/*\nReturns the native selection node.\n*/\nexport const getSelection = (root) => {\n  let t = null;\n  if (root.getSelection) {\n    t = root.getSelection();\n  } else if (root.document.getSelection) {\n    t = root.document.getSelection();\n  } else if (root.document.selection) {\n    t = root.document.selection.createRange().text;\n  }\n  return t;\n};\n\n/*\nRecursively finds the DOM Element of the block where the cursor is currently present.\nIf not found, returns null.\n*/\nexport const getSelectedBlockNode = (root) => {\n  const selection = root.getSelection();\n  if (selection.rangeCount === 0) {\n    return null;\n  }\n  let node = selection.getRangeAt(0).startContainer;\n  // console.log(node);\n  do {\n    if (node.getAttribute && node.getAttribute('data-block') === 'true') {\n      return node;\n    }\n    node = node.parentNode;\n    // console.log(node);\n  } while (node !== null);\n  return null;\n};\n","var Immutable = require('immutable');\n\nvar KEY_SEPARATOR = '-';\n\n/**\n * Creates a Draft decorator\n * @param {Function} strategy function (contentBlock, callback(start, end, props))\n * @param {Function} getComponent function (props) -> React.Component\n */\nfunction SimpleDecorator(strategy, getComponent) {\n    this.decorated = {};\n    this.strategy = strategy;\n    this.getComponent = getComponent;\n}\n\n/**\n * Return list of decoration IDs per character\n * @param {ContentBlock} block\n * @return {List<String>}\n */\nSimpleDecorator.prototype.getDecorations = function(block) {\n    var decorations = Array(block.getText().length).fill(null);\n    // Apply a decoration to given range, with given props\n    function callback (start, end, props) {\n        if (props === undefined) {\n            props = {};\n        }\n        key = blockKey + KEY_SEPARATOR + decorationId;\n        decorated[blockKey][decorationId] = props;\n        decorateRange(decorations, start, end, key);\n        decorationId++;\n    }\n\n    var blockKey = block.getKey();\n    var key;\n    var decorationId = 0;\n    var decorated = this.decorated;\n    decorated[blockKey] = {};\n\n    this.strategy(block, callback);\n\n    return Immutable.List(decorations);\n};\n\n/**\n * Return component to render a decoration\n * @param {String} key\n * @return {Function}\n */\nSimpleDecorator.prototype.getComponentForKey = function(key) {\n    return this.getComponent;\n};\n\n/**\n * Return props to render a decoration\n * @param {String} key\n * @return {Object}\n */\nSimpleDecorator.prototype.getPropsForKey = function(key) {\n    var parts = key.split(KEY_SEPARATOR);\n    var blockKey = parts[0];\n    var decorationId = parts[1];\n    return this.decorated[blockKey][decorationId];\n};\n\nfunction decorateRange(decorationsArray, start, end, key) {\n    for (var ii = start; ii < end; ii++) {\n        decorationsArray[ii] = key;\n    }\n}\n\nmodule.exports = SimpleDecorator;","String.prototype.killWhiteSpace = ()->\n  this.replace(/\\s/g, '')\n\nString.prototype.reduceWhiteSpace = ()->\n  this.replace(/\\s+/g, ' ')\n\nutils = {}\n#window.Dante.utils = utils\n\n\n## NEW ONES from react-text-editor\n\nutils.ajax = (options, cb)=>\n  xhr = new XMLHttpRequest();\n  xhr.open('GET', options.url);\n  xhr.onload = ()->\n    if xhr.status is 200\n      cb(xhr)\n      #alert('User\\'s name is ' + xhr.responseText);\n    else \n      cb(xhr)\n      #alert('Request failed.  Returned status of ' + xhr.status);\n    \n  xhr.send();\n\nutils.getSelectionRange = () =>\n  selection = window.getSelection();\n  return null if (selection.rangeCount is 0)\n  return selection.getRangeAt(0);\n\nutils.getSelectedBlockElement = (range) =>\n  node = range.startContainer;\n  while (node isnt null)\n    nodeIsDataBlock = if node.getAttribute then node.getAttribute('data-block') else null;\n    #return node if (nodeIsDataBlock)\n    node = node.parentNode;\n  \n  return null;\n\nutils.getSelectedNode = (range) =>\n  #debugger\n  node = range.startContainer;\n  while (node isnt null)\n    #nodeIsDataBlock = if node.getAttribute then node.getAttribute('data-block') else null;\n    #return node if (nodeIsDataBlock)\n    node = node.parentNode\n    return node\n  \n  return null;\n\nutils.getSelectionCoords = (selectionRange) =>\n  editorBounds = document.getElementById('richEditor').getBoundingClientRect();\n  rangeBounds = selectionRange.getBoundingClientRect();\n  rangeWidth = rangeBounds.right - rangeBounds.left;\n  rangeHeight = rangeBounds.bottom - rangeBounds.top;\n  offsetLeft = (rangeBounds.left - editorBounds.left) + (rangeWidth / 2) - (72 / 2);\n  # 42px is height of inline toolbar (35px) + 5px center triangle and 2px for spacing\n  offsetTop = rangeBounds.top - editorBounds.top - 42;\n  return { offsetLeft, offsetTop };\n\n\nutils.log = (message, force) ->\n  if (window.debugMode || force)\n    #console.log('%cDANTE DEBUGGER: %c' + message, 'font-family:arial,sans-serif;color:#1abf89;line-height:2em;', 'font-family:cursor,monospace;color:#333;');\n    #console.log('%cDANTE DEBUGGER: %c', 'font-family:arial,sans-serif;color:#1abf89;line-height:2em;', 'font-family:cursor,monospace;color:#333;');\n    console.log( message );\n\nutils.getBase64Image = (img) ->\n  canvas = document.createElement(\"canvas\")\n  canvas.width = img.width\n  canvas.height = img.height\n  ctx = canvas.getContext(\"2d\")\n  ctx.drawImage img, 0, 0\n  dataURL = canvas.toDataURL(\"image/png\")\n\n  # escape data:image prefix\n  # dataURL.replace /^data:image\\/(png|jpg);base64,/, \"\"\n\n  # or just return dataURL\n  return dataURL\n\nutils.generateUniqueName = ()->\n  Math.random().toString(36).slice(8)\n\n#http://stackoverflow.com/questions/5605401/insert-link-in-contenteditable-element\nutils.saveSelection = ()->\n  if window.getSelection\n    sel = window.getSelection()\n    if sel.getRangeAt and sel.rangeCount\n      ranges = []\n      i = 0\n      len = sel.rangeCount\n\n      while i < len\n        ranges.push sel.getRangeAt(i)\n        ++i\n      return ranges\n  else return document.selection.createRange()  if document.selection and document.selection.createRange\n  null\n\nutils.restoreSelection = (savedSel) ->\n  if savedSel\n    if window.getSelection\n      sel = window.getSelection()\n      sel.removeAllRanges()\n      i = 0\n      len = savedSel.length\n\n      while i < len\n        sel.addRange savedSel[i]\n        ++i\n    else savedSel.select()  if document.selection and savedSel.select\n  return\n\nutils.getNodeDIS = ()->\n  range = undefined\n  sel = undefined\n  container = undefined\n  if document.selection and document.selection.createRange\n\n    # IE case\n    range = document.selection.createRange()\n    range.parentElement()\n  else if window.getSelection\n    sel = window.getSelection()\n    if sel.getRangeAt\n      range = sel.getRangeAt(0)  if sel.rangeCount > 0\n    else\n\n      # Old WebKit selection object has no getRangeAt, so\n      # create a range from other selection properties\n      range = document.createRange()\n      range.setStart sel.anchorNode, sel.anchorOffset\n      range.setEnd sel.focusNode, sel.focusOffset\n\n      # Handle the case when the selection was selected backwards (from the end to the start in the document)\n      if range.collapsed isnt sel.isCollapsed\n        range.setStart sel.focusNode, sel.focusOffset\n        range.setEnd sel.anchorNode, sel.anchorOffset\n    if range\n      container = range.commonAncestorContainer\n\n      # Check if the container is a text node and return its parent if so\n      (if container.nodeType is 3 then container.parentNode else container)\n\n#http://stackoverflow.com/questions/12603397/calculate-width-height-of-the-selected-text-javascript\nutils.getSelectionDimensionsDIS = ->\n  sel = document.selection\n  range = undefined\n  width = 0\n  height = 0\n  left = 0\n  top = 0\n  if sel\n    unless sel.type is \"Control\"\n      range = sel.createRange()\n      width = range.boundingWidth\n      height = range.boundingHeight\n  else if window.getSelection\n    sel = window.getSelection()\n    if sel.rangeCount\n      range = sel.getRangeAt(0).cloneRange()\n      if range.getBoundingClientRect\n        rect = range.getBoundingClientRect()\n        width = rect.right - rect.left\n        height = rect.bottom - rect.top\n\n    return rect\n\nutils.getSelectionDimensions = (selected) =>\n  _rect = selected.getRangeAt(0).getBoundingClientRect();\n  #selected.getRangeAt(0).getBoundingClientRect()\n  rect = _rect && _rect.top ? _rect : selected.getRangeAt(0).getClientRects()[0];\n  if (!rect)\n    if (selected.anchorNode && selected.anchorNode.getBoundingClientRect)\n      rect = selected.anchorNode.getBoundingClientRect()\n      rect.isEmptyline = true\n    else\n      return null\n  return rect\n\nutils.getNode = (root= window) =>\n  t = null;\n  if (root.getSelection)\n    t = root.getSelection();\n  else if (root.document.getSelection)\n    t = root.document.getSelection();\n  else if (root.document.selection)\n    t = root.document.selection.createRange().text;\n  return t;\n\n#http://stackoverflow.com/questions/3972014/get-caret-position-in-contenteditable-div\nutils.getCaretPosition = (editableDiv) ->\n  caretPos = 0\n  containerEl = null\n  sel = undefined\n  range = undefined\n  if window.getSelection\n    sel = window.getSelection()\n    if sel.rangeCount\n      range = sel.getRangeAt(0)\n      caretPos = range.endOffset  if range.commonAncestorContainer.parentNode is editableDiv\n  else if document.selection and document.selection.createRange\n    range = document.selection.createRange()\n    if range.parentElement() is editableDiv\n      tempEl = document.createElement(\"span\")\n      editableDiv.insertBefore tempEl, editableDiv.firstChild\n      tempRange = range.duplicate()\n      tempRange.moveToElementText tempEl\n      tempRange.setEndPoint \"EndToEnd\", range\n      caretPos = tempRange.text.length\n  caretPos\n\n#http://stackoverflow.com/questions/123999/how-to-tell-if-a-dom-element-is-visible-in-the-current-viewport\nutils.isElementInViewport = (el) ->\n  #special bonus for those using jQuery\n  el = el[0]  if typeof jQuery is \"function\" and el instanceof jQuery\n  rect = el.getBoundingClientRect()\n  #or $(window).height()\n  rect.top >= 0 and rect.left >= 0 and rect.bottom <= (window.innerHeight or document.documentElement.clientHeight) and rect.right <= (window.innerWidth or document.documentElement.clientWidth) #or $(window).width()\n\n#http://brianmhunt.github.io/articles/taming-contenteditable/\n\nutils.getSelectedText = () ->\n  text = \"\"\n  if typeof window.getSelection != \"undefined\"\n    text = window.getSelection().toString()\n  else if typeof document.selection != \"undefined\" && document.selection.type == \"Text\"\n    text = document.selection.createRange().text\n  text\n\nutils.selection = ()=>\n  selection\n  if (window.getSelection)\n    selection = window.getSelection()\n  else if (document.selection && document.selection.type != \"Control\")\n    selection = document.selection\n\nutils.getSelectionStart = ->\n  node = document.getSelection().anchorNode\n  return if node is null\n  if node.nodeType == 3 then node.parentNode else node\n\nutils.getRange = () ->\n  editor = $(@el)[0]\n  range = selection && selection.rangeCount && selection.getRangeAt(0)\n  range = document.createRange() if (!range)\n  if !editor.contains(range.commonAncestorContainer)\n    range.selectNodeContents(editor)\n    range.collapse(false)\n  range\n\nutils.setRange = (range)->\n  range = range || this.current_range\n  if !range\n    range = this.getRange()\n    range.collapse(false) # set to end\n\n  @selection().removeAllRanges()\n  @selection().addRange(range)\n  @\n\nutils.getCharacterPrecedingCaret = ->\n  precedingChar = \"\"\n  sel = undefined\n  range = undefined\n  precedingRange = undefined\n  if window.getSelection\n    sel = window.getSelection()\n    if sel.rangeCount > 0\n      range = sel.getRangeAt(0).cloneRange()\n      range.collapse true\n      range.setStart @getNode(), 0\n      precedingChar = range.toString().slice(0)\n  else if (sel = document.selection) and sel.type isnt \"Control\"\n    range = sel.createRange()\n    precedingRange = range.duplicate()\n    precedingRange.moveToElementText containerEl\n    precedingRange.setEndPoint \"EndToStart\", range\n    precedingChar = precedingRange.text.slice(0)\n  precedingChar\n\nutils.isLastChar = ()->\n  $(@getNode()).text().trim().length is @getCharacterPrecedingCaret().trim().length\n\nutils.isFirstChar = ()->\n  @getCharacterPrecedingCaret().trim().length is 0\n\nutils.isSelectingAll = (element)->\n  a = @getSelectedText().killWhiteSpace().length\n  b = $(element).text().killWhiteSpace().length\n  a is b\n\n#set focus and caret position on element\nutils.setRangeAt = (element, pos=0)->\n  range = document.createRange()\n  sel = window.getSelection()\n  #node = element.firstChild;\n  range.setStart(element, pos); #DANGER this is supported by IE 9\n  #range.setStartAfter(element)\n  #range.setEnd(element, int);\n  range.collapse(true)\n  sel.removeAllRanges()\n  sel.addRange(range)\n  element.focus()\n\n#set focus and caret position on element\nutils.setRangeAtText = (element, pos=0)->\n  range = document.createRange()\n  sel = window.getSelection()\n  node = element.firstChild;\n  range.setStart(node, 0); #DANGER this is supported by IE 9\n  range.setEnd(node, 0);\n  range.collapse(true)\n  sel.removeAllRanges()\n  sel.addRange(range)\n  element.focus()\n\n\nLINE_HEIGHT = 20\n\nis_caret_at_start_of_node = (node, range) ->\n  # See: http://stackoverflow.com/questions/7451468\n  pre_range = document.createRange()\n  pre_range.selectNodeContents(node)\n  pre_range.setEnd(range.startContainer, range.startOffset)\n  return pre_range.toString().trim().length == 0\n\nis_caret_at_end_of_node = (node, range) ->\n  post_range = document.createRange()\n  post_range.selectNodeContents(node)\n  post_range.setStart(range.endContainer, range.endOffset)\n  return post_range.toString().trim().length == 0\n\n\n### DOM UTILS ###\n\n# http://stackoverflow.com/questions/21474678/scrolltop-animation-without-jquery\nutils.scrollTop = (element, to, duration)->\n  return if (duration <= 0) \n\n  difference = to - element.scrollTop;\n  perTick = difference / duration * 10;\n\n  setTimeout( ()->\n      element.scrollTop = element.scrollTop + perTick;\n      return if (element.scrollTop is to)\n      scrollTo(element, to, duration - 10);\n  , 10);\n\nutils.outerHeight = (el)->\n  height = el.offsetHeight\n  style = getComputedStyle(el)\n\n  height += parseInt(style.marginTop) + parseInt(style.marginBottom)\n  return height\n\n###\n$.fn.editableIsCaret = ->\n  return window.getSelection().type == 'Caret'\n  # alt test:\n  # return sel.rangeCount == 1 and sel.getRangeAt(0).collapsed\n\n$.fn.editableRange = ->\n  # Return the range for the selection\n  sel = window.getSelection()\n  return unless sel.rangeCount > 0\n  return sel.getRangeAt(0)\n\n$.fn.editableCaretRange = ->\n  return unless @editableIsCaret()\n  return @editableRange()\n\n$.fn.editableSetRange = (range) ->\n  sel = window.getSelection()\n  sel.removeAllRanges() if sel.rangeCount > 0\n  sel.addRange(range)\n\n$.fn.editableFocus = (at_start=true) ->\n  return unless @attr('contenteditable')\n  sel = window.getSelection()\n  sel.removeAllRanges() if sel.rangeCount > 0\n  range = document.createRange()\n  range.selectNodeContents(@[0])\n  range.collapse(at_start)\n  sel.addRange(range)\n\n$.fn.editableCaretAtStart = ->\n  range = @editableRange()\n  return false unless range\n  return is_caret_at_start_of_node(@[0], range)\n\n$.fn.editableCaretAtEnd = ->\n  range = @editableRange()\n  return false unless range\n  return is_caret_at_end_of_node(@[0], range)\n\n$.fn.editableCaretOnFirstLine = ->\n  range = @editableRange()\n  return false unless range\n  # At the start of a node, the getClientRects() is [], so we have to\n  # use the getBoundingClientRect (which seems to work).\n  if is_caret_at_start_of_node(@[0], range)\n    return true\n  else if is_caret_at_end_of_node(@[0], range)\n    ctop = @[0].getBoundingClientRect().bottom - LINE_HEIGHT\n  else\n    ctop = range.getClientRects()[0].top\n  etop = @[0].getBoundingClientRect().top\n  return ctop < etop + LINE_HEIGHT\n\n$.fn.editableCaretOnLastLine = ->\n  range = @editableRange()\n  return false unless range\n  if is_caret_at_end_of_node(@[0], range)\n    return true\n  else if is_caret_at_start_of_node(@[0], range)\n    # We are on the first line.\n    cbtm = @[0].getBoundingClientRect().top + LINE_HEIGHT\n  else\n    cbtm = range.getClientRects()[0].bottom\n  ebtm = @[0].getBoundingClientRect().bottom\n  return cbtm > ebtm - LINE_HEIGHT\n\n$.fn.exists = ->\n  @.length > 0\n###\n\n\n\n\nmodule.exports = utils"]}