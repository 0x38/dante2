webpackJsonp([1],{0:function(t,e,o){"use strict";o(291),window.Dante=o(196)},25:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.addNewBlockAt=e.updateTextOfBlock=e.updateDataOfBlock=e.resetBlockWithType=e.addNewBlock=e.getCurrentBlock=e.getNode=e.getDefaultBlockData=void 0;var i=o(32),n=o(9),r=e.getDefaultBlockData=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t){default:return e}},s=(e.getNode=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=null;return t.getSelection?e=t.getSelection():t.document.getSelection?e=t.document.getSelection():t.document.selection&&(e=t.document.selection.createRange().text),e},e.getCurrentBlock=function(t){var e=t.getSelection(),o=t.getCurrentContent(),i=o.getBlockForKey(e.getStartKey());return i});e.addNewBlock=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unstyled",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t.getSelection();if(!i.isCollapsed())return t;var a=t.getCurrentContent(),l=i.getStartKey(),c=a.getBlockMap(),p=s(t);if(!p)return t;if(0===p.getLength()){if(p.getType()===e)return t;var h=p.merge({type:e,data:r(e,o)}),d=a.merge({blockMap:c.set(l,h),selectionAfter:i});return n.EditorState.push(t,d,"change-block-type")}return t},e.resetBlockWithType=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unstyled",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t.getCurrentContent(),s=t.getSelection(),a=s.getStartKey(),l=i.getBlockMap(),c=l.get(a),p="";console.log("DATA FOR PLACEHOLDER!",o);var h=c.getText();c.getLength()>=2&&(p=h.substr(1));var d=c.merge({text:p,type:e,data:r(e,o)}),u=i.merge({blockMap:l.set(a,d),selectionAfter:s.merge({anchorOffset:0,focusOffset:0})});return n.EditorState.push(t,u,"change-block-type")},e.updateDataOfBlock=function(t,e,o){var i=t.getCurrentContent(),r=e.merge({data:o}),s=i.merge({blockMap:i.getBlockMap().set(e.getKey(),r)});return n.EditorState.push(t,s,"change-block-type")},e.updateTextOfBlock=function(t,e,o){var i=t.getCurrentContent(),r=e.merge({text:o}),s=i.merge({blockMap:i.getBlockMap().set(e.getKey(),r)});return n.EditorState.push(t,s,"change-block-type")},e.addNewBlockAt=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unstyled",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=t.getCurrentContent(),l=a.getBlockMap(),c=l.get(e),p=l.toSeq().takeUntil(function(t){return t===c}),h=l.toSeq().skipUntil(function(t){return t===c}).rest(),d=(0,n.genKey)(),u=new n.ContentBlock({key:d,type:o,text:"",characterList:c.getCharacterList().slice(0,0),depth:0,data:(0,i.Map)(r(o,s))}),f=p.concat([[e,c],[d,u]],h).toOrderedMap(),g=t.getSelection(),m=a.merge({blockMap:f,selectionBefore:g,selectionAfter:g.merge({anchorKey:d,anchorOffset:0,focusKey:d,focusOffset:0,isBackward:!1})});return n.EditorState.push(t,m,"split-block")}},48:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getSelectionRect=function(t){var e=t.getRangeAt(0).getBoundingClientRect(),o=e&&e.top?e:t.getRangeAt(0).getClientRects()[0];if(!o){if(!t.anchorNode||!t.anchorNode.getBoundingClientRect)return null;o=t.anchorNode.getBoundingClientRect(),o.isEmptyline=!0}return o},e.getSelection=function(t){var e=null;return t.getSelection?e=t.getSelection():t.document.getSelection?e=t.document.getSelection():t.document.selection&&(e=t.document.selection.createRange().text),e},e.getSelectedBlockNode=function(t){var e=t.getSelection();if(0===e.rangeCount)return null;var o=e.getRangeAt(0).startContainer;do{if(o.getAttribute&&"true"===o.getAttribute("data-block"))return o;o=o.parentNode}while(null!==o);return null}},145:function(t,e,o){t.exports=o.p+"fonts/dante.eot"},146:function(t,e,o){t.exports=o.p+"fonts/fontello.eot"},193:function(t,e,o){var i,n,r,s,a,l,c,p,h,d,u,f,g,m,y,k,_,b,v,S,E;b=o(9),r=b.ContentState,g=b.genKey,s=b.Entity,i=b.CharacterMetadata,n=b.ContentBlock,h=b.convertFromHTML,y=b.getSafeBodyFromHTML,v=o(32),a=v.List,l=v.OrderedSet,c=v.Repeat,f=v.fromJS,p=o(382).compose,m=function(t){return function(t){return{contentType:"image",imgSrc:t.getAttribute("src")}}}(this),E=function(t){return function(t){var e;return null===t?null:(e=document.createElement("blockquote"),e.innerText=JSON.stringify(t),e)}}(this),S=function(t){return function(t,e){var o;if(e instanceof HTMLElement)return o=k(t),o.parentNode.insertBefore(e,o)}}(this),k=function(t){return function(t){var e;for(e=t;t.parentNode;)if("BODY"!==t.parentNode.tagName&&(t=t.parentNode),"BODY"===t.parentNode.tagName)return t}}(this),u=p(E,m),_=function(t){return function(t){return S(t,u(t))}}(this),d=function(t,e){var o,i,n;return n=(new DOMParser).parseFromString(t,"text/html"),o=n.querySelectorAll("img").forEach(function(t){return _(t)}),console.log(n.body.innerHTML),i=h(n.body.innerHTML,y,e),i=i.map(function(t){var e,o;if(console.log("CHECK BLOCK",t.getType()),"blockquote"!==t.getType())return t;e="";try{e=JSON.parse(t.getText())}catch(i){return t}return o=t.merge({type:"image",text:"",data:{url:e.imgSrc,forceUpload:!0}})}),n=null,r.createFromBlockArray(i)},t.exports=d},194:function(t,e,o){var i,n;i=o(9).Entity,n=function(t,e,o){return e.findEntityRanges(function(e){return function(e){var o;return o=e.getEntity(),null!==o&&i.get(o).getType()===t}}(this),o)},t.exports=n},195:function(t,e,o){var i,n,r;r=o(47),i=o(32),n=function(){function t(t){this.getLocks=t.getLocks,this.config=t.config,this.editorContent=t.editorContent,this.editorState=t.editorState}return t.prototype.handleStore=function(t){return this.store()},t.prototype.store=function(t){if(this.config.data_storage.url&&!(this.getLocks()>0))return clearTimeout(this.timeout),this.timeout=setTimeout(function(e){return function(){return e.checkforStore(t)}}(this),this.config.data_storage.interval)},t.prototype.getTextFromEditor=function(t){return t.blocks.map(function(t){return function(t){return t.text}}(this)).join("\n")},t.prototype.checkforStore=function(t){var e;if(e=!i.is(i.fromJS(this.editorContent),i.fromJS(t)))return this.config.xhr.before_handler&&this.config.xhr.before_handler(),r({method:this.config.data_storage.method,url:this.config.data_storage.url,data:{editor_content:JSON.stringify(t),text_content:this.getTextFromEditor(t)}}).then(function(t){return function(e){if(t.config.data_storage.success_handler&&t.config.data_storage.success_handler(e),t.config.xhr.success_handler)return t.config.xhr.success_handler(e)}}(this))["catch"](function(t){return function(e){if(t.config.xhr.failure_handler)return t.config.xhr.failure_handler(e)}}(this))},t}(),t.exports=n},196:function(module,exports,__webpack_require__){var BlockMapBuilder,CompositeDecorator,ContentState,Dante,DanteAnchorPopover,DanteEditor,DanteImagePopover,DanteInlineTooltip,DanteTooltip,Debug,DefaultDraftBlockRenderMap,DraftPasteProcessor,Editor,EditorState,EmbedBlock,Entity,ImageBlock,Immutable,KeyBindingUtil,KeyCodes,Link,Map,Modifier,PlaceholderBlock,React,ReactDOM,RichUtils,SaveBehavior,SelectionState,VideoBlock,addNewBlock,addNewBlockAt,convertFromHTML,convertFromRaw,convertToHTML,convertToRaw,customHTML2Content,findEntities,getCurrentBlock,getDefaultKeyBinding,getSafeBodyFromHTML,getSelection,getSelectionOffsetKeyForNode,getSelectionRect,getVisibleSelectionRect,isSoftNewlineEvent,ref,ref1,ref2,ref3,resetBlockWithType,stateToHTML,updateDataOfBlock,updateTextOfBlock,bind=function(t,e){return function(){return t.apply(e,arguments)}},extend=function(t,e){function o(){this.constructor=t}for(var i in e)hasProp.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;React=__webpack_require__(6),ReactDOM=__webpack_require__(13),Immutable=__webpack_require__(32),Map=__webpack_require__(32).Map,ref=__webpack_require__(9),convertToRaw=ref.convertToRaw,convertFromRaw=ref.convertFromRaw,CompositeDecorator=ref.CompositeDecorator,getVisibleSelectionRect=ref.getVisibleSelectionRect,getDefaultKeyBinding=ref.getDefaultKeyBinding,getSelectionOffsetKeyForNode=ref.getSelectionOffsetKeyForNode,KeyBindingUtil=ref.KeyBindingUtil,ContentState=ref.ContentState,Editor=ref.Editor,EditorState=ref.EditorState,Entity=ref.Entity,RichUtils=ref.RichUtils,DefaultDraftBlockRenderMap=ref.DefaultDraftBlockRenderMap,SelectionState=ref.SelectionState,Modifier=ref.Modifier,BlockMapBuilder=ref.BlockMapBuilder,getSafeBodyFromHTML=ref.getSafeBodyFromHTML,DraftPasteProcessor=__webpack_require__(119),stateToHTML=__webpack_require__(222).stateToHTML,ref1=__webpack_require__(214),convertToHTML=ref1.convertToHTML,convertFromHTML=ref1.convertFromHTML,isSoftNewlineEvent=__webpack_require__(274),ref2=__webpack_require__(25),addNewBlock=ref2.addNewBlock,resetBlockWithType=ref2.resetBlockWithType,updateDataOfBlock=ref2.updateDataOfBlock,updateTextOfBlock=ref2.updateTextOfBlock,getCurrentBlock=ref2.getCurrentBlock,addNewBlockAt=ref2.addNewBlockAt,updateDataOfBlock=ref2.updateDataOfBlock,DanteImagePopover=__webpack_require__(204),DanteAnchorPopover=__webpack_require__(205),KeyCodes={BACKSPACE:8,TAB:9,ENTER:13,SPACEBAR:32,LEFTARROW:37,UPARROW:38,RIGHTARROW:39,DOWNARROW:40},ref3=__webpack_require__(48),getSelectionRect=ref3.getSelectionRect,getSelection=ref3.getSelection,DanteInlineTooltip=__webpack_require__(203),DanteTooltip=__webpack_require__(206),Link=__webpack_require__(202),Debug=__webpack_require__(201),findEntities=__webpack_require__(194),ImageBlock=__webpack_require__(198),EmbedBlock=__webpack_require__(197),VideoBlock=__webpack_require__(200),PlaceholderBlock=__webpack_require__(199),SaveBehavior=__webpack_require__(195),customHTML2Content=__webpack_require__(193),Dante=function(){function t(t){null==t&&(t={}),console.log("init editor Dante!"),this.options=t,this.options.el=t.el||"app",this.options.poc=t.poc,this.options.content=t.content,this.options.read_only=t.read_only||!1,this.options.spellcheck=t.spellcheck||!1,this.options.title_placeholder=t.title_placeholder||"Title",this.options.body_placeholder=t.body_placeholder||"Write your story",this.options.api_key=t.api_key||"86c28a410a104c8bb58848733c82f840",this.options.widgets=[{title:"add a image",icon:"image",type:"image",block:"ImageBlock",renderable:!0,breakOnContinuous:!0,wrapper_class:"graf graf--figure",selected_class:" is-selected is-mediaFocused",selectedFn:function(t){return function(t){var e;switch(e=t.getData().toJS().direction){case"left":return"graf--layoutOutsetLeft";case"center":return"";case"wide":return"sectionLayout--fullWidth";case"fill":return"graf--layoutFillWidth"}}}(this),handleEnterWithoutText:function(t,e){var o;return o=t.state.editorState,t.onChange(addNewBlockAt(o,e.getKey()))},handleEnterWithText:function(t,e){var o;return o=t.state.editorState,t.onChange(addNewBlockAt(o,e.getKey()))},widget_options:{displayOnInlineTooltip:!0,insertion:"upload",insert_block:"image"},options:{upload_url:t.upload_url||"uploads.json",upload_callback:this.options.image_upload_callabck,image_delete_callback:this.options.image_delete_callback,image_caption_placeholder:t.image_caption_placeholder}},{icon:"embed",title:"insert embed",type:"embed",block:"EmbedBlock",renderable:!0,breakOnContinuous:!0,wrapper_class:"graf graf--mixtapeEmbed",selected_class:"is-selected is-mediaFocused",widget_options:{displayOnInlineTooltip:!0,insertion:"placeholder",insert_block:"embed"},options:{endpoint:"//api.embed.ly/1/extract?key="+this.options.api_key+"&url=",placeholder:"Paste a link to embed content from another site (e.g. Twitter) and press Enter"},handleEnterWithoutText:function(t,e){var o;return o=t.state.editorState,t.onChange(addNewBlockAt(o,e.getKey()))},handleEnterWithText:function(t,e){var o;return o=t.state.editorState,t.onChange(addNewBlockAt(o,e.getKey()))}},{icon:"video",title:"insert video",type:"video",block:"VideoBlock",renderable:!0,breakOnContinuous:!0,wrapper_class:"graf--figure graf--iframe",selected_class:" is-selected is-mediaFocused",widget_options:{displayOnInlineTooltip:!0,insertion:"placeholder",insert_block:"video"},options:{endpoint:"//api.embed.ly/1/oembed?key="+this.options.api_key+"&url=",placeholder:"Paste a YouTube, Vine, Vimeo, or other video link, and press Enter",caption:"Type caption for embed (optional)"},handleEnterWithoutText:function(t,e){var o;return o=t.state.editorState,t.onChange(addNewBlockAt(o,e.getKey()))},handleEnterWithText:function(t,e){var o;return o=t.state.editorState,t.onChange(addNewBlockAt(o,e.getKey()))}},{renderable:!0,block:"PlaceholderBlock",type:"placeholder",wrapper_class:"is-embedable",selected_class:" is-selected is-mediaFocused",widget_options:{displayOnInlineTooltip:!1},handleEnterWithText:function(t,e){var o,i;return i=t.state.editorState,o={provisory_text:e.getText(),endpoint:e.getData().get("endpoint"),type:e.getData().get("type")},t.onChange(resetBlockWithType(i,o.type,o))}}],this.options.tooltips=[{type:"menu",ref:"insert_tooltip",display:!1,component:DanteTooltip,displayOnSelection:!0,selectionElements:["unstyled","blockquote","ordered-list","unordered-list","unordered-list-item","ordered-list-item","code-block","header-one","header-two","header-three"]},{type:"inline_tooltip",ref:"add_tooltip",display:!1,component:DanteInlineTooltip},{type:"anchor",ref:"anchor_popover",display:!1,component:DanteAnchorPopover},{type:"image",ref:"image_popover",display:!1,component:DanteImagePopover}],this.options.xhr={before_handler:t.before_xhr_handler,success_handler:t.success_xhr_handler,error_handler:t.success_xhr_handler},this.options.data_storage={url:t.store_url||null,method:t.store_method||"POST",success_handler:t.store_success_handler||null,failure_handler:t.store_failure_handler||null,interval:t.store_interval||1500},this.options.continuousBlocks=["unstyled","blockquote","ordered-list","unordered-list","unordered-list-item","ordered-list-item","code-block"],this.options.block_types=[{label:"h3",style:"header-one",type:"block"},{label:"h4",style:"header-two",type:"block"},{label:"blockquote",style:"blockquote",type:"block"},{label:"insertunorderedlist",style:"unordered-list-item",type:"block"},{label:"insertorderedlist",style:"ordered-list-item",type:"block"},{label:"code",style:"code-block",type:"block"},{label:"bold",style:"BOLD",type:"inline"},{label:"italic",style:"ITALIC",type:"inline"}],this.options.key_commands={"alt-shift":[{key:65,cmd:"add-new-block"}],"alt-cmd":[{key:49,cmd:"toggle_block:header-one"},{key:50,cmd:"toggle_block:header-two"},{key:53,cmd:"toggle_block:blockquote"}],cmd:[{key:66,cmd:"toggle_inline:BOLD"},{key:73,cmd:"toggle_inline:ITALIC"},{key:75,cmd:"insert:link"}]}}return t.prototype.getContent=function(){return this.options.content},t.prototype.render=function(){return ReactDOM.render(React.createElement(DanteEditor,{content:this.getContent(),config:this.options}),document.getElementById(this.options.el))},t}(),DanteEditor=function(superClass){function DanteEditor(t){this.render=bind(this.render,this),this.hidePopLinkOver=bind(this.hidePopLinkOver,this),this.showPopLinkOver=bind(this.showPopLinkOver,this),this.handleHidePopLinkOver=bind(this.handleHidePopLinkOver,this),this.handleShowPopLinkOver=bind(this.handleShowPopLinkOver,this),this.tooltipHasSelectionElement=bind(this.tooltipHasSelectionElement,this),this.tooltipsWithProp=bind(this.tooltipsWithProp,this),this.relocateTooltips=bind(this.relocateTooltips,this),this.closePopOvers=bind(this.closePopOvers,this),this.toggleEditable=bind(this.toggleEditable,this),this.toggleReadOnly=bind(this.toggleReadOnly,this),this.setDirection=bind(this.setDirection,this),this.updateBlockData=bind(this.updateBlockData,this),this.KeyBindingFn=bind(this.KeyBindingFn,this),this.findCommandKey=bind(this.findCommandKey,this),this.handleKeyCommand=bind(this.handleKeyCommand,this),this.handleBeforeInput=bind(this.handleBeforeInput,this),this.handleReturn=bind(this.handleReturn,this),this.handleDownArrow=bind(this.handleDownArrow,this),this.handleUpArrow=bind(this.handleUpArrow,this),this.handleDroppedFiles=bind(this.handleDroppedFiles,this),this.handlePasteImage=bind(this.handlePasteImage,this),this.handleHTMLPaste=bind(this.handleHTMLPaste,this),this.handleTXTPaste=bind(this.handleTXTPaste,this),this.handlePasteText=bind(this.handlePasteText,this),this.styleForBlock=bind(this.styleForBlock,this),this.getDataBlock=bind(this.getDataBlock,this),this.blockStyleFn=bind(this.blockStyleFn,this),this.handleBlockRenderer=bind(this.handleBlockRenderer,this),this.blockRenderer=bind(this.blockRenderer,this),this.renderableBlocks=bind(this.renderableBlocks,this),this.removeLock=bind(this.removeLock,this),this.addLock=bind(this.addLock,this),this.getLocks=bind(this.getLocks,this),this.logStateText=bind(this.logStateText,this),this.logStateJSON=bind(this.logStateJSON,this),this.getTextFromEditor=bind(this.getTextFromEditor,this),this.testEmitTEXT=bind(this.testEmitTEXT,this),this.testEmitAndDecode=bind(this.testEmitAndDecode,this),this.decodeEditorContent=bind(this.decodeEditorContent,this),this.emitSerializedOutput=bind(this.emitSerializedOutput,this),this.getEditorState=bind(this.getEditorState,this),this.focus=bind(this.focus,this),this.setPreContent=bind(this.setPreContent,this),this.dispatchChangesToSave=bind(this.dispatchChangesToSave,this),this.onChange=bind(this.onChange,this),this.forceRender=bind(this.forceRender,this),this.refreshSelection=bind(this.refreshSelection,this),this.initializeState=bind(this.initializeState,this),DanteEditor.__super__.constructor.call(this,t),window.main_editor=this,this.decorator=new CompositeDecorator([{strategy:findEntities.bind(null,"link"),component:Link}]),this.blockRenderMap=Map({image:{element:"figure"},video:{element:"figure"},embed:{element:"div"},unstyled:{wrapper:null,element:"div"},paragraph:{wrapper:null,element:"div"},placeholder:{wrapper:null,element:"div"}}),this.extendedBlockRenderMap=DefaultDraftBlockRenderMap.merge(this.blockRenderMap),this.state={editorState:this.initializeState(),read_only:this.props.config.read_only,blockRenderMap:this.extendedBlockRenderMap,locks:0,debug:this.props.config.debug,debug_json:null,debug_text:null},this.widgets=t.config.widgets,this.tooltips=t.config.tooltips,this.key_commands=t.config.key_commands,this.continuousBlocks=this.props.config.continuousBlocks,this.block_types=this.props.config.block_types,this.save=new SaveBehavior({getLocks:this.getLocks,config:{xhr:this.props.config.xhr,data_storage:this.props.config.data_storage},editorState:this.state.editorState,editorContent:this.emitSerializedOutput()})}return extend(DanteEditor,superClass),DanteEditor.prototype.initializeState=function(){return this.props.content?this.decodeEditorContent(this.props.content):EditorState.createEmpty(this.decorator)},DanteEditor.prototype.refreshSelection=function(t){var e,o,i,n,r,s,a;return i=this.state.editorState,s=this.state.editorState.getSelection(),o=i.getCurrentContent(),a=SelectionState.createEmpty(s.getAnchorKey()),n=s.getFocusOffset(),e=s.getAnchorKey(),a=a.merge({anchorOffset:n,focusKey:e,focusOffset:n}),r=EditorState.forceSelection(t,a),this.onChange(r)},DanteEditor.prototype.forceRender=function(t){var e,o,i;return i=this.state.editorState.getSelection(),e=t.getCurrentContent(),o=EditorState.createWithContent(e,this.decorator),this.refreshSelection(o)},DanteEditor.prototype.onChange=function(t){var e,o,i;if(this.setPreContent(),this.setState({editorState:t}),o=getCurrentBlock(this.state.editorState),e=o.getType(),t.getSelection().isCollapsed())this.handleTooltipDisplayOn("displayOnSelection",!1);else{if(i=this.tooltipsWithProp("displayOnSelection")[0],!this.tooltipHasSelectionElement(i,e))return;this.handleTooltipDisplayOn("displayOnSelection")}return setTimeout(function(t){return function(){return t.relocateTooltips()}}(this),0),this.dispatchChangesToSave()},DanteEditor.prototype.dispatchChangesToSave=function(){return clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(function(t){return function(){return t.save.store(t.emitSerializedOutput())}}(this),100)},DanteEditor.prototype.setPreContent=function(){var t;return t=this.emitSerializedOutput(),this.save.editorContent=t},DanteEditor.prototype.focus=function(){},DanteEditor.prototype.getEditorState=function(){return this.state.editorState},DanteEditor.prototype.emitSerializedOutput=function(){var t;return t=convertToRaw(this.state.editorState.getCurrentContent())},DanteEditor.prototype.decodeEditorContent=function(t){var e,o;return o=convertFromRaw(t),e=EditorState.createWithContent(o,this.decorator)},DanteEditor.prototype.testEmitAndDecode=function(t){var e;return t.preventDefault(),e=this.emitSerializedOutput(),this.setState({editorState:this.decodeEditorContent(e)},this.logStateJSON(e)),!1},DanteEditor.prototype.testEmitTEXT=function(t){var e;return t.preventDefault(),e=this.getTextFromEditor(),this.logStateText(e)},DanteEditor.prototype.getTextFromEditor=function(){var t,e;return t=this.state.editorState.getCurrentContent(),e=t.getBlocksAsArray().map(function(t){return function(t){return t.getText()}}(this)).join("\n"),console.log(e),e},DanteEditor.prototype.logStateJSON=function(t){return this.setState({debug_json:t})},DanteEditor.prototype.logStateText=function(t){return this.setState({debug_text:t})},DanteEditor.prototype.emitHTML2=function(){var t;return t=convertToHTML({entityToHTML:function(t){return function(t,e){return"LINK"===t.type?'<a href="'+t.data.url+'">'+e+"</a>":e}}(this)})(this.state.editorState.getCurrentContent())},DanteEditor.prototype.getLocks=function(){return this.state.locks},DanteEditor.prototype.addLock=function(){return this.setState({locks:this.state.locks+=1})},DanteEditor.prototype.removeLock=function(){return this.setState({locks:this.state.locks-=1})},DanteEditor.prototype.renderableBlocks=function(){return this.widgets.filter(function(t){return t.renderable}).map(function(t){return t.type})},DanteEditor.prototype.blockRenderer=function(t){var e,o;switch(t.getType()){case"atomic":e=t.getEntityAt(0),o=Entity.get(e).getType()}return this.renderableBlocks().includes(t.getType())?this.handleBlockRenderer(t):null},DanteEditor.prototype.handleBlockRenderer=function(block){var dataBlock;return dataBlock=this.getDataBlock(block),dataBlock?{component:eval(dataBlock.block),editable:!this.state.read_only,props:{data:block.getData(),getEditorState:this.getEditorState,setEditorState:this.onChange,addLock:this.addLock,removeLock:this.removeLock,getLocks:this.getLocks,config:dataBlock.options}}:null},DanteEditor.prototype.blockStyleFn=function(t){var e,o;return e=getCurrentBlock(this.state.editorState),o=e.getKey()===t.getKey()?"is-selected":"",this.renderableBlocks().includes(t.getType())?this.styleForBlock(t,e,o):"graf graf--p "+o},DanteEditor.prototype.getDataBlock=function(t){return this.widgets.find(function(e){return function(e){return e.type===t.getType()}}(this))},DanteEditor.prototype.styleForBlock=function(t,e,o){var i,n,r;return(i=this.getDataBlock(t))?(n=i.selectedFn?i.selectedFn(t):null,r=o?i.selected_class:"",i.wrapper_class+" "+r+" "+n):null},DanteEditor.prototype.handleTooltipDisplayOn=function(t,e){return null==e&&(e=!0),setTimeout(function(o){return function(){var i;return i=o.tooltipsWithProp(t),i.map(function(t){return o.refs[t.ref].display(e),o.refs[t.ref].relocate()})}}(this),20)},DanteEditor.prototype.handlePasteText=function(t,e){return e?e?this.handleHTMLPaste(t,e):void 0:this.handleTXTPaste(t,e)},DanteEditor.prototype.handleTXTPaste=function(t,e){var o,i,n;switch(o=getCurrentBlock(this.state.editorState),i=this.state.editorState,o.getType()){case"placeholder":return n=Modifier.replaceText(i.getCurrentContent(),new SelectionState({anchorKey:o.getKey(),anchorOffset:0,focusKey:o.getKey(),focusOffset:2}),t),i=EditorState.push(i,n,"replace-text"),this.onChange(i),!0;default:return!1}},DanteEditor.prototype.handleHTMLPaste=function(t,e){var o,i,n,r,s,a,l,c,p,h,d;return p=customHTML2Content(e,this.extendedBlockRenderMap),r=getCurrentBlock(this.state.editorState),d=this.state.editorState.getSelection(),s=d.getEndKey(),n=this.state.editorState.getCurrentContent(),i=n.blockMap.toSeq().takeUntil(function(t){return function(t){return t.key===s}}(this)),o=n.blockMap.toSeq().skipUntil(function(t){return function(t){return t.key===s}}(this)).rest(),a=p.blockMap.first().getKey(),l=i.concat(p.blockMap,o).toOrderedMap(),c=n.merge({blockMap:l,selectionBefore:d,selectionAfter:d.merge({anchorKey:a,anchorOffset:0,focusKey:a,focusOffset:0,isBackward:!1})}),h=EditorState.push(this.state.editorState,c,"insert-fragment"),this.onChange(h),!0},DanteEditor.prototype.handlePasteImage=function(t){return t.map(function(t){return function(e){var o;return o={url:URL.createObjectURL(e)},t.onChange(addNewBlock(t.state.editorState,"image",o))}}(this))},DanteEditor.prototype.handleDroppedFiles=function(t,e){return e.map(function(t){return function(e){var o;return o={url:URL.createObjectURL(e)},t.onChange(addNewBlock(t.state.editorState,"image",o))}}(this))},DanteEditor.prototype.handleUpArrow=function(t){return setTimeout(function(t){return function(){return t.forceRender(t.state.editorState)}}(this),10)},DanteEditor.prototype.handleDownArrow=function(t){return setTimeout(function(t){return function(){return t.forceRender(t.state.editorState)}}(this),10)},DanteEditor.prototype.handleReturn=function(t){var e,o,i,n,r;if(this.props.handleReturn&&this.props.handleReturn())return!0;if(n=this.state.editorState,!t.altKey&&!t.metaKey&&!t.ctrlKey){if(i=getCurrentBlock(n),e=i.getType(),o=this.getDataBlock(i),0===i.getText().length){if(o&&o.handleEnterWithoutText)return o.handleEnterWithText(this,i),this.closePopOvers(),!0;switch(e){case"header-one":return this.onChange(resetBlockWithType(n,"unstyled")),!0;default:return!1}}return i.getText().length>0?!(!o||!o.handleEnterWithText||(o.handleEnterWithText(this,i),this.closePopOvers(),0)):(r=n.getSelection(),i.getLength()===r.getStartOffset()&&this.continuousBlocks.indexOf(e)<0&&(this.onChange(addNewBlockAt(n,i.getKey())),!0))}return!1},DanteEditor.prototype.handleBeforeInput=function(t){var e,o,i,n,r,s,a,l,c,p,h,d,u,f;return s=getCurrentBlock(this.state.editorState),r=s.getType(),f=this.state.editorState.getSelection(),a=this.state.editorState,0!==s.getText().length&&this.closePopOvers(),p=f.getEndOffset(),c=s.getEntityAt(p-1),l=c&&Entity.get(c).getType(),o=s.getEntityAt(p),e=o&&Entity.get(o).getType()," "===t&&"link"===l&&"link"!==e?(d=Modifier.insertText(a.getCurrentContent(),f," "),u=EditorState.push(a,d,"insert-characters"),this.onChange(u),!0):0!==r.indexOf("atomic")&&(i=s.getLength(),!(f.getAnchorOffset()>1||i>1||(h={"> ":"blockquote","*.":"unordered-list-item","* ":"unordered-list-item","- ":"unordered-list-item","1.":"ordered-list-item","# ":"header-one","##":"header-two","==":"unstyled","` ":"code-block"},n=h[s.getText()+t],console.log("BLOCK TO SHOW: "+n),!n||(this.onChange(resetBlockWithType(a,n)),0))))},DanteEditor.prototype.handleKeyCommand=function(t){var e,o,i,n,r;return i=this.state.editorState,!((!this.props.handleKeyCommand||!this.props.handleKeyCommand(t))&&("add-new-block"===t?(this.onChange(addNewBlock(i,"blockquote")),0):(e=getCurrentBlock(i),0===t.indexOf("toggle_inline:")?(n=t.split(":")[1],o=e.getType(),this.onChange(RichUtils.toggleInlineStyle(i,n)),0):0===t.indexOf("toggle_block:")?(n=t.split(":")[1],o=e.getType(),this.onChange(RichUtils.toggleBlockType(i,n)),0):(r=RichUtils.handleKeyCommand(this.state.editorState,t),!r||(this.onChange(r),0)))))},DanteEditor.prototype.findCommandKey=function(t,e){return this.key_commands[t].find(function(t){return t.key===e})},DanteEditor.prototype.KeyBindingFn=function(t){var e;if(t.altKey){if(t.shiftKey)return e=this.findCommandKey("alt-shift",t.which),e?e.cmd:getDefaultKeyBinding(t);if(t.ctrlKey||t.metaKey)return e=this.findCommandKey("alt-cmd",t.which),e?e.cmd:getDefaultKeyBinding(t)}else if(t.ctrlKey||t.metaKey)return e=this.findCommandKey("cmd",t.which),e?e.cmd:getDefaultKeyBinding(t);return getDefaultKeyBinding(t)},DanteEditor.prototype.updateBlockData=function(t,e){var o,i,n;return o=t.getData(),i=o.merge(e),n=updateDataOfBlock(this.state.editorState,t,i),this.forceRender(n)},DanteEditor.prototype.setDirection=function(t){var e,o,i;return o=this.state.editorState.getCurrentContent(),i=this.state.editorState.getSelection(),e=o.getBlockForKey(i.anchorKey),this.updateBlockData(e,{direction:t})},DanteEditor.prototype.toggleReadOnly=function(t){return t.preventDefault(),this.toggleEditable()},DanteEditor.prototype.toggleEditable=function(){return this.closePopOvers(),this.setState({read_only:!this.state.read_only},this.testEmitAndDecode)},DanteEditor.prototype.closePopOvers=function(){return this.tooltips.map(function(t){return function(e){return t.refs[e.ref].hide()}}(this))},DanteEditor.prototype.relocateTooltips=function(){return this.tooltips.map(function(t){return function(e){return t.refs[e.ref].relocate()}}(this))},DanteEditor.prototype.tooltipsWithProp=function(t){return this.tooltips.filter(function(e){return function(e){return e[t]}}(this))},DanteEditor.prototype.tooltipHasSelectionElement=function(t,e){return t.selectionElements.includes(e)},DanteEditor.prototype.handleShowPopLinkOver=function(t){return this.showPopLinkOver()},DanteEditor.prototype.handleHidePopLinkOver=function(t){return this.hidePopLinkOver()},DanteEditor.prototype.showPopLinkOver=function(t){var e,o;return o=ReactDOM.findDOMNode(this),t&&(e=this.refs.anchor_popover.relocate(t)),e&&this.refs.anchor_popover.setPosition(e),this.refs.anchor_popover.setState({show:!0,url:t?t.href:this.refs.anchor_popover.state.url}),this.isHover=!0,this.cancelHide()},DanteEditor.prototype.hidePopLinkOver=function(){return this.hideTimeout=setTimeout(function(t){return function(){return t.refs.anchor_popover.hide()}}(this),300)},DanteEditor.prototype.cancelHide=function(){return clearTimeout(this.hideTimeout)},DanteEditor.prototype.render=function(){return React.createElement("div",{id:"content",suppressContentEditableWarning:!0},React.createElement("article",{className:"postArticle"},React.createElement("div",{className:"postContent"},React.createElement("div",{className:"notesSource"},React.createElement("div",{id:"editor",className:"postField postField--body"},React.createElement("section",{className:"section--first section--last"},React.createElement("div",{className:"section-divider layoutSingleColumn"},React.createElement("hr",{className:"section-divider"})),React.createElement("div",{className:"section-content"},React.createElement("div",{ref:"richEditor",className:"section-inner layoutSingleColumn",onClick:this.focus},React.createElement(Editor,{blockRendererFn:this.blockRenderer,editorState:this.state.editorState,onChange:this.onChange,onUpArrow:this.handleUpArrow,onDownArrow:this.handleDownArrow,handleReturn:this.handleReturn,blockRenderMap:this.state.blockRenderMap,blockStyleFn:this.blockStyleFn,handlePastedText:this.handlePasteText,handlePastedFiles:this.handlePasteImage,handleDroppedFiles:this.handleDroppedFiles,handleKeyCommand:this.handleKeyCommand,keyBindingFn:this.KeyBindingFn,handleBeforeInput:this.handleBeforeInput,readOnly:this.state.read_only,placeholder:this.props.config.body_placeholder,ref:"editor"})))))))),this.tooltips.map(function(t){return function(e,o){return React.createElement(e.component,{ref:e.ref,key:o,editor:t,editorState:t.state.editorState,onChange:t.onChange,configTooltip:e,showPopLinkOver:t.showPopLinkOver,hidePopLinkOver:t.hidePopLinkOver,handleOnMouseOver:t.handleShowPopLinkOver,handleOnMouseOut:t.handleHidePopLinkOver})}}(this)),this.state.debug?React.createElement(Debug,{locks:this.state.locks,read_only:this.state.read_only,testEmitTEXT:this.testEmitTEXT,testEmitAndDecode:this.testEmitAndDecode,debug_json:this.state.debug_json,debug_text:this.state.debug_text}):void 0)},DanteEditor}(React.Component),module.exports=Dante},197:function(t,e,o){var i,n,r,s,a,l,c,p,h,d,u=function(t,e){return function(){return t.apply(e,arguments);
}},f=function(t,e){function o(){this.constructor=t}for(var i in e)g.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},g={}.hasOwnProperty;a=o(6),l=o(13),h=o(9),s=h.Entity,c=h.RichUtils,i=h.AtomicBlockUtils,n=h.EditorBlock,p=o(47),d=o(25).updateDataOfBlock,r=function(t){function e(t){this.componentDidMount=u(this.componentDidMount,this),this.dataForUpdate=u(this.dataForUpdate,this),this.updateData=u(this.updateData,this),e.__super__.constructor.call(this,t),this.state={embed_data:this.defaultData()}}return f(e,t),e.prototype.defaultData=function(){var t;return t=this.props.block.getData().toJS(),t.embed_data||{}},e.prototype.updateData=function(){var t,e,o,i,n,r;return e=this.props.blockProps,t=this.props.block,i=this.props.blockProps.getEditorState,r=this.props.blockProps.setEditorState,o=t.getData(),n=o.merge(this.state),r(d(i(),t,n))},e.prototype.dataForUpdate=function(){return this.props.blockProps.data.toJS()},e.prototype.componentDidMount=function(){if(this.props.blockProps.data&&(this.dataForUpdate().endpoint||this.dataForUpdate().provisory_text))return p({method:"get",url:""+this.dataForUpdate().endpoint+this.dataForUpdate().provisory_text+"&scheme=https"}).then(function(t){return function(e){return t.setState({embed_data:e.data},t.updateData)}}(this))["catch"](function(t){return function(t){return console.log("TODO: error")}}(this))},e.prototype.classForImage=function(){return this.state.embed_data.images?"":"mixtapeImage--empty u-ignoreBlock"},e.prototype.picture=function(){return this.state.embed_data.images?this.state.embed_data.images[0].url:""},e.prototype.render=function(){return a.createElement("span",null,a.createElement("a",{target:"_blank",className:"js-mixtapeImage mixtapeImage "+this.classForImage(),href:this.state.embed_data.url,style:{backgroundImage:"url('"+this.picture()+"')"}}),a.createElement("a",{className:"markup--anchor markup--mixtapeEmbed-anchor",target:"_blank",href:this.state.embed_data.url},a.createElement("strong",{className:"markup--strong markup--mixtapeEmbed-strong"},this.state.embed_data.title),a.createElement("em",{className:"markup--em markup--mixtapeEmbed-em"},this.state.embed_data.description)),this.state.embed_data.provider_url)},e}(a.Component),t.exports=r},198:function(t,e,o){var i,r,s,a,l,c,p,h,d,u,f,g,m=function(t,e){return function(){return t.apply(e,arguments)}},y=function(t,e){function o(){this.constructor=t}for(var i in e)k.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},k={}.hasOwnProperty;p=o(6),h=o(13),f=o(9),a=f.Entity,d=f.RichUtils,i=f.AtomicBlockUtils,r=f.EditorBlock,s=f.EditorState,u=o(47),g=o(25).updateDataOfBlock,l=function(t){function e(t){this.render=m(this.render,this),this.updateProgressBar=m(this.updateProgressBar,this),this.uploadCompleted=m(this.uploadCompleted,this),this.uploadFile=m(this.uploadFile,this),this.handleGrafFigureSelectImg=m(this.handleGrafFigureSelectImg,this),this.updateDataSelection=m(this.updateDataSelection,this),this.aspectRatio=m(this.aspectRatio,this),this.handleUpload=m(this.handleUpload,this),this.stopLoader=m(this.stopLoader,this),this.startLoader=m(this.startLoader,this),this.replaceImg=m(this.replaceImg,this),this.updateData=m(this.updateData,this),this.defaultAspectRatio=m(this.defaultAspectRatio,this),this.defaultUrl=m(this.defaultUrl,this),this.blockPropsSrc=m(this.blockPropsSrc,this);var o;e.__super__.constructor.call(this,t),o=this.props.block.getData().toJS(),this.config=this.props.blockProps.config,this.state={loading:!1,selected:!1,loading_progress:0,caption:this.defaultPlaceholder(),direction:o.direction||"center",width:0,height:0,file:null,url:this.blockPropsSrc()||this.defaultUrl(o),aspect_ratio:this.defaultAspectRatio(o)}}return y(e,t),e.prototype.blockPropsSrc=function(){return this.props.blockProps.data.src},e.prototype.defaultUrl=function(t){return t.url?t.url:t.url?t.file?URL.createObjectURL(t.file):t.url:this.props.blockProps.data.src},e.prototype.defaultPlaceholder=function(){return this.props.blockProps.config.image_caption_placeholder},e.prototype.defaultAspectRatio=function(t){return t.aspect_ratio?{width:t.aspect_ratio.width,height:t.aspect_ratio.height,ratio:t.aspect_ratio.ratio}:{width:0,height:0,ratio:100}},e.prototype.getAspectRatio=function(t,e){var o,i,n,r,s,a,l;return r=1e3,n=1e3,s=0,l=t,i=e,l>r?(s=r/l,i*=s,l*=s):i>n&&(s=n/i,l*=s,i*=s),o=i/l*100,a={width:l,height:i,ratio:o}},e.prototype.updateData=function(){var t,e,o,i,n,r;return e=this.props.blockProps,t=this.props.block,i=this.props.blockProps.getEditorState,r=this.props.blockProps.setEditorState,o=t.getData(),n=o.merge(this.state).merge({forceUpload:!1}),r(g(i(),t,n))},e.prototype.replaceImg=function(){var t;if(this.img=new Image,this.img.src=this.refs.image_tag.src,this.setState({url:this.img.src}),t=this,this.img.src.includes("blob")||this.props.block.data.get("forceUpload"))return this.img.onload=function(e){return function(){return e.setState({width:e.img.width,height:e.img.height,aspect_ratio:t.getAspectRatio(e.img.width,e.img.height)},e.handleUpload)}}(this)},e.prototype.startLoader=function(){return this.setState({loading:!0})},e.prototype.stopLoader=function(){return this.setState({loading:!1})},e.prototype.handleUpload=function(){return this.startLoader(),this.props.blockProps.addLock(),this.updateData(),this.uploadFile()},e.prototype.componentDidMount=function(){return this.replaceImg()},e.prototype.aspectRatio=function(){return{maxWidth:""+this.state.aspect_ratio.width,maxHeight:""+this.state.aspect_ratio.height,ratio:""+this.state.aspect_ratio.height}},e.prototype.updateDataSelection=function(){var t,e,o;return t=this.props.blockProps.getEditorState,o=this.props.blockProps.setEditorState,e=t().getSelection().merge({anchorKey:this.props.block.getKey(),focusKey:this.props.block.getKey()}),o(s.forceSelection(t(),e))},e.prototype.handleGrafFigureSelectImg=function(t){return t.preventDefault(),this.setState({selected:!0},this.updateDataSelection)},e.prototype.coords=function(){return{maxWidth:this.state.aspect_ratio.width+"px",maxHeight:this.state.aspect_ratio.height+"px"}},e.prototype.getBase64Image=function(t){var e,o,i;return e=document.createElement("canvas"),e.width=t.width,e.height=t.height,o=e.getContext("2d"),o.drawImage(t,0,0),i=e.toDataURL("image/png")},e.prototype.formatData=function(){var t,e;return e=new FormData,(t=this.props.blockProps.data.get("file"))?(e.append("file",this.props.blockProps.data.get("file")),e):(e.append("url",this.props.blockProps.data.get("url")),e)},e.prototype.uploadFile=function(){var t;return console.log("FORM DATA:",this.formatData()),u({method:"post",url:this.config.upload_url,data:this.formatData(),onUploadProgress:function(t){return function(e){return t.updateProgressBar(e)}}(this)}).then(function(t){return function(e){if(t.uploadCompleted(e.data),t.props.blockProps.removeLock(),t.stopLoader(),t.config.upload_callback)return t.config.upload_callback(response,t)}}(this))["catch"](function(t){return function(e){if(t.props.blockProps.removeLock(),t.stopLoader(),console.log("ERROR: got error uploading file "+e),t.config.upload_error_callback)return t.config.upload_error_callback(e,t)}}(this)),t=function(t){return function(e){return t.uploadCompleted(e,n)}}(this)},e.prototype.uploadCompleted=function(t){return this.setState({url:t.url},this.updateData)},e.prototype.updateProgressBar=function(t){var e;if(e=this.state.loading_progress,t.lengthComputable)return e=t.loaded/t.total*100,e=null!=e?e:{complete:0},this.setState({loading_progress:e}),console.log("complete: "+e)},e.prototype.render=function(){return p.createElement("div",{ref:"image_tag2",suppressContentEditableWarning:!0},p.createElement("div",{className:"aspectRatioPlaceholder is-locked",style:this.coords(),onClick:this.handleGrafFigureSelectImg},p.createElement("div",{style:{paddingBottom:this.state.aspect_ratio.ratio+"%"},className:"aspect-ratio-fill"}),p.createElement("img",{src:this.state.url,ref:"image_tag",height:this.state.aspect_ratio.height,width:this.state.aspect_ratio.width,className:"graf-image"}),p.createElement(c,{toggle:this.state.loading,progress:this.state.loading_progress})),p.createElement("figcaption",{className:"imageCaption"},p.createElement(r,Object.assign({},this.props,{editable:!0,className:"imageCaption",placeholder:"escrive alalal"}))))},e}(p.Component),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.render=function(){return p.createElement("div",null,this.props.toggle?p.createElement("div",{className:"image-upoader-loader"},p.createElement("p",null,100===this.props.progress?"processing image...":p.createElement("span",null,p.createElement("span",null,"loading"),this.props.progress))):void 0)},e}(p.Component),t.exports=l},199:function(t,e,o){var i,n,r,s,a,l,c,p,h=function(t,e){return function(){return t.apply(e,arguments)}},d=function(t,e){function o(){this.constructor=t}for(var i in e)u.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},u={}.hasOwnProperty;a=o(6),l=o(13),p=o(9),r=p.Entity,c=p.RichUtils,i=p.AtomicBlockUtils,n=p.EditorBlock,s=function(t){function e(t){this.classForDefault=h(this.classForDefault,this),this.handleFocus=h(this.handleFocus,this),this.defaultText=h(this.defaultText,this),this.placeholderFromProps=h(this.placeholderFromProps,this),this.placeholderText=h(this.placeholderText,this),e.__super__.constructor.call(this,t),this.state={enabled:!1,data:this.props.blockProps.data.toJS()}}return d(e,t),e.prototype.placeholderText=function(){return this.state.enabled?"":this.props.blockProps.data.toJS().placeholder||this.placeholderFromProps()||this.defaultText()},e.prototype.placeholderFromProps=function(){return this.props.block.toJS().placeholder},e.prototype.defaultText=function(){return"write something "},e.prototype.componentDidMount=function(){},e.prototype.handleFocus=function(t){return setTimeout(function(t){return function(){return t.setState({enabled:!0})}}(this),0)},e.prototype.classForDefault=function(){return this.state.enabled?"":"defaultValue defaultValue--root"},e.prototype.render=function(){return a.createElement("span",{className:this.classForDefault(),onMouseDown:this.handleFocus},this.placeholderText(),a.createElement(n,Object.assign({},this.props,{className:"imageCaption",placeholder:"escrive alalal"})))},e}(a.Component),t.exports=s},200:function(t,e,o){var i,n,r,s,a,l,c,p,h,d,u=function(t,e){return function(){return t.apply(e,arguments)}},f=function(t,e){function o(){this.constructor=t}for(var i in e)g.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},g={}.hasOwnProperty;s=o(6),a=o(13),h=o(9),r=h.Entity,l=h.RichUtils,i=h.AtomicBlockUtils,n=h.EditorBlock,d=o(25).updateDataOfBlock,p=o(47),c=function(t){function e(t){this.dataForUpdate=u(this.dataForUpdate,this),this.updateData=u(this.updateData,this),e.__super__.constructor.call(this,t),this.state={embed_data:this.defaultData()}}return f(e,t),e.prototype.defaultData=function(){var t;return t=this.props.block.getData().toJS(),t.embed_data||{}},e.prototype.updateData=function(){var t,e,o,i,n,r;return e=this.props.blockProps,t=this.props.block,i=this.props.blockProps.getEditorState,r=this.props.blockProps.setEditorState,o=t.getData(),n=o.merge(this.state),r(d(i(),t,n))},e.prototype.dataForUpdate=function(){return this.props.blockProps.data.toJS()},e.prototype.componentDidMount=function(){if(this.props.blockProps.data&&(this.dataForUpdate().endpoint||this.dataForUpdate().provisory_text))return p({method:"get",url:""+this.dataForUpdate().endpoint+this.dataForUpdate().provisory_text+"&scheme=https"}).then(function(t){return function(e){return t.setState({embed_data:e.data},t.updateData)}}(this))["catch"](function(t){return function(t){return console.log("TODO: error")}}(this))},e.prototype.classForImage=function(){return this.state.embed_data.thumbnail_url?"":"mixtapeImage--empty u-ignoreBlock"},e.prototype.render=function(){return s.createElement("figure",{className:"graf--figure graf--iframe graf--first",tabIndex:"0"},s.createElement("div",{className:"iframeContainer",dangerouslySetInnerHTML:{__html:this.state.embed_data.html}}),s.createElement("figcaption",{className:"imageCaption"},s.createElement(n,Object.assign({},this.props,{className:"imageCaption"}))))},e}(s.Component),t.exports=c},201:function(t,e,o){var i,n,r=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function o(){this.constructor=t}for(var i in e)a.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=o(6),i=function(t){function e(){return this.render=r(this.render,this),e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.render=function(){return n.createElement("div",null,n.createElement("hr",null),n.createElement("ul",null,n.createElement("li",null,"LOCKS: ",this.props.locks),n.createElement("li",null,n.createElement("a",{href:"#",onClick:this.props.toggleReadOnly},"READ ONLY: ",this.props.read_only?"YES":"NO")),n.createElement("li",null,n.createElement("a",{href:"#",onClick:this.props.testEmitTEXT},"get Text From Editor")),n.createElement("li",null,n.createElement("a",{href:"#",onClick:this.props.testEmitAndDecode},"serialize and set content")),n.createElement("div",{style:{"float":"left",width:"40%",marginRight:"10px"}},n.createElement("h3",null,"JSON"),n.createElement("pre",null,JSON.stringify(this.props.debug_json))),n.createElement("div",{style:{"float":"left",width:"50%"}},n.createElement("h3",null,"TEXT"),n.createElement("pre",null,this.props.debug_text))))},e}(n.Component),t.exports=i},202:function(t,e,o){var i,n,r,s=function(t,e){return function(){return t.apply(e,arguments)}},a=function(t,e){function o(){this.constructor=t}for(var i in e)l.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},l={}.hasOwnProperty;r=o(6),i=o(9).Entity,n=function(t){function e(t){this._hidePopLinkOver=s(this._hidePopLinkOver,this),this._showPopLinkOver=s(this._showPopLinkOver,this),this._checkProtocol=s(this._checkProtocol,this),this._validateLink=s(this._validateLink,this),e.__super__.constructor.call(this,t),this.isHover=!1}return a(e,t),e.prototype._validateLink=function(){var t;return t=new RegExp("^(https?://)?((([a-zd]([a-zd-]*[a-zd])*).)+[a-z]{2,}|((d{1,3}.){3}d{1,3}))(:d+)?(/[-a-zd%_.~+]*)*(?[;&a-zd%_.~+=-]*)?(#[-a-zd_]*)?$","i"),!!t.test(str)||(alert("Please enter a valid URL."),!1)},e.prototype._checkProtocol=function(){return console.log("xcvd")},e.prototype._showPopLinkOver=function(t){return this.data.showPopLinkOver(this.refs.link)},e.prototype._hidePopLinkOver=function(t){return this.data.hidePopLinkOver()},e.prototype.render=function(){return this.data=i.get(this.props.entityKey).getData(),console.log(this.props),console.log("ENTITY",this.data),r.createElement("a",{ref:"link",href:this.data.url,className:"markup--anchor",onMouseOver:this._showPopLinkOver,onMouseOut:this._hidePopLinkOver},this.props.children)},e}(r.Component),t.exports=n},203:function(t,e,o){var i,n,r,s,a,l,c,p,h,d,u,f,g,m,y,k,_,b,v=function(t,e){return function(){return t.apply(e,arguments)}},S=function(t,e){function o(){this.constructor=t}for(var i in e)E.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},E={}.hasOwnProperty;l=o(6),c=o(13),m=o(9),s=m.Entity,p=m.RichUtils,i=m.AtomicBlockUtils,r=m.EditorState,y=o(25),h=y.addNewBlock,_=y.resetBlockWithType,b=y.updateDataOfBlock,d=y.getCurrentBlock,u=y.getNode,k=o(48),g=k.getSelectionRect,f=k.getSelection,n=function(t){function e(t){this.relocate=v(this.relocate,this),this.clickHandler=v(this.clickHandler,this),this.widgets=v(this.widgets,this),this.handleFileInput=v(this.handleFileInput,this),this.insertImage=v(this.insertImage,this),this.handlePlaceholder=v(this.handlePlaceholder,this),this.clickOnFileUpload=v(this.clickOnFileUpload,this),this.componentWillReceiveProps=v(this.componentWillReceiveProps,this),this.collapse=v(this.collapse,this),this.scale=v(this.scale,this),this._toggleScaled=v(this._toggleScaled,this),this.hide=v(this.hide,this),this.show=v(this.show,this),this.display=v(this.display,this),e.__super__.constructor.call(this,t),this.state={position:{top:0,left:0},show:!1,scaled:!1}}return S(e,t),e.prototype.display=function(t){return t?this.show():this.hide()},e.prototype.show=function(){return this.setState({show:!0})},e.prototype.hide=function(){return this.setState({show:!1})},e.prototype.setPosition=function(t){return this.setState({position:t})},e.prototype._toggleScaled=function(t){return this.state.scaled?this.collapse():this.scale()},e.prototype.scale=function(){return this.setState({scaled:!0})},e.prototype.collapse=function(){return this.setState({scaled:!1})},e.prototype.componentWillReceiveProps=function(t){return this.collapse()},e.prototype.activeClass=function(){return this.isActive()?"is-active":""},e.prototype.isActive=function(){return this.state.show},e.prototype.scaledClass=function(){return this.state.scaled?"is-scaled":""},e.prototype.scaledWidth=function(){return this.state.scaled?"124":"0"},e.prototype.clickOnFileUpload=function(){return this.refs.fileInput.click(),this.collapse(),this.hide()},e.prototype.handlePlaceholder=function(t){var e;return e={type:t.widget_options.insert_block,placeholder:t.options.placeholder,endpoint:t.options.endpoint},this.props.onChange(_(this.props.editorState,"placeholder",e))},e.prototype.insertImage=function(t){var e;return e={url:URL.createObjectURL(t),file:t},this.props.onChange(h(this.props.editorState,"image",e))},e.prototype.handleFileInput=function(t){var e,o;return o=t.target.files,e=o[0],this.insertImage(e)},e.prototype.widgets=function(){return this.props.editor.widgets},e.prototype.clickHandler=function(t,e){var o;switch(o=this.widgets().find(function(t){return t.icon===e}),o.widget_options.insertion){case"upload":return this.clickOnFileUpload(t,o);case"placeholder":return this.handlePlaceholder(o);default:return console.log("WRONG TYPE FOR "+o.widget_options.insertion)}},e.prototype.getItems=function(){return this.widgets().filter(function(t){return function(t){return t.widget_options.displayOnInlineTooltip}}(this))},e.prototype.relocate=function(){var t,e,o,i,n,r,s,a,l,p,h,m;if(r=this.props.editorState,r.getSelection().isCollapsed()){if(n=d(r),e=n.getType(),o=r.getCurrentContent(),m=r.getSelection(),t=o.getBlockForKey(m.anchorKey),s=f(window),!s.rangeCount)return;return a=u(),h=g(s),i=h,l=c.findDOMNode(this.props.editor),p=l.getBoundingClientRect(),this.display(0===t.getText().length&&"unstyled"===e),this.setPosition({top:i.top+window.scrollY,left:i.left+window.scrollX-60})}return this.hide()},e.prototype.render=function(){return l.createElement("div",{className:"inlineTooltip "+this.activeClass()+" "+this.scaledClass(),style:this.state.position},l.createElement("button",{className:"inlineTooltip-button control",title:"Close Menu","data-action":"inline-menu",onClick:this._toggleScaled},l.createElement("span",{className:"tooltip-icon dante-icon-plus"})),l.createElement("div",{className:"inlineTooltip-menu",style:{width:this.scaledWidth()+"px"}},this.getItems().map(function(t){return function(e,o){return l.createElement(a,{item:e,key:o,clickHandler:t.clickHandler})}}(this)),l.createElement("input",{type:"file",style:{display:"none"},ref:"fileInput",multiple:"multiple",onChange:this.handleFileInput})))},e}(l.Component),a=function(t){function e(){return this.clickHandler=v(this.clickHandler,this),e.__super__.constructor.apply(this,arguments)}return S(e,t),e.prototype.clickHandler=function(t){return t.preventDefault(),this.props.clickHandler(t,this.props.item.icon)},e.prototype.render=function(){return l.createElement("button",{className:"inlineTooltip-button scale",title:this.props.title,onMouseDown:this.clickHandler},l.createElement("span",{className:"tooltip-icon dante-icon-"+this.props.item.icon}))},e}(l.Component),t.exports=n},204:function(t,e,o){var i,n,r,s,a,l,c,p,h,d,u,f,g,m,y,k=function(t,e){return function(){return t.apply(e,arguments)}},_=function(t,e){function o(){this.constructor=t}for(var i in e)b.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},b={}.hasOwnProperty;l=o(6),c=o(13),g=o(9),a=g.Entity,p=g.RichUtils,i=g.AtomicBlockUtils,s=g.EditorState,m=o(48),f=m.getSelectionRect,u=m.getSelection,y=o(25),h=y.getCurrentBlock,d=y.getNode,n=function(t){function e(t){this.handleClick=k(this.handleClick,this),this.componentWillReceiveProps=k(this.componentWillReceiveProps,this),this.relocate=k(this.relocate,this),this.collapse=k(this.collapse,this),this.scale=k(this.scale,this),this._toggleScaled=k(this._toggleScaled,this),this.hide=k(this.hide,this),this.show=k(this.show,this),this.display=k(this.display,this),e.__super__.constructor.call(this,t),this.state={position:{top:0,left:0},show:!1,scaled:!1,buttons:[{type:"left"},{type:"center"},{type:"fill"},{type:"wide"}]}}return _(e,t),e.prototype.display=function(t){return t?this.show():this.hide()},e.prototype.show=function(){return this.setState({show:!0})},e.prototype.hide=function(){return this.setState({show:!1})},e.prototype.setPosition=function(t){return this.setState({position:t})},e.prototype._toggleScaled=function(t){return this.state.scaled?this.collapse():this.scale()},e.prototype.scale=function(){return this.setState({scaled:!0})},e.prototype.collapse=function(){return this.setState({scaled:!1})},e.prototype.relocate=function(){var t,e,o,i,n,r,s,a,l,p,g,m,y,k;return r=this.props.editorState,r.getSelection().isCollapsed()?(n=h(r),e=n.getType(),o=r.getCurrentContent(),k=r.getSelection(),t=o.getBlockForKey(k.anchorKey),a=u(window),a.rangeCount?(l=d(),y=f(a),i=y,g=c.findDOMNode(this.props.editor),m=g.getBoundingClientRect(),this.display("image"===e),"image"===e?(y=l.anchorNode.parentNode.parentNode.parentNode.getBoundingClientRect(),s=this.refs.image_popover,p=s.offsetWidth/2,this.setPosition({top:y.top-m.top+60,left:y.left+y.width/2-p})):void 0):void 0):this.hide()},e.prototype.componentWillReceiveProps=function(t){return this.collapse()},e.prototype.getStyle=function(){if(!this.state.position)return{}},e.prototype.handleClick=function(t){return this.props.editor.setDirection(t.type)},e.prototype.render=function(){return l.createElement("div",{ref:"image_popover",className:"dante-popover popover--Aligntooltip popover--top popover--animated "+(this.state.show?"is-active":void 0),style:{top:this.state.position.top,left:this.state.position.left}},l.createElement("div",{className:"popover-inner"},l.createElement("ul",{className:"dante-menu-buttons"},this.state.buttons.map(function(t){return function(e,o){return l.createElement(r,{item:e,handleClick:t.handleClick,key:o})}}(this)))),l.createElement("div",{className:"popover-arrow"}))},e}(l.Component),r=function(t){function e(){return this.render=k(this.render,this),this.handleClick=k(this.handleClick,this),e.__super__.constructor.apply(this,arguments)}return _(e,t),e.prototype.handleClick=function(t){return t.preventDefault(),this.props.handleClick(this.props.item)},e.prototype.render=function(){return l.createElement("li",{className:"dante-menu-button align-"+this.props.item.type,onMouseDown:this.handleClick},l.createElement("span",{className:"tooltip-icon dante-icon-image-"+this.props.item.type}))},e}(l.Component),t.exports=n},205:function(t,e,o){var i,n,r,s,a=function(t,e){return function(){return t.apply(e,arguments)}},l=function(t,e){function o(){this.constructor=t}for(var i in e)c.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},c={}.hasOwnProperty;n=o(6),r=o(13),s=o(25).getCurrentBlock,i=function(t){function e(t){this.render=a(this.render,this),this.relocate=a(this.relocate,this),this.hide=a(this.hide,this),this.show=a(this.show,this),this.display=a(this.display,this),e.__super__.constructor.call(this,t),this.state={position:{top:0,left:0},show:!1,url:""}}return l(e,t),e.prototype.display=function(t){return t?this.show():this.hide()},e.prototype.show=function(){return this.setState({show:!0})},e.prototype.hide=function(){return this.setState({show:!1})},e.prototype.setPosition=function(t){return this.setState({position:t})},e.prototype.relocate=function(t){var e,o,i,n,a,l,c,p,h,d,u;if(null==t&&(t=null),t)return a=this.props.editorState,n=s(a),e=n.getType(),o=a.getCurrentContent(),u=a.getSelection(),d=t.getBoundingClientRect(),i=d,l=this.refs.dante_popover,c=l.offsetWidth/2,p=r.findDOMNode(this.props.editor),h=p.getBoundingClientRect(),{top:d.top-h.top+160,left:d.left-d.width}},e.prototype.render=function(){var t,e;return t=this.state.position,e={left:t.left,top:t.top,display:""+(this.state.show?"block":"none")},n.createElement("div",{ref:"dante_popover",className:"dante-popover popover--tooltip popover--Linktooltip popover--bottom is-active",style:e,onMouseOver:this.props.handleOnMouseOver,onMouseOut:this.props.handleOnMouseOut},n.createElement("div",{className:"popover-inner"},n.createElement("a",{href:this.props.url,target:"_blank"},this.state.url)),n.createElement("div",{className:"popover-arrow"}))},e}(n.Component),t.exports=i},206:function(t,e,o){var i,n,r,s,a,l,c,p,h,d,u,f,g,m,y,k,_,b,v,S,E,C=function(t,e){return function(){return t.apply(e,arguments)}},w=function(t,e){function o(){this.constructor=t}for(var i in e)D.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},D={}.hasOwnProperty;d=o(6),u=o(13),S=o(9),g=S.convertToRaw,i=S.CompositeDecorator,v=S.getVisibleSelectionRect,y=S.getDefaultKeyBinding,_=S.getSelectionOffsetKeyForNode,h=S.KeyBindingUtil,n=S.ContentState,l=S.Editor,c=S.EditorState,p=S.Entity,f=S.RichUtils,E=o(48),b=E.getSelectionRect,k=E.getSelection,m=o(25).getCurrentBlock,r=function(t){function e(t){this.blockItems=C(this.blockItems,this),this.inlineItems=C(this.inlineItems,this),this.confirmLink=C(this.confirmLink,this),this.handleInputEnter=C(this.handleInputEnter,this),this._disableLinkMode=C(this._disableLinkMode,this),this._enableLinkMode=C(this._enableLinkMode,this),this.displayActiveMenu=C(this.displayActiveMenu,this),this.displayLinkMode=C(this.displayLinkMode,this),this._clickBlockHandler=C(this._clickBlockHandler,this),this.relocate=C(this.relocate,this),this.hide=C(this.hide,this),this.show=C(this.show,this),this.display=C(this.display,this),this._clickInlineHandler=C(this._clickInlineHandler,this),e.__super__.constructor.call(this,t),this.getVisibleSelectionRect=v,this.state={link_mode:!1,show:!1,position:{}}}return w(e,t),e.prototype._clickInlineHandler=function(t,e){return t.preventDefault(),this.props.onChange(f.toggleInlineStyle(this.props.editorState,e)),setTimeout(function(t){return function(){return t.relocate()}}(this),0)},e.prototype.display=function(t){return t?this.show():this.hide()},e.prototype.show=function(){return this.setState({show:!0})},e.prototype.hide=function(){return this.setState({show:!1})},e.prototype.setPosition=function(t){return this.setState({position:t})},e.prototype.relocate=function(){var t,e,o,i,n,r,s,a,l,c;return e=m(this.props.editorState),t=e.getType(),this.props.configTooltip.selectionElements.indexOf(t)<0?void this.hide():!this.state.link_mode&&this.state.show&&(o=this.refs.dante_menu,r=o.offsetWidth/2,n=k(window),n.rangeCount&&(l=b(n),s=u.findDOMNode(this.props.editor),a=s.getBoundingClientRect(),c=l.top-a.top- -90-5,i=l.left+l.width/2-r,c&&i))?this.setState({show:!0,position:{left:i,top:c}}):void 0},e.prototype._clickBlockHandler=function(t,e){return t.preventDefault(),this.props.onChange(f.toggleBlockType(this.props.editorState,e)),setTimeout(function(t){return function(){return t.relocate()}}(this),0)},e.prototype.displayLinkMode=function(){return this.state.link_mode?"dante-menu--linkmode":""},e.prototype.displayActiveMenu=function(){return this.state.show?"dante-menu--active":""},e.prototype._enableLinkMode=function(t){return t.preventDefault(),this.setState({link_mode:!0})},e.prototype._disableLinkMode=function(t){return t.preventDefault(),this.setState({link_mode:!1,url:""})},e.prototype.hideMenu=function(){return this.hide()},e.prototype.handleInputEnter=function(t){if(13===t.which)return this.confirmLink(t)},e.prototype.confirmLink=function(t){var e,o,i,n,r,s;return t.preventDefault(),o=this.props.editorState,s=t.currentTarget.value,e=o.getCurrentContent(),r=o.getSelection(),n={url:s,showPopLinkOver:this.props.showPopLinkOver,hidePopLinkOver:this.props.hidePopLinkOver},i=p.create("link","MUTABLE",n),r.isCollapsed()?void console.log("COLLAPSED SKIPPN LINK"):(this.props.onChange(f.toggleLink(o,r,i)),this._disableLinkMode(t))},e.prototype.getPosition=function(){var t;return t=this.state.position},e.prototype.inlineItems=function(){return this.props.editor.block_types.filter(function(t){return function(t){return"inline"===t.type}}(this))},e.prototype.blockItems=function(){return this.props.editor.block_types.filter(function(t){return function(t){return"block"===t.type}}(this))},e.prototype.render=function(){return d.createElement("div",{id:"dante-menu",ref:"dante_menu",className:"dante-menu "+this.displayActiveMenu()+" "+this.displayLinkMode(),style:this.getPosition()},d.createElement("div",{className:"dante-menu-linkinput"},d.createElement("input",{className:"dante-menu-input",placeholder:"Paste or type a link",onKeyPress:this.handleInputEnter}),d.createElement("div",{className:"dante-menu-button",onMouseDown:this._disableLinkMode},"x")),d.createElement("ul",{className:"dante-menu-buttons"},this.blockItems().map(function(t){return function(e,o){return d.createElement(s,{key:o,item:e,handleClick:t._clickBlockHandler,editorState:t.props.editorState,type:"block",currentStyle:t.props.editorState.getCurrentInlineStyle})}}(this)),d.createElement(a,{editorState:this.props.editorState,enableLinkMode:this._enableLinkMode}),this.inlineItems().map(function(t){return function(e,o){return d.createElement(s,{key:o,item:e,type:"inline",editorState:t.props.editorState,handleClick:t._clickInlineHandler})}}(this))))},e}(d.Component),s=function(t){function e(){return this.render=C(this.render,this),this.activeClassBlock=C(this.activeClassBlock,this),this.activeClassInline=C(this.activeClassInline,this),this.isActive=C(this.isActive,this),this.activeClass=C(this.activeClass,this),this.handleClick=C(this.handleClick,this),e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.handleClick=function(t){return this.props.handleClick(t,this.props.item.style)},e.prototype.activeClass=function(){return this.isActive()?"active":""},e.prototype.isActive=function(){return"block"===this.props.type?this.activeClassBlock():this.activeClassInline()},e.prototype.activeClassInline=function(){if(this.props.editorState)return this.props.editorState.getCurrentInlineStyle().has(this.props.item.style)},e.prototype.activeClassBlock=function(){var t,e;if(this.props.editorState)return e=this.props.editorState.getSelection(),t=this.props.editorState.getCurrentContent().getBlockForKey(e.getStartKey()).getType(),this.props.item.style===t},e.prototype.render=function(){return d.createElement("li",{className:"dante-menu-button "+this.activeClass(),onMouseDown:this.handleClick},d.createElement("i",{className:"dante-icon dante-icon-"+this.props.item.label,"data-action":"bold"}))},e}(d.Component),a=function(t){function e(){return this.promptForLink=C(this.promptForLink,this),e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.promptForLink=function(t){var e;if(e=this.props.editorState.getSelection(),!e.isCollapsed())return this.props.enableLinkMode(t)},e.prototype.render=function(){return d.createElement("li",{className:"dante-menu-button",onMouseDown:this.promptForLink},d.createElement("i",{className:"dante-icon icon-createlink","data-action":"createlink"
},"link"))},e}(d.Component),t.exports=r},291:function(t,e){},313:function(t,e,o){t.exports=o.p+"fonts/dante.svg"},314:function(t,e,o){t.exports=o.p+"fonts/dante.ttf"},315:function(t,e,o){t.exports=o.p+"fonts/dante.woff"},316:function(t,e,o){t.exports=o.p+"fonts/fontello.svg"},317:function(t,e,o){t.exports=o.p+"fonts/fontello.ttf"},318:function(t,e,o){t.exports=o.p+"fonts/fontello.woff"}});
//# sourceMappingURL=dante.js.map