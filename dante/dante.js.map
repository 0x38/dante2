{"version":3,"sources":["app/components/App.cjsx","app/components/blocks/embed.cjsx","app/components/blocks/image.cjsx","app/components/blocks/placeholder.cjsx","app/components/blocks/video.cjsx","app/components/link.cjsx","app/components/popovers/addButton.cjsx","app/components/popovers/image.cjsx","app/components/popovers/link.cjsx","app/components/popovers/toolTip.cjsx","app/data/poc.js","app/initialize.cjsx","app/model/content.js.es6","app/model/index.js.es6","app/utils/constants.js.es6","app/utils/convert_html.js.es6","app/utils/convert_html2.coffee","app/utils/find_entities.coffee","app/utils/save_content.coffee","app/utils/selection.js.es6"],"names":["decorator","strategy","component","createEditorState","content","decorators","createEmpty","dec","createWithContent","getDefaultBlockData","blockType","initialData","getCurrentBlock","editorState","selectionState","getSelection","contentState","getCurrentContent","block","getBlockForKey","getStartKey","addNewBlock","newType","isCollapsed","key","blockMap","getBlockMap","currentBlock","getLength","getType","newBlock","merge","type","data","newContentState","set","selectionAfter","push","resetBlockWithType","get","newText","console","log","text","getText","substr","anchorOffset","focusOffset","updateDataOfBlock","newData","getKey","updateTextOfBlock","addNewBlockAt","pivotBlockKey","newBlockType","blocksBefore","toSeq","takeUntil","v","blocksAfter","skipUntil","rest","newBlockKey","characterList","getCharacterList","slice","depth","newBlockMap","concat","toOrderedMap","selection","newContent","selectionBefore","anchorKey","focusKey","isBackward","Block","UNSTYLED","OL","UL","H1","H2","H3","H4","H5","H6","CODE","BLOCKQUOTE","PULLQUOTE","ATOMIC","BLOCKQUOTE_CAPTION","CAPTION","TODO","IMAGE","BREAK","Inline","BOLD","ITALIC","STRIKETHROUGH","UNDERLINE","HIGHLIGHT","Entity","LINK","toHTML","blockToHTML","entityRanges","length","entityKey","entity","entityType","getData","start","end","entityToHTML","originalText","href","src","module","exports","getSelectionRect","selected","_rect","getRangeAt","getBoundingClientRect","rect","top","getClientRects","anchorNode","isEmptyline","root","t","document","createRange","getSelectedBlockNode","rangeCount","node","startContainer","getAttribute","parentNode"],"mappings":"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;EAFI;;;;GAPqB,KAAK,CAAC;;AAiBrC,MAAM,CAAC,OAAP,GAAiB;;;CC7SjB;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA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","file":"dante/dante.js","sourcesContent":["\nReact = require('react')\nReactDOM = require('react-dom')\nImmutable = require('immutable')\n{ Map } = require('immutable')\n{\n  convertToRaw\n  convertFromRaw\n  CompositeDecorator\n  getVisibleSelectionRect\n  getDefaultKeyBinding\n  getSelectionOffsetKeyForNode\n  KeyBindingUtil\n  ContentState\n  Editor\n  EditorState\n  Entity\n  RichUtils\n  DefaultDraftBlockRenderMap\n  SelectionState\n  Modifier\n  BlockMapBuilder\n  getSafeBodyFromHTML\n} = require('draft-js')\n\nDraftPasteProcessor = require('draft-js/lib/DraftPasteProcessor')\n\n{stateToHTML} = require('draft-js-export-html')\n{\n  convertToHTML\n  convertFromHTML\n} = require('draft-convert')\n\ntoHTML = require(\"../utils/convert_html.js.es6\")\n\nisSoftNewlineEvent = require('draft-js/lib/isSoftNewlineEvent')\n\n{ \n  addNewBlock\n  resetBlockWithType\n  updateDataOfBlock\n  updateTextOfBlock\n  getCurrentBlock\n  addNewBlockAt\n} = require('../model/index.js.es6')\n\ncreateEditorState = require('../model/content.js.es6')\n{ updateDataOfBlock } = require('../model/index.js.es6')\n\nDanteImagePopover = require('./popovers/image')\nDanteAnchorPopover = require('./popovers/link')\n\nKeyCodes = \n  BACKSPACE: 8\n  TAB: 9\n  ENTER: 13\n  SPACEBAR: 32\n  LEFTARROW: 37\n  UPARROW: 38\n  RIGHTARROW: 39\n  DOWNARROW: 40\n\n# window.utils = require('../utils/utils.coffee')\n{ \n  getSelectionRect\n  getSelection\n} = require(\"../utils/selection.js.es6\")\nDanteInlineTooltip = require('./popovers/addButton.cjsx')\nDanteTooltip = require('./popovers/toolTip.cjsx')\nLink = require('./link.cjsx')\nfindEntities = require('../utils/find_entities.coffee')\nImageBlock = require('./blocks/image.cjsx')\nEmbedBlock = require('./blocks/embed.cjsx')\nVideoBlock = require('./blocks/video.cjsx')\nPlaceholderBlock = require('./blocks/placeholder.cjsx')\n\nSaveBehavior = require('../utils/save_content.coffee')\ncustomHTML2Content = require('../utils/convert_html2.coffee')\n\nPocData = require('../data/poc.js')\n\nclass Dante \n  constructor: (options={})->\n    console.log \"init editor!\"\n    @options = options\n    @options.el = options.el || 'app'\n\n    @options.content = options.content\n\n    @options.read_only = options.read_only || false\n    @options.spellcheck = options.spellcheck || false\n    @options.title_placeholder = options.title_placeholder || \"Title\"\n    @options.body_placeholder = options.body_placeholder || \"Write your story\"\n\n    @options.api_key = options.api_key || \"86c28a410a104c8bb58848733c82f840\"\n\n    @options.widgets = [\n      {\n        title: 'add a image'\n        insertion: \"upload\"\n        insert_block: \"image\"\n        icon: 'image'\n        type: 'image'\n        block: 'ImageBlock'\n        renderable: true\n        breakOnContinuous: true\n        wrapper_class: \"graf graf--figure\"\n        selected_class:\" is-selected is-mediaFocused\"\n        selectedFn: (block)=>\n          direction = block.getData().toJS().direction\n          switch direction\n            when \"left\" then \"graf--layoutOutsetLeft\"\n            when \"center\" then \"\"\n            when \"wide\" then \"sectionLayout--fullWidth\"\n            when \"fill\" then \"graf--layoutFillWidth\"\n            else\n        handleEnterWithoutText: (ctx, block)->\n          editorState = ctx.state.editorState\n          ctx.onChange(addNewBlockAt(editorState, block.getKey()))\n        handleEnterWithText: (ctx, block)->\n          editorState = ctx.state.editorState\n          ctx.onChange(addNewBlockAt(editorState, block.getKey()))\n      \n        displayOnInlineTooltip: true\n        options:\n          upload_url: options.upload_url or 'uploads.json'\n          upload_callback: @options.image_upload_callabck\n          image_delete_callback: @options.image_delete_callback\n          image_caption_placeholder: options.image_caption_placeholder\n      }\n      {\n        icon: 'embed'\n        title: 'insert embed'\n        insertion: \"placeholder\"\n        insert_block: \"embed\"\n        type: 'embed'\n        block: 'EmbedBlock'\n        renderable: true\n        breakOnContinuous: true\n        wrapper_class: \"graf graf--mixtapeEmbed\"\n        displayOnInlineTooltip: true\n        selected_class:\" is-selected is-mediaFocused\"\n        options:\n          endpoint: \"http://api.embed.ly/1/extract?key=#{@options.api_key}&url=\"\n          placeholder: 'Paste a link to embed content from another site (e.g. Twitter) and press Enter'\n        handleEnterWithoutText: (ctx, block)->\n          editorState = ctx.state.editorState\n          ctx.onChange(addNewBlockAt(editorState, block.getKey()))\n        handleEnterWithText: (ctx, block)->\n          editorState = ctx.state.editorState\n          ctx.onChange(addNewBlockAt(editorState, block.getKey()))\n      }\n      {\n        icon: 'video'\n        title: 'insert video'\n        insertion: \"placeholder\"\n        insert_block: \"video\"\n        type: 'video'\n        block: 'VideoBlock'\n        renderable: true\n        breakOnContinuous: true\n        wrapper_class: \"graf--figure graf--iframe\" \n        selected_class:\" is-selected is-mediaFocused\"\n        displayOnInlineTooltip: true\n        options:\n          endpoint: \"http://api.embed.ly/1/oembed?key=#{@options.api_key}&url=\"\n          placeholder: 'Paste a YouTube, Vine, Vimeo, or other video link, and press Enter'\n          caption: 'Type caption for embed (optional)'\n\n        handleEnterWithoutText: (ctx, block)->\n          editorState = ctx.state.editorState\n          ctx.onChange(addNewBlockAt(editorState, block.getKey()))\n\n        handleEnterWithText: (ctx, block)->\n          editorState = ctx.state.editorState\n          ctx.onChange(addNewBlockAt(editorState, block.getKey()))\n      }\n      {\n        renderable: true\n        block: 'PlaceholderBlock'\n        type: 'placeholder'\n        wrapper_class: \"is-embedable\"\n        selected_class:\" is-selected is-mediaFocused\"\n        displayOnInlineTooltip: false\n        handleEnterWithText: (ctx, block)->\n          editorState = ctx.state.editorState\n          data =\n            provisory_text: block.getText()\n            endpoint: block.getData().get('endpoint')\n            type: block.getData().get('type')\n\n          ctx.onChange(resetBlockWithType(\n            editorState, \n            data.type, \n            data)\n          )   \n      }\n    ]\n\n    @options.xhr = {\n      before_handler: options.before_xhr_handler\n      success_handler: options.success_xhr_handler\n      error_handler: options.success_xhr_handler\n    }\n\n    @options.data_storage = {\n      url: options.store_url || null\n      method: options.store_method || \"POST\"\n      success_handler: options.store_success_handler || null\n      failure_handler: options.store_failure_handler || null\n      interval: options.store_interval || 1500\n    }\n\n    @options.continuousBlocks = [\n      \"unstyled\"\n      \"blockquote\"\n      \"ordered-list\"\n      \"unordered-list\"\n      \"unordered-list-item\"\n      \"ordered-list-item\"\n      \"code-block\"\n    ]\n\n    @options.tooltipables = [\n      \"unstyled\"\n      \"blockquote\"\n      \"ordered-list\"\n      \"unordered-list\"\n      \"unordered-list-item\"\n      \"ordered-list-item\"\n      \"code-block\"\n      'header-one'\n      'header-two'\n      'header-three'        \n    ]\n\n    @options.block_types = [\n      # {label: 'p', style: 'unstyled'},\n      {label: 'h3', style: 'header-one', type: \"block\"},\n      {label: 'h4', style: 'header-two', type: \"block\"},\n      {label: 'blockquote', style: 'blockquote', type: \"block\"},\n      {label: 'insertunorderedlist', style: 'unordered-list-item', type: \"block\"},\n      {label: 'insertorderedlist', style: 'ordered-list-item', type: \"block\"},\n      {label: 'code', style: 'code-block', type: \"block\"}\n      {label: 'bold', style: 'BOLD', type: \"inline\"},\n      {label: 'italic', style: 'ITALIC', type: \"inline\"},\n      # {label: 'underline', style: 'UNDERLINE', type: \"inline\"},\n      # {label: 'monospace', style: 'CODE', type: \"inline\"},\n      # {label: 'strikethrough', style: 'STRIKETHROUGH', type: \"inline\"}\n    ]\n\n  getContent: ->\n    console.log @options.content\n    console.log \"IS POC DATA?\", @options.content is PocData\n\n    console.log @options.content , PocData\n\n    PocData\n    #@options.content\n\n  render: ->\n    ReactDOM.render(<DanteEditor content={@getContent()} \n      config={@options}/>, document.getElementById(@options.el))\n\nclass DanteEditor extends React.Component\n  constructor: (props) ->\n    super props\n    window.main_editor = @\n\n    @decorator = new CompositeDecorator([\n      {\n        strategy: findEntities.bind(null, 'link'),\n        component: Link\n      }\n    ])\n\n    @.blockRenderMap = Map({\n        \"image\":\n          element: 'figure'\n        \"video\":\n          element: 'figure'\n        \"embed\":\n          element: 'div'\n        'unstyled':\n          wrapper: null\n          element: 'div'\n        'paragraph': \n          wrapper: null\n          element: 'div'\n        'placeholder':\n          wrapper: null\n          element: 'div'\n    }) \n    #.merge(DefaultDraftBlockRenderMap);\n\n    @extendedBlockRenderMap = DefaultDraftBlockRenderMap.merge(@blockRenderMap);\n\n    @state = \n      editorState: @initializeState() #EditorState.createEmpty(@decorator)\n      #display_toolbar: false\n      read_only: @props.read_only\n      showURLInput: false\n      blockRenderMap: @extendedBlockRenderMap #@blockRenderMap\n      locks: 0\n\n      widgets: props.config.widgets\n\n      tooltips: [\n        {\n          type: 'image',\n          display: false\n          component: DanteImagePopover\n        }\n      ]\n\n      inlineTooltip:\n        show: true\n\n      display_tooltip: false      \n      position:  \n        top: 0\n        left: 0\n\n\n    @continuousBlocks = @props.config.continuousBlocks\n\n    @tooltipables =  @props.config.tooltipables\n\n    @block_types = @props.config.block_types\n\n    @save = new SaveBehavior\n      getLocks: @getLocks\n      config: \n        xhr: @props.config.xhr\n        data_storage: @props.config.data_storage\n      editorState: @state.editorState\n      editorContent: @emitSerializedOutput()\n\n    optionsForDecorator: ()->\n      @state\n\n  initializeState: ()=>\n    if @.props.content #and @.props.content.trim() isnt \"\"\n      #processedHTML = DraftPasteProcessor.processHTML(@.props.content)\n      #contentState = ContentState.createFromBlockArray(processedHTML)\n      # move focus to the end. \n      #editorState = EditorState.createWithContent(contentState)\n      #editorState = EditorState.moveFocusToEnd(editorState)\n      \n      ###\n      #TODO: support entities\n      html = convertFromHTML(\n        htmlToEntity: (nodeName, node) =>\n          if nodeName is 'avv'\n            return Entity.create(\n              'LINK',\n              'MUTABLE',\n              {url: node.href}\n            )\n      )(@.props.content)\n      ###\n\n\n      #editorState = EditorState.createWithContent(html, @decorator)\n\n      @decodeEditorContent(@props.content)\n            \n      #createEditorState.default(@props.content, @decorator)\n    else \n      EditorState.createEmpty(@decorator)\n\n  refreshSelection: (newEditorState)=>\n    editorState     = @.state.editorState\n    # Setting cursor position after inserting to content\n    s = @.state.editorState.getSelection()\n    c = editorState.getCurrentContent()\n\n    selectionState = SelectionState.createEmpty(s.getAnchorKey())\n    focusOffset = s.getFocusOffset()\n    anchorKey = s.getAnchorKey()\n    console.log anchorKey, focusOffset\n    selectionState = selectionState.merge({\n      anchorOffset: focusOffset,\n      focusKey: anchorKey,\n      focusOffset: focusOffset,\n    })\n\n    newState = EditorState.forceSelection(newEditorState, selectionState)\n    \n    @onChange(newState)\n  \n  forceRender: (editorState)=>\n    selection       = @.state.editorState.getSelection()\n    content         = editorState.getCurrentContent()\n    newEditorState  = EditorState.createWithContent(content, @decorator)\n\n    @refreshSelection(newEditorState)\n  \n  onChange: (editorState) =>\n    @setPreContent()\n    \n    # console.log \"BB\", editorState.toJS()\n    @.setState({editorState})\n    #console.log \"changed at\", editorState.getSelection().getAnchorKey()\n    #console.log \"collapsed?\", editorState.getSelection().isCollapsed()\n\n    currentBlock = getCurrentBlock(@state.editorState);\n    blockType = currentBlock.getType()\n\n    if (!editorState.getSelection().isCollapsed())\n      return if @.tooltipables.indexOf(blockType) < 0\n      @handleOnChange()\n    else\n      @refs.insert_tooltip.hide()\n\n    setTimeout ()=>\n      @getPositionForCurrent()\n    , 0\n    \n    # @setState({ editorState });\n    @dispatchChangesToSave()    \n  \n    console.log \"CHANGES!\"\n\n  dispatchChangesToSave: =>\n    clearTimeout @saveTimeout\n    @saveTimeout = setTimeout =>\n      @save.store(@emitSerializedOutput())\n    , 100\n\n  setPreContent: =>\n    content = @emitSerializedOutput()\n    # console.log \"SET PRE CONTENT\", content\n    @save.editorContent = content\n\n  emitHTML: (editorState)=>\n\n    options =\n      blockRenderers:\n        #TODO: ver como funciona con los blocks\n        ATOMIC: (block) =>\n          data = block.getData();\n          if data.foo is 'bar'\n            return '<div>' + escape(block.getText()) + '</div>'\n        image: (block) =>\n          debugger\n          return \"<div>aca va tu foto oe</div>\"\n\n    #.state.editorState.getCurrentContent()\n    #raw = convertToRaw( @state.editorState.getCurrentContent() )\n    #html = stateToHTML(this.state.editorState.getCurrentContent(), options)\n    #html = stateToHTML(@state.editorState);\n    #html = draftRawToHtml(raw);\n    #this.props.onChange(html);\n\n    html = toHTML(@state.editorState.getCurrentContent())\n\n    console.log html\n    return false\n\n  emitSerializedOutput: =>\n    #s = @state.editorState.getCurrentContent()\n    \n    raw = convertToRaw( @state.editorState.getCurrentContent() )\n    # console.log raw\n\n    #raw_as_json = JSON.stringify(raw)\n    #console.log raw_as_json\n    #raw_as_json\n    raw\n\n  decodeEditorContent: (raw_as_json)=>\n    console.log \"CONTENT\", raw_as_json\n    #new_content = convertFromRaw(JSON.parse(raw_as_json))\n    new_content = convertFromRaw(raw_as_json)\n    editorState = EditorState.createWithContent(new_content, @decorator)\n\n  testEmitAndDecode: =>\n    raw_as_json = @emitSerializedOutput()\n\n    @setState\n      editorState: @decodeEditorContent(raw_as_json)\n\n    false\n\n  emitHTML2: ()->\n\n    html = convertToHTML(\n      entityToHTML: (entity, originalText) => \n        if entity.type is 'LINK'\n          return \"<a href=\\\"#{entity.data.url}\\\">#{originalText}</a>\"\n        else\n          return originalText\n \n    )(@.state.editorState.getCurrentContent())\n    #html = convertToHTML(@.state.editorState.getCurrentContent())\n\n  getLocks: =>\n    @state.locks\n\n  addLock: =>\n    @setState\n      locks: @state.locks +=1\n\n  removeLock: =>\n    #return unless @state.locks < 0\n    @setState\n      locks: @state.locks -=1\n\n  renderableBlocks: =>\n    @props.config.widgets.filter (o)->\n      o.renderable\n    .map (o)->\n      o.type\n\n  blockRenderer: (block)=>\n\n    switch block.getType()\n\n      when \"atomic\"\n\n        entity = block.getEntityAt(0)\n\n        #return null unless entity\n        entity_type = Entity.get(entity).getType()\n\n    if @renderableBlocks().includes(block.getType())\n      return @handleBlockRenderer(block)\n\n    return null;\n\n  handleBlockRenderer: (block)=>\n    dataBlock = @getDataBlock(block)\n    #debugger if dataBlock.type is \"placeholder\"\n    return null unless dataBlock\n    return (\n      component: eval(dataBlock.block)\n      editable: !@state.read_only\n      props:\n        data: block.getData()\n        getEditorState: @getEditorState\n        setEditorState: @onChange\n        addLock: @addLock\n        removeLock: @removeLock\n        getLocks: @getLocks\n        config: dataBlock.options \n    )\n    \n    return null\n   \n  blockStyleFn: (block)=>\n    currentBlock = getCurrentBlock(@.state.editorState)\n    is_selected = if currentBlock.getKey() is block.getKey() then \"is-selected\" else \"\"\n    \n    console.log \"BLOCK STYLE:\", block.getType()\n\n    if @renderableBlocks().includes(block.getType())\n      return @styleForBlock(block, currentBlock, is_selected) \n    else\n      return \"graf graf--p #{is_selected}\"\n\n  getDataBlock: (block)=>\n    @props.config.widgets.find (o)=>\n      o.type is block.getType()\n\n  styleForBlock: (block, currentBlock, is_selected)=>\n    dataBlock = @getDataBlock(block)\n\n    return null unless dataBlock\n\n    selectedFn = if dataBlock.selectedFn then dataBlock.selectedFn(block) else null\n    selected_class = if is_selected then dataBlock.selected_class else ''\n    \n    return \"#{dataBlock.wrapper_class} #{selected_class} #{selectedFn}\"\n\n  ### from medium-draft\n  By default, it handles return key for inserting soft breaks (BRs in HTML) and\n  also instead of inserting a new empty block after current empty block, it first check\n  whether the current block is of a type other than `unstyled`. If yes, current block is\n  simply converted to an unstyled empty block. If RETURN is pressed on an unstyled block\n  default behavior is executed.\n  ###\n\n  handleReturn: (e) =>\n    if this.props.handleReturn\n      if this.props.handleReturn()\n        return true;\n\n    editorState = @state.editorState\n    ###\n    #if (isSoftNewlineEvent(e)) {\n    #  this.onChange(RichUtils.insertSoftNewline(editorState));\n    #  return true;\n    #}\n    ###\n    if !e.altKey && !e.metaKey && !e.ctrlKey\n      currentBlock = getCurrentBlock(editorState)\n      blockType = currentBlock.getType()\n\n      config_block = @getDataBlock(currentBlock)\n\n      #if blockType.indexOf('atomic') is 0\n      #  @.onChange(addNewBlockAt(editorState, currentBlock.getKey()))\n      #  return true;\n      \n      if currentBlock.getText().length is 0\n\n        if config_block && config_block.handleEnterWithoutText\n          config_block.handleEnterWithText(@, currentBlock)\n\n          @setState\n            display_tooltip: false\n\n          return true \n\n        #TODO turn this in configurable\n        switch (blockType)\n          when \"header-one\"\n            @.onChange(resetBlockWithType(editorState, \"unstyled\"));\n            return true;\n          else\n            return false;\n      \n      if currentBlock.getText().length > 0\n        if config_block && config_block.handleEnterWithText\n          config_block.handleEnterWithText(@, currentBlock)\n          @setState\n            display_tooltip: false\n          return true \n\n        return false\n\n      selection = editorState.getSelection();\n      \n      # selection.isCollapsed() and # should we check collapsed here?\n      if ( currentBlock.getLength() is selection.getStartOffset()) #or (config_block && config_block.breakOnContinuous))\n        # it will match the unstyled for custom blocks\n        if @continuousBlocks.indexOf(blockType) < 0\n          @.onChange(addNewBlockAt(editorState, currentBlock.getKey()))\n          return true\n        return false\n      \n      return false\n    \n    return false\n\n  handleBeforeInput: (chars)=>\n    currentBlock = getCurrentBlock(@state.editorState);\n\n    if currentBlock.getText().length isnt 0\n      @closeInlineButton()\n\n    ###\n    switch currentBlock.getType()\n      when \"placeholder\"\n        @setState\n          current_input: \n            placeholder: \"aa\"\n            embed_url:\"http://api.embed.ly/1/oembed?key=86c28a410a104c8bb58848733c82f840&url=\"\n            provisory_text:\"http://twitter.com/michelson\"\n        \n        @.onChange(resetBlockWithType(@state.editorState, \"placeholder\"));\n        return false\n    ###\n    return false\n\n  focus: () =>\n    \n    #@props.refs.richEditor.focus()\n    \n  getEditorState: =>\n    @state.editorState\n\n  handleOnChange: ->\n    setTimeout =>\n      @refs.insert_tooltip.show() # from relocate menu it also set show true , but it wont work\n      parent = ReactDOM.findDOMNode(@);\n      @refs.insert_tooltip.relocateMenu(@state.editorState, parent)\n    , 20\n\n  handlePasteText: (text, html)=>\n\n    # https://github.com/facebook/draft-js/issues/685\n    ###\n    html = \"<p>chao</p>\n    <avv>aaa</avv>\n    <p>oli</p>\n    <img src='x'/>\"\n    ###\n\n    # if not html then fallback to default handler\n\n    return @handleTXTPaste(text, html) unless html\n    return @handleHTMLPaste(text, html) if html\n\n  handleTXTPaste: (text, html)=>\n    currentBlock = getCurrentBlock(@state.editorState)\n    \n    editorState = @state.editorState\n    \n    switch currentBlock.getType()\n      when \"placeholder\"\n\n        newContent = Modifier.replaceText(\n          editorState.getCurrentContent(),\n          new SelectionState({\n            anchorKey: currentBlock.getKey(),\n            anchorOffset: 0,\n            focusKey: currentBlock.getKey(),\n            focusOffset: 2\n          }),\n          text)\n\n        editorState = EditorState.push(\n          editorState,\n          newContent,\n          'replace-text'\n        );\n\n        @onChange(editorState)\n\n        return true\n      else\n        return false\n\n  handleHTMLPaste: (text, html)=>\n    newContentState = customHTML2Content(html, @extendedBlockRenderMap)\n\n    currentBlock = getCurrentBlock(@state.editorState)\n    selection = @state.editorState.getSelection();\n    endKey = selection.getEndKey()\n    \n    content = @state.editorState.getCurrentContent();\n    blocksBefore = content.blockMap.toSeq().takeUntil((v) => (v.key is endKey))\n    blocksAfter = content.blockMap.toSeq().skipUntil((v) => (v.key is endKey)).rest()\n\n    newBlockKey = newContentState.blockMap.first().getKey()\n\n    newBlockMap = blocksBefore.concat(\n        newContentState.blockMap,\n        blocksAfter\n      ).toOrderedMap();\n\n    newContent = content.merge({\n      blockMap: newBlockMap,\n      selectionBefore: selection,\n      selectionAfter: selection.merge({\n      anchorKey: newBlockKey,\n      anchorOffset: 0,\n      focusKey: newBlockKey,\n      focusOffset: 0,\n      isBackward: false,\n      })\n    });\n\n    pushedContentState = EditorState.push(\n      @state.editorState, \n      newContent, \n      'insert-fragment'\n    )\n   \n    @onChange(pushedContentState)\n\n    true\n\n  handlePasteImage: (files)=>\n    #TODO: check file types\n    files.map (file)=>\n      opts =  \n        url: URL.createObjectURL(file)\n\n      @onChange(addNewBlock(@state.editorState, 'image', opts))\n\n  handleDroppedFiles: (state, files)=>\n    files.map (file)=>\n      opts =  \n        url: URL.createObjectURL(file)\n\n      @onChange(addNewBlock(@state.editorState, 'image', opts))\n\n  handleUpArrow: (e)=>\n    setTimeout =>\n      @forceRender(@state.editorState)\n    , 10\n\n  handleDownArrow: (e)=>\n    setTimeout =>\n      @forceRender(@state.editorState)\n    , 10\n\n  ## title utils\n  getTextFromEditor: =>\n    c = @.state.editorState.getCurrentContent()\n    out = c.getBlocksAsArray().map (o)=>\n        o.getText()\n      .join(\"\\n\")\n    \n    console.log out\n    return out\n\n  _toggleBlockType: (blockType)=>\n    \n    @onChange(\n      RichUtils.toggleInlineStyle(\n        @state.editorState,\n        blockType\n      )\n    )\n\n  handleKeyCommand: (command)=>\n    #console.log \"command:\",  command\n    if command is 'dante-save'\n      # Perform a request to save your contents, set\n      # a new `editorState`, etc.\n      console.log \"SAVING!!\"\n      return 'not-handled'\n    if command is 'dante-keyup'\n      return 'not-handled'\n    if command is 'dante-uparrow'\n      debugger\n      return 'not-handled'\n      #return 'not-handled'\n    #if command is 'dante-enter'\n    #  #@relocateTooltipPosition()\n    #  return 'handled'\n    #return 'not-handled'\n    newState = RichUtils.handleKeyCommand(@state.editorState, command);\n    if newState\n      @.onChange(newState);\n      return true;\n    \n    return false;\n\n  closeInlineButton: =>\n    @setState\n      display_tooltip: false\n\n  KeyBindingFn: (e)=>\n    #console.log \"KEY CODE: #{e.keyCode}\"\n    if e.keyCode is 83 # `S` key */ && hasCommandModifier(e)) {\n      #return 'dante-save'\n      console.log \"TODO: save in this point\"\n\n    if e.keyCode is KeyCodes.UPARROW\n      console.log \"UPARROW\"\n      return 'dante-uparrow'\n\n    return getDefaultKeyBinding(e)\n   \n  getNode:  (root=window) =>\n    t = null\n    if (root.getSelection)\n      t = root.getSelection()\n    else if (root.document.getSelection)\n      t = root.document.getSelection()\n    else if (root.document.selection)\n      t = root.document.selection.createRange().text\n    return t\n\n  # will update block state todo: movo to utils\n  updateBlockData: (block, options)=>\n    data = block.getData()\n    newData = data.merge(options)\n    newState = updateDataOfBlock(@state.editorState, block, newData)\n    # this fixes enter from image caption\n    @forceRender(newState)\n\n  getPositionForCurrent: ->\n    \n    if @state.editorState.getSelection().isCollapsed()\n\n      currentBlock = getCurrentBlock(@state.editorState)\n      blockType = currentBlock.getType()\n      \n      contentState = @state.editorState.getCurrentContent()\n      selectionState = @state.editorState.getSelection()\n\n      block = contentState.getBlockForKey(selectionState.anchorKey);\n      # console.log block.getText().length, block.getText()\n\n      # eslint-disable-next-line no-undef\n      nativeSelection = getSelection(window);\n      if !nativeSelection.rangeCount\n        return;\n\n      node = @getNode()\n\n      selectionBoundary = getSelectionRect(nativeSelection);\n      coords = selectionBoundary #utils.getSelectionDimensions(node)\n      \n      # eslint-disable-next-line react/no-find-dom-node\n      toolbarNode = ReactDOM.findDOMNode(@);\n      toolbarBoundary = toolbarNode.getBoundingClientRect();\n\n      # eslint-disable-next-line react/no-find-dom-node\n      parent = ReactDOM.findDOMNode(@);\n      parentBoundary = parent.getBoundingClientRect();\n\n      # checkeamos si esta vacio\n      @setState\n        display_tooltip: block.getText().length is 0 and blockType is \"unstyled\"\n        position:  \n          top: coords.top + window.scrollY\n          left: coords.left + window.scrollX - 60\n\n        #display_image_popover: blockType is \"image\"\n\n      @refs.image_popover.display(blockType is \"image\")\n\n      if blockType is \"image\"\n        selectionBoundary = node.anchorNode.parentNode.parentNode.parentNode.getBoundingClientRect()\n        #el = document.querySelector(\"#dante_image_popover\")\n        el = @refs.image_popover.refs.image_popover\n        padd   = el.offsetWidth / 2\n        @refs.image_popover.setPosition\n          top: selectionBoundary.top - parentBoundary.top + 60\n          left: selectionBoundary.left + (selectionBoundary.width / 2) - padd\n\n        ###\n        @setState\n          image_popover_position: \n            top: selectionBoundary.top - parentBoundary.top + 60\n            left: selectionBoundary.left + (selectionBoundary.width / 2) - padd\n        ###\n    else\n      @closeInlineButton()\n\n\n  setDirection: (direction_type)=>\n    \n    contentState = @state.editorState.getCurrentContent()\n    selectionState = @state.editorState.getSelection()\n    block = contentState.getBlockForKey(selectionState.anchorKey);\n\n    @updateBlockData(block, {direction: direction_type})\n\n  handleShowPopLinkOver: (e)=>\n    @showPopLinkOver()\n\n  handleHidePopLinkOver: (e)=>\n    @hidePopLinkOver()\n\n  showPopLinkOver: (el)=>\n    # handles popover display \n    # using anchor or from popover\n    parent_el = ReactDOM.findDOMNode(@);\n    coords = @refs.anchor_popover.positionForTooltip(\n      el, \n      @state.editorState,\n      parent_el\n      ) if el\n\n    @refs.anchor_popover.setPosition coords if coords\n\n    @refs.anchor_popover.setProps\n      show: true\n      url: if el then el.href else @refs.anchor_popover.state.url\n\n    @isHover = true\n    @cancelHide()\n\n    #@refs.anchor_popover.show()\n\n  hidePopLinkOver: ()=>\n    @hideTimeout = setTimeout ()=>\n      @refs.anchor_popover.hide()\n    , 300\n\n  cancelHide: ()->\n    console.log \"Cancel Hide\"\n    clearTimeout @hideTimeout\n\n  ## close popovers\n  closePopOvers: ()=>\n    @setState\n      display_tooltip: false\n      #display_image_popover: false\n      #display_anchor_popover: false\n\n    @refs.insert_popover.hide()\n    @refs.image_popover.hide()\n    @refs.anchor_popover.hide()\n\n  ## read only utils\n  toggleReadOnly: (e)=>\n    e.preventDefault()\n    @toggleEditable()\n  \n  toggleEditable: =>\n    @closePopOvers()\n\n    @setState\n      read_only: !@state.read_only\n    , @testEmitAndDecode\n  ##\n\n  render: =>\n\n    return (\n      <div id=\"content\" suppressContentEditableWarning={true}>\n\n        <article className=\"postArticle\">\n          <div className=\"postContent\">\n            <div className=\"notesSource\">\n              <div id=\"editor\" \n                className=\"postField postField--body\">\n\n                <section className=\"section--first section--last\"> \n                  <div className=\"section-divider layoutSingleColumn\"> \n                    <hr className=\"section-divider\"/> \n                  </div> \n\n                  <div className=\"section-content\"> \n                    <div ref=\"richEditor\" \n                      className=\"section-inner layoutSingleColumn\" \n                      onClick={@.focus}>\n                      <Editor \n                        blockRendererFn={@.blockRenderer}\n                        editorState={@state.editorState} \n                        onChange={@onChange}\n                        onUpArrow={@handleUpArrow}\n                        onDownArrow={@handleDownArrow}\n                        handleReturn={@handleReturn}\n                        blockRenderMap={@state.blockRenderMap}\n                        blockStyleFn={@.blockStyleFn}\n                        handlePastedText={@handlePasteText}\n                        handlePastedFiles={@handlePasteImage}\n                        handleDroppedFiles={@handleDroppedFiles}\n                        handleKeyCommand={@.handleKeyCommand}\n                        keyBindingFn={@KeyBindingFn}\n                        handleBeforeInput={@.handleBeforeInput}\n                        readOnly={@state.read_only}\n                        placeholder={@props.config.body_placeholder}\n                        ref=\"editor\"\n                      />\n                    </div> \n                  </div>\n                </section>\n\n              </div>\n            </div>\n          </div>\n        </article>\n\n        <DanteTooltip\n          editorState={@state.editorState} \n          toggleBlockType={@_toggleBlockType}\n          block_types={@block_types}\n          confirmLink={@_confirmLink}\n          tooltipables={@tooltipables}\n          onChange={@onChange}\n          showPopLinkOver={@showPopLinkOver} \n          hidePopLinkOver={@hidePopLinkOver}\n          ref=\"insert_tooltip\"\n        />\n\n        <DanteInlineTooltip\n          options={@state.inlineTooltip}\n          config={@state.widgets}\n          editorState={@state.editorState}\n          style={@state.position}\n          onChange={@onChange}\n          display_tooltip={@state.display_tooltip}\n          closeInlineButton={@closeInlineButton}\n          ref=\"add_tooltip\"\n        />\n      \n        <DanteImagePopover\n          setDirection={@setDirection}\n          ref=\"image_popover\"\n        />\n      \n        <DanteAnchorPopover\n          url={@state.anchor_popover_url}\n          handleOnMouseOver={@handleShowPopLinkOver}\n          handleOnMouseOut={@handleHidePopLinkOver}\n          ref=\"anchor_popover\"\n        />  \n\n        <hr/> \n\n        <ul>\n          <li>LOCKS: {@state.locks}</li>\n          <li>\n            <a href=\"#\" onClick={@toggleReadOnly}>\n              READ ONLY {if @state.read_only then 'yup' else 'noup'}\n            </a>\n          </li>\n          <li>\n            <a href=\"#\" onClick={@emitHTML}>\n              get content\n            </a>\n          </li>\n          <li>\n            <a href=\"#\" onClick={@getTextFromEditor}>\n              get Text From Editor\n            </a>\n          </li>\n          \n          <li>\n            <a href=\"#\" onClick={@testEmitAndDecode}>\n              serialize and set content\n            </a>\n          </li>\n        </ul>\n      </div>\n    ) \n\nmodule.exports = Dante\n","\nReact = require('react')\nReactDOM = require('react-dom')\n\n{\n  Entity,\n  RichUtils\n  AtomicBlockUtils\n  EditorBlock\n} = require('draft-js')\n\naxios = require(\"axios\")\n\n{ updateDataOfBlock } = require('../../model/index.js.es6')\n\nclass EmbedBlock extends React.Component\n  constructor: (props) ->\n    super props\n    #api_key = \"86c28a410a104c8bb58848733c82f840\"\n\n    @state = \n      embed_data: @defaultData()\n\n  defaultData: ->\n    existing_data = @.props.block.getData().toJS()\n    existing_data.embed_data || {}\n\n  # will update block state\n  updateData: =>\n    blockProps = @.props.blockProps\n    block = @.props.block\n    getEditorState = @props.blockProps.getEditorState\n    setEditorState = @props.blockProps.setEditorState\n    data = block.getData();\n    newData = data.merge(@state)\n    setEditorState(updateDataOfBlock(getEditorState(), block, newData))\n\n  dataForUpdate: =>\n\n    @.props.blockProps.data.toJS()\n\n  componentDidMount: =>\n    \n    return unless @.props.blockProps.data\n    \n    # ensure data isnt already loaded\n    # unless @dataForUpdate().endpoint or @dataForUpdate().provisory_text\n      \n    unless @dataForUpdate().endpoint or @dataForUpdate().provisory_text\n      #debugger\n      return\n\n    axios\n      method: 'get'\n      url: \"#{@dataForUpdate().endpoint}#{@dataForUpdate().provisory_text}&scheme=https\"\n    .then (result)=> \n      \n      @setState\n        embed_data: result.data #JSON.parse(data.responseText)\n      , @updateData    \n    .catch (error)=>\n      console.log(\"TODO: error\")\n      \n  classForImage: ->\n    if @state.embed_data.images then \"\" else \"mixtapeImage--empty u-ignoreBlock\"\n    #if @state.embed_data.thumbnail_url then \"\" else \"mixtapeImage--empty u-ignoreBlock\"\n\n  picture: ->\n    if @state.embed_data.images then @state.embed_data.images[0].url else \"\"\n\n  render: ->\n    #block = @.props;\n    #foo = @.props.blockProps;\n    #data = Entity.get(block.block.getEntityAt(0)).getData();\n    return(\n      <span>\n        <a target='_blank'\n          className=\"js-mixtapeImage mixtapeImage #{@classForImage()}\"\n          href={@state.embed_data.url} \n          style={{backgroundImage: \"url('#{@picture()}')\"}}>\n        </a>\n        <a className='markup--anchor markup--mixtapeEmbed-anchor' \n          target='_blank' href={@state.embed_data.url}>\n          <strong className='markup--strong markup--mixtapeEmbed-strong'>\n            {@state.embed_data.title}\n          </strong>\n          <em className='markup--em markup--mixtapeEmbed-em'>\n            {@state.embed_data.description}\n          </em>\n        </a>\n        {@state.embed_data.provider_url}\n      </span>\n    )\n\nmodule.exports = EmbedBlock","React = require('react')\nReactDOM = require('react-dom')\n\n{\n  Entity,\n  RichUtils\n  AtomicBlockUtils\n  EditorBlock\n  EditorState\n} = require('draft-js')\n\naxios = require(\"axios\")\n\n{ updateDataOfBlock } = require('../../model/index.js.es6')\n\n\nclass ImageBlock extends React.Component\n\n  constructor: (props) ->\n    super props\n\n    existing_data = @.props.block.getData().toJS()\n\n    @config = @props.blockProps.config\n\n    @state =\n      loading: false \n      selected: false\n      loading_progress: 0\n      caption: @defaultPlaceholder()\n      direction: existing_data.direction || \"center\"\n      width: 0\n      height: 0\n      file: null\n      url: @blockPropsSrc() || @defaultUrl(existing_data)\n      aspect_ratio: @defaultAspectRatio(existing_data)\n\n\n  blockPropsSrc: ()=>\n    # console.log @.props.blockProps.data.src\n    @.props.blockProps.data.src\n    ###\n    debugger\n    block = @.props;\n    entity = block.block.getEntityAt(0)\n    if entity\n      data = Entity.get(entity).getData().src\n    else\n      null\n    ###\n\n  defaultUrl: (data)=>\n    return data.url if data.url\n\n    if data.url\n      if data.file then URL.createObjectURL(data.file) else data.url\n    else\n      @props.blockProps.data.src\n\n  defaultPlaceholder: ->\n    @props.blockProps.config.image_caption_placeholder\n\n  defaultAspectRatio: (data)=>\n    if data.aspect_ratio\n      width: data.aspect_ratio['width']\n      height: data.aspect_ratio['height']\n      ratio: data.aspect_ratio['ratio'] \n    else\n      width:  0\n      height: 0\n      ratio: 100\n\n  getAspectRatio: (w, h)->\n    maxWidth = 1000\n    maxHeight = 1000\n    ratio = 0\n    width = w # Current image width\n    height = h # Current image height\n\n    # Check if the current width is larger than the max\n    if width > maxWidth\n      ratio = maxWidth / width # get ratio for scaling image\n      height = height * ratio # Reset height to match scaled image\n      width = width * ratio # Reset width to match scaled image\n\n    # Check if current height is larger than max\n    else if height > maxHeight\n      ratio = maxHeight / height # get ratio for scaling image\n      width = width * ratio # Reset width to match scaled image\n      height = height * ratio # Reset height to match scaled image\n\n    fill_ratio = height / width * 100\n    result = { width: width, height: height, ratio: fill_ratio }\n    console.log result\n    result\n\n  # will update block state\n  updateData: =>\n    blockProps = @.props.blockProps\n    block = @.props.block\n    getEditorState = @props.blockProps.getEditorState\n    setEditorState = @props.blockProps.setEditorState\n    data = block.getData()\n    newData = data.merge(@state).merge(forceUpload: false)\n    setEditorState(updateDataOfBlock(getEditorState(), block, newData))\n\n  replaceImg: =>\n    @img = new Image();\n    @img.src = this.refs.image_tag.src\n    @setState \n      url: @img.src\n    self = @\n    # exit only when not blob and not forceUload\n    return if !@img.src.includes(\"blob\") and !@props.block.data.get(\"forceUpload\")\n    @img.onload = ()=>\n      console.log @img\n      console.log this\n      console.log self\n      console.log @\n      @setState\n        width: @img.width\n        height: @img.height\n        aspect_ratio: self.getAspectRatio(@img.width, @img.height)\n      , @handleUpload\n\n  startLoader: =>\n    @setState\n      loading: true\n\n  stopLoader: =>\n    @setState\n      loading: false\n\n  handleUpload: =>\n    @startLoader()\n    @props.blockProps.addLock()\n    @updateData()\n    @uploadFile()\n\n  componentDidMount: ->\n    @replaceImg()\n\n  aspectRatio: =>\n    maxWidth: \"#{@state.aspect_ratio.width}\"\n    maxHeight: \"#{@state.aspect_ratio.height}\"\n    ratio: \"#{@state.aspect_ratio.height}\"\n\n  updateDataSelection: =>\n    getEditorState = @props.blockProps.getEditorState\n    setEditorState = @props.blockProps.setEditorState\n    newselection = getEditorState().getSelection().merge(\n      anchorKey: @.props.block.getKey()\n      focusKey: @.props.block.getKey()\n    )\n\n    setEditorState(\n      EditorState.forceSelection(getEditorState(), newselection)\n    )\n  \n  handleGrafFigureSelectImg: (e)=>\n    e.preventDefault()\n    @setState\n      selected: true\n    , @updateDataSelection\n\n    #main_editor.onChange(main_editor.state.editorState)\n\n  coords: ->\n    maxWidth: \"#{@state.aspect_ratio.width}px\"\n    maxHeight: \"#{@state.aspect_ratio.height}px\"\n\n  formatData: ->\n    formData = new FormData()\n    formData.append('file', @props.blockProps.data.file)\n    return formData\n\n  uploadFile: =>\n    axios\n      method: 'post'\n      url: @config.upload_url\n      data: @formatData()\n      onUploadProgress: (e)=>\n        @updateProgressBar(e)\n    .then (result)=> \n      @uploadCompleted(result.data)\n      @props.blockProps.removeLock()\n      @stopLoader()\n\n      if @config.upload_callback\n        @config.upload_callback(response, @)\n\n    .catch (error)=>\n      @props.blockProps.removeLock()\n      @stopLoader()\n\n      console.log(\"ERROR: got error uploading file #{error}\")\n      if @config.upload_error_callback\n        @config.upload_error_callback(error, @)\n\n    handleUp = (json_response)=>\n      @uploadCompleted json_response, n\n\n  uploadCompleted: (json)=>\n    @setState\n      url: json.url\n    , @updateData\n\n  updateProgressBar: (e)=>\n    complete = @state.loading_progress\n    if (e.lengthComputable)\n      complete = e.loaded / e.total * 100\n      complete = complete ? complete : 0\n      @setState\n        loading_progress: complete\n      console.log \"complete\"\n      console.log complete\n\n  render: =>\n    return (\n      <div ref=\"image_tag2\" \n          suppressContentEditableWarning={true}>\n        <div\n          className=\"aspectRatioPlaceholder is-locked\" \n          style={@coords()} \n          onClick={@handleGrafFigureSelectImg}>\n          <div style={{paddingBottom: \"#{@state.aspect_ratio.ratio}%\" }}} className='aspect-ratio-fill'>\n          </div>\n          <img src={@state.url}\n            ref=\"image_tag\"\n            height={@state.aspect_ratio.height}\n            width={@state.aspect_ratio.width}\n            className='graf-image'\n          />\n          <Loader \n            toggle={@state.loading}\n            progress={@state.loading_progress}\n          />\n        </div>\n        <figcaption className='imageCaption'>\n          <EditorBlock {...@props} \n            editable=true\n            className=\"imageCaption\"\n            placeholder=\"escrive alalal\"\n          />\n        </figcaption>\n      </div>\n    )\n\nclass Loader extends React.Component\n\n  render: ->\n    return (\n      <div>\n        { if @props.toggle\n          <div className=\"image-upoader-loader\">\n            <p>\n              {\n                if @props.progress is 100\n                  \"processing image...\"\n                else\n                  <span>\n                    <span>loading</span>\n                    {@props.progress}\n                  </span>\n              }\n            </p>\n          </div>\n        }\n      </div>\n    )\n    \nmodule.exports = ImageBlock\n","\nReact = require('react')\nReactDOM = require('react-dom')\n\n{\n  Entity,\n  RichUtils\n  AtomicBlockUtils\n  EditorBlock\n} = require('draft-js')\n\n#utils = require(\"../../utils/utils\")\n\n\nclass PlaceholderBlock extends React.Component\n  constructor: (props) ->\n    super props\n    @state =\n      enabled: false\n      data: @.props.blockProps.data.toJS()\n\n  placeholderText: =>\n    return \"\" if @state.enabled\n    @.props.blockProps.data.toJS().placeholder || @placeholderFromProps() || @defaultText()\n    #if @.props.blockProps.data then @.props.blockProps.data.placeholder else @defaultText()\n\n\n  placeholderFromProps: =>\n    @.props.block.toJS().placeholder\n\n  defaultText: =>\n    \"write something \"\n\n  componentDidMount: ->\n\n  handleFocus: (e)=>\n    console.log \"focus on placeholder\"\n    setTimeout =>\n      @setState\n        enabled: true\n    , 0\n\n  classForDefault: =>\n    if !@state.enabled then \"defaultValue defaultValue--root\" else \"\"\n\n  render: ->\n    console.log(@.state)\n    console.log(@props)\n    return(\n      <span className={@classForDefault()}\n        onMouseDown={@handleFocus}>\n        \n        {@placeholderText()}\n\n        <EditorBlock {...@props} \n          className=\"imageCaption\"\n          placeholder=\"escrive alalal\"\n        />\n      </span>\n    )\n\nmodule.exports = PlaceholderBlock","\nReact = require('react')\nReactDOM = require('react-dom')\n\n{\n  Entity,\n  RichUtils\n  AtomicBlockUtils\n  EditorBlock\n} = require('draft-js')\n\n{ updateDataOfBlock } = require('../../model/index.js.es6')\n\naxios = require(\"axios\")\n\nclass VideoBlock extends React.Component\n  constructor: (props) ->\n    super props\n    #api_key = \"86c28a410a104c8bb58848733c82f840\"\n    \n    @state = \n      embed_data: @defaultData()\n\n  defaultData: ->\n    existing_data = @.props.block.getData().toJS()\n    existing_data.embed_data || {}\n\n  # will update block state\n  updateData: =>\n    blockProps = @.props.blockProps\n    block = @.props.block\n    getEditorState = @props.blockProps.getEditorState\n    setEditorState = @props.blockProps.setEditorState\n    data = block.getData();\n    newData = data.merge(@state)\n    setEditorState(updateDataOfBlock(getEditorState(), block, newData))\n\n  dataForUpdate: =>\n    @.props.blockProps.data.toJS()\n\n  componentDidMount: ->\n\n    return unless @.props.blockProps.data\n    # ensure data isnt already loaded\n    return unless @dataForUpdate().endpoint or @dataForUpdate().provisory_text\n\n    axios\n      method: 'get'\n      url: \"#{@.dataForUpdate().endpoint}#{@.dataForUpdate().provisory_text}&scheme=https\"\n    .then (result)=>\n      @setState\n        embed_data: result.data #JSON.parse(data.responseText)\n      , @updateData    \n    .catch (error)=>\n      console.log(\"TODO: error\")\n\n  classForImage: ->\n    if @state.embed_data.thumbnail_url then \"\" else \"mixtapeImage--empty u-ignoreBlock\"\n\n  render: ->\n    return(\n      <figure\n        className='graf--figure graf--iframe graf--first' tabIndex='0'>\n        <div className='iframeContainer' dangerouslySetInnerHTML={__html: @state.embed_data.html}>\n        </div>\n        <figcaption\n          className='imageCaption'>\n            <EditorBlock {...@props} \n              className=\"imageCaption\"\n            />\n        </figcaption>\n      </figure>\n    )\n\nmodule.exports = VideoBlock","React = require('react')\n{Entity} = require('draft-js')\n\n###\nLink = (props) ->\n  data = Entity.get(props.entityKey).getData();\n  console.log props\n  #onMouseOver={@props.showPopLinkOver}>\n  #onMouseOut={@props.hidePopLinkOver}>\n  return (\n    <a href={data.url} className=\"markup--anchor\">\n      {props.children}\n    </a>\n  );\n###\n\nclass Link extends React.Component\n\n  constructor: (props) ->\n    super props\n    @isHover = false\n\n  _showPopLinkOver: (e)=>\n    @data.showPopLinkOver(@refs.link)\n\n  _hidePopLinkOver: (e)=>\n    @data.hidePopLinkOver()\n\n  render: ->\n    @data = Entity.get(@props.entityKey).getData();\n    console.log @props\n    console.log \"ENTITY\", @data\n\n    return (\n      <a ref=\"link\" \n        href={@data.url} \n        className=\"markup--anchor\"\n        onMouseOver={@_showPopLinkOver}\n        onMouseOut={@_hidePopLinkOver}>\n        {@props.children}\n      </a>\n    );  \n\nmodule.exports = Link","React = require('react')\nReactDOM = require('react-dom')\n\n{\n  Entity\n  RichUtils\n  AtomicBlockUtils\n  EditorState\n} = require('draft-js')\n\n{ \n  addNewBlock\n  resetBlockWithType\n  updateDataOfBlock\n} = require('../../model/index.js.es6')\n\nclass DanteInlineTooltip extends React.Component\n\n  constructor: (props) ->\n    super props\n\n    @state = \n      position: {top: 0, left:0}\n      show: true\n      scaled: false\n\n  display: (b)=>\n    if b then @show() else @hide()\n\n  show: =>\n    @setState\n      show: true\n\n  hide: =>\n    @setState\n      show: false\n\n  setPosition: (coords)->\n    @setState\n      position: coords\n\n  _toggleScaled: (ev)=>\n    if @state.scaled then @collapse() else @scale()\n\n  scale: =>\n    @setState\n      scaled: true\n\n  collapse: =>\n    @setState\n      scaled: false\n\n  componentWillReceiveProps: (newProps)=>\n    @collapse()\n\n  ###\n  componentWillReceiveProps: (newProps)=>\n    console.log \"RECEIVED PROPS\"\n\n    contentState = newProps.editorState.getCurrentContent()\n    selectionState = newProps.editorState.getSelection()\n    console.log contentState\n    console.log selectionState\n    if newProps.editorState.getSelection().isCollapsed()\n      block = contentState.getBlockForKey(selectionState.anchorKey);\n      console.log block.getText().length, block.getText()\n\n      #debugger\n      if block.getText().length > 0\n        @setState\n          show: false    \n        return\n\n      #debugger\n      node = utils.getNode()\n      #console.log node.AnchorNode\n\n      # clearTimeout(@timeout)\n      # @timeout = setTimeout =>\n\n      if node.anchorNode\n        #debugger\n        #debugger\n        console.log \"ANCHOR NODE\", node.anchorNode\n        coords = utils.getSelectionDimensions(node)\n        console.log coords\n        @setState\n          position:\n            top: coords.top + window.scrollY\n            left: coords.left + window.scrollX - 40\n          show: true\n      #, 0\n    else\n      #if (!selectionState.isCollapsed() || selectionState.anchorKey !== selectionState.focusKey) {\n      console.log('no sel');\n      #this.hideBlock();\n      @setState\n        show: false\n      return;\n  ###\n\n  activeClass: ->\n    #if @props.show then \"is-active\" else \"\"\n    if @props.display_tooltip then \"is-active\" else \"\"\n\n  #getPosition: ->\n  #  @state.position\n\n  isActive: ->\n    @props.display_tooltip \n\n  scaledClass: ->\n    if @state.scaled then \"is-scaled\" else \"\"\n\n  scaledWidth: ->\n    if @state.scaled then \"124\" else \"0\"   \n\n  clickOnFileUpload: => \n    @.refs.fileInput.click()\n    @collapse()\n    @props.closeInlineButton()\n\n  handlePlaceholder: (input)=>\n    opts =\n      type: input.insert_block\n      placeholder: input.options.placeholder\n      endpoint: input.options.endpoint\n\n    @props.onChange(resetBlockWithType(@props.editorState, 'placeholder', opts));\n\n  insertImage: (file) =>\n    opts =  \n      url: URL.createObjectURL(file)\n\n    @props.onChange(addNewBlock(@props.editorState, 'image', opts));\n\n  handleFileInput: (e)=>\n    fileList = e.target.files\n    file = fileList[0]\n    @.insertImage(file)\n\n  clickHandler: (e, type)=>\n    request_block = @.props.config.find (o)-> \n      o.icon is type \n\n    switch request_block.insertion\n      when \"upload\" \n        @clickOnFileUpload(e, request_block)\n      when \"placeholder\" \n        @handlePlaceholder(request_block)\n      else \n        console.log \"WRONG TYPE FOR #{request_block.insertion}\"\n\n  getItems: ->\n    @props.config.filter (o)=>\n      o.displayOnInlineTooltip\n\n  render: ->\n    return (\n\n      <div className=\"inlineTooltip #{@activeClass()} #{@scaledClass()}\" \n        style={@props.style}>\n        \n        <button className=\"inlineTooltip-button control\" \n          title=\"Close Menu\" \n          data-action=\"inline-menu\"\n          onClick={@_toggleScaled}\n        > \n          <span className=\"tooltip-icon dante-icon-plus\"></span> \n        </button> \n        \n        <div className=\"inlineTooltip-menu\" style={{width: \"#{@scaledWidth()}px\"}}> \n          \n          {\n            @getItems().map (item, i)=>\n              <InlineTooltipItem\n                item={item}\n                key={i}\n                clickHandler={@clickHandler}\n              />\n          }\n\n          <input type=\"file\" \n            style={{display: 'none'}}\n            ref=\"fileInput\" \n            multiple=\"multiple\"\n            onChange={@.handleFileInput}\n          />\n\n        </div>\n\n      </div>\n\n    )\n\nclass InlineTooltipItem extends React.Component\n\n  clickHandler: (e)=>\n    e.preventDefault()\n    #console.log \"UPLOAD IMAGE\"\n    @props.clickHandler(e, @props.item.icon)\n\n  render: ->\n    return (\n      <button className=\"inlineTooltip-button scale\" \n        title={@props.title} onMouseDown={@clickHandler}> \n        <span className=\"tooltip-icon dante-icon-#{@props.item.icon}\">\n        </span> \n      </button>\n    )\n\nmodule.exports = DanteInlineTooltip","\nReact = require('react')\nReactDOM = require('react-dom')\n\n{\n  Entity\n  RichUtils\n  AtomicBlockUtils\n  EditorState\n} = require('draft-js')\n\nclass DanteImagePopover extends React.Component\n\n  constructor: (props) ->\n    super props\n\n    @state = \n      position: \n        top: 0\n        left:0\n      show: false\n      scaled: false\n      buttons: [\n        {type: \"left\" }\n        {type: \"center\" }\n        {type: \"fill\" }\n        {type: \"wide\" }\n      ]\n\n  display: (b)=>\n    if b then @show() else @hide()\n\n  show: =>\n    @setState\n      show: true\n\n  hide: =>\n    @setState\n      show: false\n\n  setPosition: (coords)->\n    @setState\n      position: coords\n\n  _toggleScaled: (ev)=>\n    if @state.scaled then @collapse() else @scale()\n\n  scale: =>\n    @setState\n      scaled: true\n\n  collapse: =>\n    @setState\n      scaled: false\n\n  componentWillReceiveProps: (newProps)=>\n    @collapse()\n\n  getStyle: ->\n    return {} if !@state.position\n    \n  handleClick: (item)=>\n    @props.setDirection(item.type)\n\n  render: ->\n    return (\n\n      <div ref=\"image_popover\" \n          className=\"dante-popover popover--Aligntooltip popover--top popover--animated #{'is-active' if @state.show}\" \n          style={{top: @state.position.top, left: @state.position.left}}>\n\n        <div className='popover-inner'>\n\n          <ul className='dante-menu-buttons'>\n\n            {\n              @state.buttons.map (item, i)=>\n                <DanteImagePopoverItem\n                  item={item}\n                  handleClick={@handleClick}\n                  key={i}\n                />\n            }\n\n          </ul>\n\n        </div>\n\n        <div className='popover-arrow'>\n        </div>\n      </div>\n\n    )\n\nclass DanteImagePopoverItem extends React.Component\n\n  handleClick: (e)=>\n    e.preventDefault()\n    @props.handleClick(@props.item)\n\n  render: =>\n    return (\n      <li\n        className=\"dante-menu-button align-#{@props.item.type}\"\n        onMouseDown={@handleClick}>\n        <span className=\"tooltip-icon dante-icon-image-#{@props.item.type}\"></span>\n      </li>\n    )\n\nmodule.exports = DanteImagePopover\n\n","\nReact = require('react')\nReactDOM = require('react-dom')\n\n{ \n  getCurrentBlock\n} = require('../../model/index.js.es6')\n\nclass DanteAnchorPopover extends React.Component\n\n  constructor: (props) ->\n\n    super props\n    @state = \n      position: \n        top: 0\n        left:0\n      show: false\n      url: \"\"\n\n\n  display: (b)=>\n    if b then @show() else @hide()\n\n  show: =>\n    @setState\n      show: true\n\n  hide: =>\n    @setState\n      show: false\n\n  setPosition: (coords)->\n    @setState\n      position: coords\n\n  setProps: (options)=>\n    @setState options\n\n  positionForTooltip: (node, editorState, parent)=>\n    currentBlock = getCurrentBlock(editorState)\n    blockType = currentBlock.getType()\n    \n    contentState = editorState.getCurrentContent()\n    selectionState = editorState.getSelection()\n\n    selectionBoundary = node.getBoundingClientRect() #getSelectionRect(nativeSelection);\n    coords = selectionBoundary #utils.getSelectionDimensions(node)\n    #if blockType is \"image\"\n    #selectionBoundary = node.anchorNode.parentNode.parentNode.parentNode.getBoundingClientRect()\n    el = @refs.dante_popover\n    padd   = el.offsetWidth / 2\n    # eslint-disable-next-line react/no-find-dom-node\n    #toolbarNode = ReactDOM.findDOMNode(@)\n    #toolbarBoundary = toolbarNode.getBoundingClientRect()\n\n    # eslint-disable-next-line react/no-find-dom-node\n    # parent = ReactDOM.findDOMNode(@);\n    parentBoundary = parent.getBoundingClientRect()\n\n    {\n      top: selectionBoundary.top - parentBoundary.top + 160\n      left: selectionBoundary.left - (selectionBoundary.width) #- padd\n    }\n\n  render: =>\n    position = @state.position #@props.getPosition() || \n    console.log \"POSITIOM\", position\n    style = {\n              left: position.left, \n              top: position.top, \n              display: \"#{if @state.show then 'block' else 'none'}\"\n            }\n    return (\n      <div\n        ref=\"dante_popover\"\n        className='dante-popover popover--tooltip popover--Linktooltip popover--bottom is-active'\n        style={style}\n        onMouseOver={@props.handleOnMouseOver}\n        onMouseOut={@props.handleOnMouseOut}\n        >\n        <div className='popover-inner'>\n          <a href={@props.url} target='_blank'>\n            {@state.url}\n          </a>\n        </div>\n        <div className='popover-arrow'>\n        </div>\n      </div>\n    )\n\nmodule.exports = DanteAnchorPopover","React = require('react')\nReactDOM = require('react-dom')\n\n{\n  convertToRaw,\n  CompositeDecorator,\n  getVisibleSelectionRect,\n  getDefaultKeyBinding, \n  getSelectionOffsetKeyForNode,\n  KeyBindingUtil,\n  ContentState,\n  Editor,\n  EditorState,\n  Entity,\n  RichUtils\n} = require('draft-js')\n\n{ \n  getSelectionRect\n  getSelection\n} = require(\"../../utils/selection.js.es6\")\n\n{ \n  getCurrentBlock\n} = require('../../model/index.js.es6')\n\n\nclass DanteTooltip extends React.Component\n\n  constructor: (props) ->\n    super props\n    @getVisibleSelectionRect = getVisibleSelectionRect\n    @state = \n      link_mode: false\n      show: false\n      position: {}\n\n  _clickInlineHandler: (ev, style)=>\n    ev.preventDefault()\n    #@props.setStateHandler(\n    #  RichUtils.toggleInlineStyle(@props.editorState, style)\n    #)\n    @props.onChange(\n      RichUtils.toggleInlineStyle(@props.editorState, style)\n    )\n\n    setTimeout ()=>\n      @props.relocateMenu()\n    , 0\n    #@props.relocateMenu()\n\n  display: (b)=>\n    if b then @show() else @hide()\n\n  show: =>\n    @setState\n      show: true\n\n  hide: =>\n    @setState\n      show: false\n\n  setPosition: (coords)->\n    @setState\n      position: coords\n\n  relocateMenu: (editorState, parent)=>\n\n    currentBlock = getCurrentBlock(editorState);\n    blockType    = currentBlock.getType()\n    # display tooltip only for unstyled\n    if @.props.tooltipables.indexOf(blockType) < 0\n      @disableMenu()\n      return\n\n    return if !@state.show\n    el = @refs.dante_menu \n    #document.querySelector(\"#dante-menu\")\n    padd   = el.offsetWidth / 2\n\n    # eslint-disable-next-line no-undef\n    nativeSelection = getSelection(window);\n    if !nativeSelection.rangeCount\n      return;\n    \n    selectionBoundary = getSelectionRect(nativeSelection);\n\n    # eslint-disable-next-line react/no-find-dom-node\n    #toolbarNode = ReactDOM.findDOMNode(@);\n    #toolbarBoundary = toolbarNode.getBoundingClientRect();\n\n    # eslint-disable-next-line react/no-find-dom-node\n    #parent = ReactDOM.findDOMNode(@);\n    parentBoundary = parent.getBoundingClientRect();\n\n    top    = selectionBoundary.top - parentBoundary.top - -90 - 5\n    left   = selectionBoundary.left + (selectionBoundary.width / 2) - padd\n\n    if !top or !left\n      return\n\n    console.log \"SET SHOW FOR TOOLTIP INSERT MENU\"\n    @setState\n      show: true\n      position: { left: left , top: top }\n\n  _clickBlockHandler: (ev, style)=>\n    ev.preventDefault()\n    # console.log \"hoi\", style\n    #@props.toggleBlockType(style)\n    #ev.preventDefault()\n    @props.onChange(\n      RichUtils.toggleBlockType(@props.editorState, style)\n    )\n    #debugger\n    #@props.dispatchChanges(\n    #  RichUtils.toggleInlineStyle(@props.editorState, style)\n    #)\n    #@props.relocateMenu()\n    setTimeout ()=>\n      @relocateMenu()\n    , 0\n\n  displayLinkMode: =>\n    if @state.link_mode then \"dante-menu--linkmode\" else \"\"\n\n  displayActiveMenu: =>\n    if @state.show then \"dante-menu--active\" else \"\"\n\n  _enableLinkMode: (ev)=>\n    ev.preventDefault()\n    @setState\n      link_mode: true\n\n  _disableLinkMode: (ev)=>\n    ev.preventDefault()\n    @setState\n      link_mode: false\n\n  hideMenu: ->\n    @hide()\n    #@props.disableMenu()\n\n  handleInputEnter: (e)=>    \n    if (e.which is 13)\n      #utils.restoreSelection(@savedSel)\n      return @confirmLink(e)\n\n  confirmLink: (e)=>\n    e.preventDefault()\n    editorState = @.props.editorState\n    urlValue = e.currentTarget.value\n    contentState = editorState.getCurrentContent()\n    selection = editorState.getSelection()\n\n    opts = {\n      url: urlValue\n      showPopLinkOver: @props.showPopLinkOver \n      hidePopLinkOver: @props.hidePopLinkOver\n    }\n\n    entityKey = Entity.create('link', 'MUTABLE', opts);\n\n    if selection.isCollapsed()\n      console.log \"COLLAPSED SKIPPN LINK\"\n      return\n\n    @props.onChange(\n      RichUtils.toggleLink(\n        editorState,\n        selection,\n        entityKey\n      )\n    )\n  \n    @_disableLinkMode(e)\n\n  getPosition: ->\n    pos = @state.position\n    #console.log pos\n    pos\n    \n  componentWillReceiveProps: (newProps)=>\n    # console.log \"isjsj\"\n    #setTimeout ()=>\n    #  @props.relocateMenu()\n    #, 0\n\n  inlineItems: =>\n    @props.block_types.filter (o)=>\n      o.type is \"inline\"\n\n  blockItems: =>\n    @props.block_types.filter (o)=>\n      o.type is \"block\"\n\n  render: ->\n    return (\n      <div id=\"dante-menu\" \n        ref=\"dante_menu\"\n        className=\"dante-menu #{@displayActiveMenu()} #{@displayLinkMode()}\" \n        style={@getPosition()}>\n        \n        <div className=\"dante-menu-linkinput\">\n          <input className=\"dante-menu-input\" \n            placeholder=\"Paste or type a link\" \n            onKeyPress={@handleInputEnter}/>\n\n          <div className=\"dante-menu-button\" \n            onMouseDown={@_disableLinkMode}>\n            x\n          </div>\n        </div>\n\n        <ul className=\"dante-menu-buttons\">\n          {\n            @blockItems().map (item, i)=>\n              <DanteTooltipItem \n                key={i}\n                item={item}\n                handleClick={@_clickBlockHandler}\n                editorState={@props.editorState}\n                type={\"block\"}\n                currentStyle={@props.editorState.getCurrentInlineStyle}\n              />\n          }\n          {\n            <DanteTooltipLink \n              editorState={@props.editorState}\n              enableLinkMode={@_enableLinkMode}\n            />\n          }\n          {\n            @inlineItems().map (item, i)=>\n              <DanteTooltipItem \n                key={i}\n                item={item}\n                type={\"inline\"}\n                editorState={@props.editorState}\n                handleClick={@_clickInlineHandler}\n              />\n          }\n        </ul>\n      </div>\n    )\n\nclass DanteTooltipItem extends React.Component\n\n  handleClick: (ev)=>\n    @props.handleClick(ev, @props.item.style)\n\n  activeClass: =>\n    if @isActive() then \"active\" else \"\"\n\n  isActive: =>\n    if @props.type is \"block\"\n      @activeClassBlock()\n    else\n      @activeClassInline()\n\n  activeClassInline: =>\n    return unless @props.editorState\n    #console.log @props.item\n    @props.editorState.getCurrentInlineStyle().has(@props.item.style)\n\n  activeClassBlock: =>\n    #console.log \"EDITOR STATE\", @props.editorState\n    return unless @props.editorState\n    selection = @props.editorState.getSelection()\n    blockType = @props.editorState\n                .getCurrentContent()\n                .getBlockForKey(selection.getStartKey())\n                .getType()\n    @props.item.style is blockType\n\n  render: =>\n    return (\n      <li className=\"dante-menu-button #{@activeClass()}\" \n        onMouseDown={@handleClick}>\n        <i className=\"dante-icon dante-icon-#{@props.item.label}\" \n          data-action=\"bold\"></i>\n      </li>\n    )\n\nclass DanteTooltipLink extends React.Component\n\n  promptForLink: (ev)=>\n    selection = @props.editorState.getSelection()\n    if (!selection.isCollapsed())\n      @props.enableLinkMode(ev)\n\n  render: ->\n    return (\n      <li className=\"dante-menu-button\" \n        onMouseDown={@.promptForLink}>\n        <i className=\"dante-icon icon-createlink\" \n        data-action=\"createlink\">link</i>\n      </li>\n    )\n\n\nmodule.exports = DanteTooltip","\ndata2 = {\n  \"entityMap\": {},\n  \"blocks\": [\n    {\n      \"key\": \"5i64m\",\n      \"text\": \"ttps://www.youtube.com/watch?v=KPJgtQwtVVA&feature=youtu.be\",\n      \"type\": \"video\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {\n        \"embed_data\": {\n          \"provider_url\": \"https://www.youtube.com/\",\n          \"width\": 854,\n          \"height\": 480,\n          \"html\": \"<iframe class=\\\"embedly-embed\\\" src=\\\"https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FKPJgtQwtVVA%3Ffeature%3Doembed&url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DKPJgtQwtVVA&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FKPJgtQwtVVA%2Fhqdefault.jpg&key=d42b91026ea041c0875fd61ff736cb79&type=text%2Fhtml&schema=youtube\\\" width=\\\"854\\\" height=\\\"480\\\" scrolling=\\\"no\\\" frameborder=\\\"0\\\" allowfullscreen></iframe>\",\n          \"url\": \"http://www.youtube.com/watch?v=KPJgtQwtVVA\",\n          \"thumbnail_width\": 480,\n          \"version\": \"1.0\",\n          \"title\": \"When Eric Clapton met Jimi Hendrix\",\n          \"provider_name\": \"YouTube\",\n          \"type\": \"video\",\n          \"thumbnail_height\": 360,\n          \"author_url\": \"https://www.youtube.com/user/Mrjamesanonymous\",\n          \"thumbnail_url\": \"https://i.ytimg.com/vi/KPJgtQwtVVA/hqdefault.jpg\",\n          \"description\": \"An excerpt from the bbc documentary 'the seven ages of rock - Episode 1 the birth of rock'.\",\n          \"author_name\": \"Mrjamesanonymous\"\n        }\n      }\n    },\n    {\n      \"key\": \"347m6\",\n      \"text\": \"ttp://news.ycombinator.com\",\n      \"type\": \"embed\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {\n        \"embed_data\": {\n          \"provider_url\": \"https://news.ycombinator.com\",\n          \"description\": \"Air India Taking Advantage of Tailwinds\",\n          \"title\": \"Hacker News\",\n          \"url\": \"https://news.ycombinator.com/\",\n          \"version\": \"1.0\",\n          \"provider_name\": \"Ycombinator\",\n          \"type\": \"link\"\n        }\n      }\n    },\n    {\n      \"key\": \"t0sk\",\n      \"text\": \"sdcoidjco sidjcioj\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"3o1e9\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"gomb\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"3gb8l\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"5al5t\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"9n7jn\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"688cu\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"edbt8\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"6gcd3\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"2kv9k\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"fkp0i\",\n      \"text\": \"\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    }\n  ]\n}\n\ndata = {\"entityMap\":{},\"blocks\":[{\"key\":\"gmko\",\"text\":\"oli oli\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}]}\n\n\ndata3 = {\n  \"entityMap\": {},\n  \"blocks\": [\n    {\n      \"key\": \"5i64m\",\n      \"text\": \"ttps://www.youtube.com/watch?v=KPJgtQwtVVA&feature=youtu.be\",\n      \"type\": \"video\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {\n        \"embed_data\": {\n          \"provider_url\": \"https://www.youtube.com/\",\n          \"width\": 854,\n          \"height\": 480,\n          \"html\": \"<iframe class=\\\"embedly-embed\\\" src=\\\"https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FKPJgtQwtVVA%3Ffeature%3Doembed&url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DKPJgtQwtVVA&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FKPJgtQwtVVA%2Fhqdefault.jpg&key=d42b91026ea041c0875fd61ff736cb79&type=text%2Fhtml&schema=youtube\\\" width=\\\"854\\\" height=\\\"480\\\" scrolling=\\\"no\\\" frameborder=\\\"0\\\" allowfullscreen></iframe>\",\n          \"url\": \"http://www.youtube.com/watch?v=KPJgtQwtVVA\",\n          \"thumbnail_width\": 480,\n          \"version\": \"1.0\",\n          \"title\": \"When Eric Clapton met Jimi Hendrix\",\n          \"provider_name\": \"YouTube\",\n          \"type\": \"video\",\n          \"thumbnail_height\": 360,\n          \"author_url\": \"https://www.youtube.com/user/Mrjamesanonymous\",\n          \"thumbnail_url\": \"https://i.ytimg.com/vi/KPJgtQwtVVA/hqdefault.jpg\",\n          \"description\": \"An excerpt from the bbc documentary 'the seven ages of rock - Episode 1 the birth of rock'.\",\n          \"author_name\": \"Mrjamesanonymous\"\n        }\n      }\n    },\n    {\n      \"key\": \"347m6\",\n      \"text\": \"ttp://news.ycombinator.com\",\n      \"type\": \"embed\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {\n        \"embed_data\": {\n          \"provider_url\": \"https://news.ycombinator.com\",\n          \"description\": \"Air India Taking Advantage of Tailwinds\",\n          \"title\": \"Hacker News\",\n          \"url\": \"https://news.ycombinator.com/\",\n          \"version\": \"1.0\",\n          \"provider_name\": \"Ycombinator\",\n          \"type\": \"link\"\n        }\n      }\n    },\n    {\n      \"key\": \"t0sk\",\n      \"text\": \"sdcoidjco sidjcioj\",\n      \"type\": \"unstyled\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {}\n    },\n    {\n      \"key\": \"92f7o\",\n      \"text\": \"\",\n      \"type\": \"image\",\n      \"depth\": 0,\n      \"inlineStyleRanges\": [],\n      \"entityRanges\": [],\n      \"data\": {\n        \"aspect_ratio\": {\n          \"width\": 508,\n          \"height\": 448,\n          \"ratio\": 88.18897637795276\n        },\n        \"width\": 508,\n        \"height\": 448,\n        \"forceUpload\": false,\n        \"url\": \"blob:http://localhost:3333/580647fb-5cf1-49d0-be3a-4e986f432d2c\",\n        \"loading_progress\": 0,\n        \"selected\": false,\n        \"loading\": false,\n        \"file\": null,\n        \"direction\": \"center\"\n      }\n    }\n  ]\n}\n\nempty = null\n\nmodule.exports = data3","#ReactDOM = require('react-dom');\n#React = require('react');\n\nwindow.Dante = require('./components/App.cjsx')","//https://gist.github.com/benbriggs/d946a7cf4f7d90545779aeb79ccbd292\nimport {\n  EditorState,\n  convertFromRaw,\n  CompositeDecorator,\n} from 'draft-js';\n\nimport Link, { findLinkEntities } from '../components/link';\n\n\nconst decorator = new CompositeDecorator([\n  {\n    strategy: findLinkEntities,\n    component: Link,\n  },\n]);\n\n\nconst createEditorState = (content = null, decorators = null) => {\n  if (content === null) {\n    return EditorState.createEmpty(decorator);\n  }\n  let dec = decorator;\n  if (decorators !== null) {\n    dec = decorators;\n  }\n  return EditorState.createWithContent(convertFromRaw(content), dec);\n};\n\nexport default createEditorState;\n","import { Map } from 'immutable';\n\nimport { EditorState, ContentBlock, genKey } from 'draft-js';\n//import { Block } from '../util/constants';\n\n\n/*\nReturns default block-level metadata for various block type. Empty object otherwise.\n*/\nexport const getDefaultBlockData = (blockType, initialData = {}) => {\n  switch (blockType) {\n    //case Block.TODO: return { checked: false };\n    default: return initialData;\n  }\n};\n\n\n/*\nGet currentBlock in the editorState.\n*/\nexport const getCurrentBlock = (editorState) => {\n  const selectionState = editorState.getSelection();\n  const contentState = editorState.getCurrentContent();\n  const block = contentState.getBlockForKey(selectionState.getStartKey());\n  return block;\n};\n\n/*\nAdds a new block (currently replaces an empty block) at the current cursor position\nof the given `newType`.\n*/\nexport const addNewBlock = (editorState, newType = \"unstyled\", initialData = {}) => {\n  const selectionState = editorState.getSelection();\n  if (!selectionState.isCollapsed()) {\n    return editorState;\n  }\n  const contentState = editorState.getCurrentContent();\n  const key = selectionState.getStartKey();\n  const blockMap = contentState.getBlockMap();\n  const currentBlock = getCurrentBlock(editorState);\n  if (!currentBlock) {\n    return editorState;\n  }\n  if (currentBlock.getLength() === 0) {\n    if (currentBlock.getType() === newType) {\n      return editorState;\n    }\n    const newBlock = currentBlock.merge({\n      type: newType,\n      data: getDefaultBlockData(newType, initialData),\n    });\n    const newContentState = contentState.merge({\n      blockMap: blockMap.set(key, newBlock),\n      selectionAfter: selectionState,\n    });\n    return EditorState.push(editorState, newContentState, 'change-block-type');\n  }\n  return editorState;\n};\n\n\n/*\nChanges the block type of the current block.\n*/\nexport const resetBlockWithType = (editorState, newType = \"unstyled\", data={}) => {\n  const contentState = editorState.getCurrentContent();\n  const selectionState = editorState.getSelection();\n  const key = selectionState.getStartKey();\n  const blockMap = contentState.getBlockMap();\n  const block = blockMap.get(key);\n\n  let newText = '';\n  console.log( \"DATA FOR PLACEHOLDER!\", data)\n  const text = block.getText();\n  if (block.getLength() >= 2) {\n    newText = text.substr(1);\n  }\n\n  /*if(data.text){\n    newText = data.text\n  }*/\n\n  //let newText = data.text\n\n  const newBlock = block.merge({\n    text: newText,\n    type: newType,\n    data: getDefaultBlockData(newType, data),\n  });\n  const newContentState = contentState.merge({\n    blockMap: blockMap.set(key, newBlock),\n    selectionAfter: selectionState.merge({\n      anchorOffset: 0,\n      focusOffset: 0,\n    }),\n  });\n  return EditorState.push(editorState, newContentState, 'change-block-type');\n};\n\n\n/*\nUpdate block-level metadata of the given `block` to the `newData`/\n*/\nexport const updateDataOfBlock = (editorState, block, newData) => {\n  const contentState = editorState.getCurrentContent();\n  const newBlock = block.merge({\n    data: newData,\n  });\n  const newContentState = contentState.merge({\n    blockMap: contentState.getBlockMap().set(block.getKey(), newBlock),\n  });\n  return EditorState.push(editorState, newContentState, 'change-block-type');\n  // return editorState;\n};\n\nexport const updateTextOfBlock = (editorState, block, text) => {\n  const contentState = editorState.getCurrentContent();\n  const newBlock = block.merge({\n    text: text,\n  });\n  const newContentState = contentState.merge({\n    blockMap: contentState.getBlockMap().set(block.getKey(), newBlock),\n  });\n\n  return EditorState.push(editorState, newContentState, 'change-block-type');\n  // return editorState;\n};\n\n// const BEFORE = -1;\n// const AFTER = 1;\n\n/*\nUsed from [react-rte](https://github.com/sstur/react-rte/blob/master/src/lib/insertBlockAfter.js)\nby [sstur](https://github.com/sstur)\n*/\nexport const addNewBlockAt = (\n    editorState,\n    pivotBlockKey,\n    newBlockType = \"unstyled\",\n    initialData = {}\n  ) => {\n  const content = editorState.getCurrentContent();\n  const blockMap = content.getBlockMap();\n  const block = blockMap.get(pivotBlockKey);\n  const blocksBefore = blockMap.toSeq().takeUntil((v) => (v === block));\n  const blocksAfter = blockMap.toSeq().skipUntil((v) => (v === block)).rest();\n  const newBlockKey = genKey();\n\n  const newBlock = new ContentBlock({\n    key: newBlockKey,\n    type: newBlockType,\n    text: '',\n    characterList: block.getCharacterList().slice(0, 0),\n    depth: 0,\n    data: Map(getDefaultBlockData(newBlockType, initialData)),\n  });\n\n  const newBlockMap = blocksBefore.concat(\n    [[pivotBlockKey, block], [newBlockKey, newBlock]],\n    blocksAfter\n  ).toOrderedMap();\n\n  const selection = editorState.getSelection();\n\n  const newContent = content.merge({\n    blockMap: newBlockMap,\n    selectionBefore: selection,\n    selectionAfter: selection.merge({\n      anchorKey: newBlockKey,\n      anchorOffset: 0,\n      focusKey: newBlockKey,\n      focusOffset: 0,\n      isBackward: false,\n    }),\n  });\n  return EditorState.push(editorState, newContent, 'split-block');\n};\n","/*\nSome of the constants which are used throughout this project instead of directly using the string.\n*/\n\nexport const Block = {\n  UNSTYLED: 'unstyled',\n  OL: 'ordered-list-item',\n  UL: 'unordered-list-item',\n  H1: 'header-one',\n  H2: 'header-two',\n  H3: 'header-three',\n  H4: 'header-four',\n  H5: 'header-five',\n  H6: 'header-six',\n  CODE: 'code-block',\n  BLOCKQUOTE: 'blockquote',\n  PULLQUOTE: 'pullquote',\n  ATOMIC: 'atomic',\n  BLOCKQUOTE_CAPTION: 'block-quote-caption',\n  CAPTION: 'caption',\n  TODO: 'todo',\n  IMAGE: 'atomic:image',\n  BREAK: 'atomic:break',\n};\n\nexport const Inline = {\n  BOLD: 'BOLD',\n  CODE: 'CODE',\n  ITALIC: 'ITALIC',\n  STRIKETHROUGH: 'STRIKETHROUGH',\n  UNDERLINE: 'UNDERLINE',\n  HIGHLIGHT: 'HIGHLIGHT',\n};\n\nexport const Entity = {\n  LINK: 'LINK',\n};\n\nexport default {\n  Block,\n  Inline,\n  Entity,\n};\n","import {Entity} from 'draft-js';\nimport {convertToHTML} from 'draft-convert';\n\nconst toHTML = convertToHTML({\n  blockToHTML: (block) => {\n    if (block.type === 'atomic') {\n      // inspect metadata inside atomic block. if you're using block metadata,\n      // you can just inspect `block.data`, if not though we must inspect the\n      // entity range inside of the block.\n      if (block.entityRanges.length > 0) {\n        const entityKey = block.entityRanges[0].key;\n        const entity = Entity.get(entityKey);\n\n        // once you get here it depends on your app and what your entity data\n        // look like - in this example i'll pretend it uses the type to define\n        // if it's an image, a video, etc\n        const entityType = entity.getData().type;\n        // return unique wrapping block elements for each type of atomic block\n        if (entityType === 'ATOMIC-IMAGE') {\n          return {\n            start: '<div class=\"image-block\">',\n            end: '</div>'\n          };\n        }\n        else if (entityType === 'ATOMIC-VIDEO') {\n          return {\n            start: '<div class=\"video-block\">',\n            end: '</div>'\n          };\n        }\n      }\n    }\n    if (block.type === 'image'){\n      debugger\n      return {\n            start: '<div class=\"image-block\">',\n            end: '</div>'\n          };\n    }\n  },\n  entityToHTML: (entity, originalText) => {\n    if (entity.type === 'LINK') {\n      const href = entity.data.href;\n      return `<a href=${href}>${originalText}</a>`;\n    }\n    if (entity.type === 'ATOMIC-IMAGE') {\n      const src = entity.data.src;\n      return `<img src=\"${src}\" />`;\n    }\n    if (entity.type === 'ATOMIC-VIDEO') {\n      const src = entity.data.src;\n      const type = entity.data.type;\n      return `<video controls><source src=\"${src}\" type=\"${type}\"></video>`;\n    }\n    return originalText;\n  }\n});\n\n//const html = toHTML(contentState);\n\n//export default toHTML;\nmodule.exports = toHTML","{ ContentState\n  genKey \n  Entity \n  CharacterMetadata\n  ContentBlock\n  convertFromHTML\n  getSafeBodyFromHTML\n}  = require('draft-js')\n\n{ List\n  OrderedSet\n  Repeat\n  fromJS \n}  = require('immutable')\n\n{ compose \n}  = require('underscore')\n\n\n# from https://gist.github.com/N1kto/6702e1c2d89a33a15a032c234fc4c34e\n\n###\n# Helpers\n###\n\n# Prepares img meta data object based on img attributes\ngetBlockSpecForElement = (imgElement)=>\n  contentType: 'image',\n  imgSrc: imgElement.getAttribute('src')\n\n# Wraps meta data in HTML element which is 'understandable' by Draft, I used <blockquote />.\nwrapBlockSpec = (blockSpec)=>\n  if blockSpec == null\n    return null\n  \n  tempEl = document.createElement('blockquote')\n  # stringify meta data and insert it as text content of temp HTML element. We will later extract\n  # and parse it.\n  tempEl.innerText = JSON.stringify(blockSpec)\n  return tempEl\n\n# Replaces <img> element with our temp element\nreplaceElement = (oldEl, newEl)=>\n  if !(newEl instanceof HTMLElement)\n    return\n  \n  parentNode = oldEl.parentNode\n  return parentNode.replaceChild(newEl, oldEl)\n\n\nelementToBlockSpecElement = compose(wrapBlockSpec, getBlockSpecForElement)\n\nimgReplacer = (imgElement)=>\n  replaceElement(imgElement, elementToBlockSpecElement(imgElement))\n\n###\n# Main function\n###\n\n# takes HTML string and returns DraftJS ContentState\ncustomHTML2Content = (HTML, blockRn)->\n  tempDoc = new DOMParser().parseFromString(HTML, 'text/html')\n  # replace all <img /> with <blockquote /> elements\n  a = tempDoc.querySelectorAll('img').forEach( (item)->\n    return imgReplacer(item)\n  )\n\n  # use DraftJS converter to do initial conversion. I don't provide DOMBuilder and\n  # blockRenderMap arguments here since it should fall back to its default ones, which are fine\n  console.log tempDoc.body.innerHTML\n  contentBlocks = convertFromHTML(tempDoc.body.innerHTML, \n        getSafeBodyFromHTML, \n        blockRn\n  )\n\n  # now replace <blockquote /> ContentBlocks with 'atomic' ones\n  contentBlocks = contentBlocks.map (block)->\n    console.log \"CHECK BLOCK\", block.getType()\n    if (block.getType() isnt 'blockquote')\n      return block\n\n    json = \"\"\n    try\n      json = JSON.parse(block.getText())\n    catch\n      return block\n    \n    newBlock = block.merge({\n      type: \"image\",\n      text: \"\"\n      data: \n        url: json.imgSrc\n        forceUpload: true\n    });\n\n  tempDoc = null\n  return ContentState.createFromBlockArray(contentBlocks)\n\n\nmodule.exports = customHTML2Content","{ Entity } = require('draft-js')\n\nfindEntities = (entityType, contentBlock, callback)->\n  contentBlock.findEntityRanges (character) =>\n    entityKey = character.getEntity()\n    return (\n      entityKey isnt null &&\n      Entity.get(entityKey).getType() is entityType\n    );\n  ,\n  callback\n\nmodule.exports = findEntities","axios = require(\"axios\")\nImmutable = require('immutable')\n\nclass SaveBehavior \n  constructor: (options)->\n    @getLocks = options.getLocks\n    @config = options.config\n    @editorContent = options.editorContent\n\n  handleStore: (ev)->\n    @store()\n\n  store: (content)->\n    return unless @config.data_storage.url\n    console.log \"CHECK FOR LOCKS\", @getLocks()\n    if @getLocks() > 0\n      console.log \"LOCKED!!\"\n    return if @getLocks() > 0\n\n    clearTimeout(@timeout)\n    \n    @timeout = setTimeout =>\n      @checkforStore(content)\n    , @config.data_storage.interval\n\n  checkforStore: (content)->\n    # ENTER DATA STORE\n\n    isChanged = !Immutable.is(Immutable.fromJS(@.editorContent), Immutable.fromJS(content))\n    console.log(\"CONTENT CHANGED:\", isChanged)\n    \n    return unless isChanged\n\n    @config.xhr.before_handler() if @config.xhr.before_handler\n    console.log \"SAVING TO: #{@config.data_storage.url}\"\n    \n    axios\n      method: @config.data_storage.method\n      url: @config.data_storage.url\n      data: \n        data: JSON.stringify(content)\n    .then (result)=> \n      console.log \"STORING CONTENT\", result\n      @config.data_storage.success_handler(result) if @config.data_storage.success_handler\n      @config.xhr.success_handler(result) if @config.xhr.success_handler\n    .catch (error)=>\n      console.log(\"ERROR: got error saving content at #{@config.data_storage.url} - #{error}\")\n      @config.xhr.failure_handler(error) if @config.xhr.failure_handler\n\n\nmodule.exports = SaveBehavior\n","/*\nReturns the `boundingClientRect` of the passed selection.\n*/\nexport const getSelectionRect = (selected) => {\n  const _rect = selected.getRangeAt(0).getBoundingClientRect();\n  // selected.getRangeAt(0).getBoundingClientRect()\n  let rect = _rect && _rect.top ? _rect : selected.getRangeAt(0).getClientRects()[0];\n  if (!rect) {\n    if (selected.anchorNode && selected.anchorNode.getBoundingClientRect) {\n      rect = selected.anchorNode.getBoundingClientRect();\n      rect.isEmptyline = true;\n    } else {\n      return null;\n    }\n  }\n  return rect;\n};\n\n/*\nReturns the native selection node.\n*/\nexport const getSelection = (root) => {\n  let t = null;\n  if (root.getSelection) {\n    t = root.getSelection();\n  } else if (root.document.getSelection) {\n    t = root.document.getSelection();\n  } else if (root.document.selection) {\n    t = root.document.selection.createRange().text;\n  }\n  return t;\n};\n\n/*\nRecursively finds the DOM Element of the block where the cursor is currently present.\nIf not found, returns null.\n*/\nexport const getSelectedBlockNode = (root) => {\n  const selection = root.getSelection();\n  if (selection.rangeCount === 0) {\n    return null;\n  }\n  let node = selection.getRangeAt(0).startContainer;\n  // console.log(node);\n  do {\n    if (node.getAttribute && node.getAttribute('data-block') === 'true') {\n      return node;\n    }\n    node = node.parentNode;\n    // console.log(node);\n  } while (node !== null);\n  return null;\n};\n"]}